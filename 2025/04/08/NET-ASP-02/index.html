<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ASP.NET学习记录-02-最小API模式 | kyl的博客</title><meta name="author" content="kyl"><meta name="copyright" content="kyl"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:type" content="article">
<meta property="og:title" content="ASP.NET学习记录-02-最小API模式">
<meta property="og:url" content="https://alsl521.github.io/2025/04/08/NET-ASP-02/index.html">
<meta property="og:site_name" content="kyl的博客">
<meta property="og:description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4">
<meta property="article:published_time" content="2025-04-08T11:21:35.000Z">
<meta property="article:modified_time" content="2025-05-07T08:29:05.075Z">
<meta property="article:author" content="kyl">
<meta property="article:tag" content="C#">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ASP.NET学习记录-02-最小API模式",
  "url": "https://alsl521.github.io/2025/04/08/NET-ASP-02/",
  "image": "https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4",
  "datePublished": "2025-04-08T11:21:35.000Z",
  "dateModified": "2025-05-07T08:29:05.075Z",
  "author": [
    {
      "@type": "Person",
      "name": "kyl",
      "url": "https://alsl521.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://alsl521.github.io/2025/04/08/NET-ASP-02/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ASP.NET学习记录-02-最小API模式',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">kyl的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">ASP.NET学习记录-02-最小API模式</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">ASP.NET学习记录-02-最小API模式</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-08T11:21:35.000Z" title="发表于 2025-04-08 19:21:35">2025-04-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-07T08:29:05.075Z" title="更新于 2025-05-07 16:29:05">2025-05-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/">C#</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/ASP/">ASP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="1、创建第一个ASP-NET应用（Minimal-API）"><a href="#1、创建第一个ASP-NET应用（Minimal-API）" class="headerlink" title="1、创建第一个ASP.NET应用（Minimal API）"></a>1、创建第一个ASP.NET应用（Minimal API）</h1><h2 id="1-创建新项目"><a href="#1-创建新项目" class="headerlink" title="1.创建新项目"></a>1.创建新项目</h2><p><img src="/2025/04/08/NET-ASP-02/image-20250408200404368.png" alt="image-20250408200404368"></p>
<p>选择新的空项目</p>
<p><img src="/2025/04/08/NET-ASP-02/image-20250408200517484.png" alt="image-20250408200517484"></p>
<p>设定基本信息</p>
<p><img src="/2025/04/08/NET-ASP-02/image-20250408200743386.png" alt="image-20250408200743386"></p>
<p>使用最新版.NET作为学习内容</p>
<p><img src="/2025/04/08/NET-ASP-02/image-20250408200841413.png" alt="image-20250408200841413"></p>
<h2 id="2-项目架构简介与解析"><a href="#2-项目架构简介与解析" class="headerlink" title="2.项目架构简介与解析"></a>2.项目架构简介与解析</h2><p><img src="/2025/04/08/NET-ASP-02/image-20250408201412874.png" alt="image-20250408201412874"></p>
<h3 id="1-解决方案（Solution）"><a href="#1-解决方案（Solution）" class="headerlink" title="1. 解决方案（Solution）"></a><strong>1. 解决方案（Solution）</strong></h3><ul>
<li><strong>名称</strong>：<code>MyFirstWebApplication</code></li>
<li>作用：<ul>
<li>作为容器管理多个相关项目（当前仅包含一个项目 <code>WebApplication</code>）。</li>
<li>支持团队协作和复杂应用的模块化开发（如Web API、类库、单元测试等）。</li>
</ul>
</li>
<li>关键点：<ul>
<li>可通过解决方案配置统一管理所有项目的依赖和环境设置。</li>
</ul>
</li>
<li>新增项目<ul>
<li>右键单击解决方案-&gt;添加-&gt;新建项目</li>
</ul>
</li>
</ul>
<p><img src="/2025/04/08/NET-ASP-02/image-20250408201648650.png" alt="image-20250408201648650"></p>
<hr>
<h3 id="2-项目（Project-WebApplication）"><a href="#2-项目（Project-WebApplication）" class="headerlink" title="2. 项目（Project: WebApplication）"></a><strong>2. 项目（Project: <code>WebApplication</code>）</strong></h3><ul>
<li><strong>核心结构</strong>：<br>包含构建和运行Web应用所需的所有文件与配置，分为以下关键部分：</li>
</ul>
<h4 id="a-Connected-Services-文件夹"><a href="#a-Connected-Services-文件夹" class="headerlink" title="a. Connected Services 文件夹"></a><strong>a. <code>Connected Services</code> 文件夹</strong></h4><ul>
<li>作用：<ul>
<li>存储与外部服务的连接配置（如数据库、Azure服务、第三方API）。</li>
<li>通过右键添加服务（如Entity Framework、Azure认证），自动生成连接配置文件。</li>
</ul>
</li>
<li><strong>示例</strong>：<br>添加Azure SQL数据库后，会生成包含连接字符串的配置文件。</li>
</ul>
<h4 id="b-Properties-文件夹"><a href="#b-Properties-文件夹" class="headerlink" title="b. Properties 文件夹"></a><strong>b. <code>Properties</code> 文件夹</strong></h4><ul>
<li>核心文件：<ul>
<li><code>launchSettings.json</code>：<ul>
<li>定义应用启动时的配置，如默认端口、环境变量（Development&#x2F;Production）。</li>
<li>可配置多环境启动配置（如IIS、本地Kestrel服务器）。</li>
</ul>
</li>
<li><strong>其他属性文件</strong>：如程序集信息（AssemblyInfo.cs）。</li>
</ul>
</li>
</ul>
<h4 id="c-依赖项（Dependencies）"><a href="#c-依赖项（Dependencies）" class="headerlink" title="c. 依赖项（Dependencies）"></a><strong>c. <code>依赖项（Dependencies）</code></strong></h4><ul>
<li>作用：<ul>
<li>列出项目依赖的NuGet包（如 <code>Microsoft.AspNetCore.All</code>、数据库驱动程序）。</li>
<li>通过NuGet包管理器可添加&#x2F;更新依赖库。</li>
</ul>
</li>
<li>关键包示例：<ul>
<li><code>Microsoft.EntityFrameworkCore</code>（数据库操作）。</li>
<li><code>Swashbuckle.AspNetCore</code>（Swagger API文档）。</li>
</ul>
</li>
</ul>
<h4 id="d-appsettings-json"><a href="#d-appsettings-json" class="headerlink" title="d. appsettings.json"></a><strong>d. <code>appsettings.json</code></strong></h4><ul>
<li>作用：<ul>
<li>应用程序的通用配置文件，以JSON格式存储非敏感配置。</li>
<li>支持环境特定覆盖（如 <code>appsettings.Development.json</code> 覆盖开发环境配置）。</li>
</ul>
</li>
<li>典型配置：<ul>
<li>数据库连接字符串（<code>&quot;ConnectionStrings&quot;: &#123; &quot;DefaultConnection&quot;: &quot;...&quot; &#125;</code>）。</li>
<li>日志级别（<code>&quot;Logging&quot;: &#123; &quot;LogLevel&quot;: &#123; ... &#125; &#125;</code>）。</li>
<li>第三方服务API密钥。</li>
</ul>
</li>
</ul>
<h4 id="e-Program-cs"><a href="#e-Program-cs" class="headerlink" title="e. Program.cs"></a><strong>e. <code>Program.cs</code></strong></h4><ul>
<li><p>核心功能：</p>
<ul>
<li><strong>应用程序入口点</strong>：定义主机（Host）的创建和配置流程。</li>
<li>关键代码逻辑：<ol>
<li>使用 <code>WebApplicationBuilder</code> 配置服务（如中间件、依赖注入容器）。</li>
<li>添加中间件管道（如路由、身份验证、静态文件服务）。</li>
<li>使用 <code>builder.Configuration</code> 加载 <code>appsettings.json</code> 配置。</li>
<li>启动Web服务器（如Kestrel）。</li>
</ol>
</li>
</ul>
</li>
<li><p>示例代码片段：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line">builder.Services.AddControllersWithViews(); <span class="comment">// 添加MVC服务</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line">app.UseRouting();</span><br><span class="line">app.UseEndpoints(endpoints =&gt; endpoints.MapControllers());</span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure></li>
<li><p>初始化代码片段：</p>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);<span class="comment">//（创建Kestrel 服务器）</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line">app.MapGet(<span class="string">&quot;/&quot;</span>, () =&gt; <span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<h5 id="1-var-builder-WebApplication-CreateBuilder-args"><a href="#1-var-builder-WebApplication-CreateBuilder-args" class="headerlink" title="1. var builder = WebApplication.CreateBuilder(args);"></a><strong>1. <code>var builder = WebApplication.CreateBuilder(args);</code></strong></h5><ul>
<li><strong>作用</strong>：创建一个 <code>WebApplicationBuilder</code> 对象，用于配置ASP.NET Core应用。</li>
<li>关键点：<ul>
<li><strong><code>WebApplicationBuilder</code></strong>：这是一个核心类，负责初始化应用的依赖注入（DI）、配置、日志、中间件等。</li>
<li><code>args</code>：命令行参数，用于传递运行时配置（如环境变量、端口等）。例如：<code>dotnet run --environment Production --urls &quot;http://localhost:5001&quot;</code>，这些参数会被<code>builder</code>自动解析。</li>
<li>默认配置：<ul>
<li>加载 <code>appsettings.json</code> 及环境特定配置（如 <code>appsettings.Development.json</code>）。</li>
<li>注册默认服务（如日志、配置系统）。</li>
<li>配置环境（如 <code>Development</code> 或 <code>Production</code>）。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="2-var-app-builder-Build"><a href="#2-var-app-builder-Build" class="headerlink" title="2. var app = builder.Build();"></a><strong>2. <code>var app = builder.Build();</code></strong></h5><ul>
<li><strong>作用</strong>：根据 <code>builder</code> 的配置构建一个 <code>WebApplication</code> 实例。</li>
<li>关键点：<ul>
<li><strong><code>WebApplication</code></strong>：表示完整的ASP.NET Core应用实例，包含已配置的服务、中间件管道和路由。</li>
<li>构建过程：<ul>
<li>注册所有通过 <code>builder.Services</code> 添加的服务到DI容器。</li>
<li>初始化中间件管道（如路由、异常处理等默认中间件）。</li>
<li>加载配置文件（如 <code>appsettings.json</code>）。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="3-app-MapGet-Hello-World"><a href="#3-app-MapGet-Hello-World" class="headerlink" title="3. app.MapGet(&quot;/&quot;, () =&gt; &quot;Hello World!&quot;);"></a><strong>3. <code>app.MapGet(&quot;/&quot;, () =&gt; &quot;Hello World!&quot;);</code></strong></h5><ul>
<li><strong>作用</strong>：定义一个处理HTTP GET请求的路由，当访问根路径 <code>/</code> 时返回字符串 <code>&quot;Hello World!&quot;</code>。(中间件管道，仅在Kestrel 服务器接受请求时执行)</li>
<li>关键点：<ul>
<li><strong><code>MapGet</code></strong>：注册一个GET请求的路由处理程序。</li>
<li>路由规则：<ul>
<li><strong>路径</strong>：<code>/</code> 表示根路径，对应浏览器访问 <code>http://localhost:5000/</code>。</li>
<li><strong>处理逻辑</strong>：Lambda表达式 <code>() =&gt; &quot;Hello World!&quot;</code> 直接返回字符串作为响应体。</li>
</ul>
</li>
<li><strong>响应类型</strong>：默认返回 <code>text/plain</code> 类型的响应。</li>
</ul>
</li>
</ul>
<h5 id="4-app-Run"><a href="#4-app-Run" class="headerlink" title="4. app.Run();"></a><strong>4. <code>app.Run();</code></strong></h5><ul>
<li><strong>作用</strong>：启动Web服务器并开始监听HTTP请求。</li>
<li>关键点：<ul>
<li><strong>启动服务器</strong>：默认使用内置的Kestrel服务器（跨平台）。</li>
<li><strong>阻塞主线程</strong>：该方法会阻塞当前线程，直到应用停止（如按 <code>Ctrl+C</code>）。</li>
<li><strong>中间件执行</strong>：所有注册的中间件（包括路由和自定义中间件）会按顺序处理请求。</li>
</ul>
</li>
</ul>
<hr>
<h5 id="完整流程图解"><a href="#完整流程图解" class="headerlink" title="完整流程图解"></a><strong>完整流程图解</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用户请求 → Kestrel接收请求 → 路由匹配（/） → 执行Lambda表达式 → 返回&quot;Hello World!&quot; → 响应客户端</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="关键概念扩展"><a href="#关键概念扩展" class="headerlink" title="关键概念扩展"></a><strong>关键概念扩展</strong></h5><h6 id="1-WebApplicationBuilder-的作用"><a href="#1-WebApplicationBuilder-的作用" class="headerlink" title="1. WebApplicationBuilder 的作用"></a><strong>1. <code>WebApplicationBuilder</code> 的作用</strong></h6><ul>
<li><p>服务注册：通过<code>builder.Services</code>添加服务到DI容器，例如：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddControllers(); <span class="comment">// 注册MVC控制器</span></span><br><span class="line">builder.Services.AddSingleton&lt;MyService&gt;(); <span class="comment">// 注册单例服务</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置扩展：支持自定义配置，例如：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Configuration.AddJsonFile(<span class="string">&quot;custom.config.json&quot;</span>); <span class="comment">// 添加自定义配置文件</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>环境判断：通过 </p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Environment</span><br></pre></td></tr></table></figure>

<p>判断当前环境：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (builder.Environment.IsDevelopment()) &#123;</span><br><span class="line">    <span class="comment">// 开发环境配置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="2-路由与端点（Endpoints）"><a href="#2-路由与端点（Endpoints）" class="headerlink" title="2. 路由与端点（Endpoints）"></a><strong>2. 路由与端点（Endpoints）</strong></h6><ul>
<li><p>路由语法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GET请求，带参数</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/users/&#123;id&#125;&quot;</span>, (<span class="built_in">int</span> id) =&gt; <span class="string">$&quot;User ID: <span class="subst">&#123;id&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// POST请求，接收JSON数据</span></span><br><span class="line">app.MapPost(<span class="string">&quot;/todos&quot;</span>, (Todo todo) =&gt; Results.Ok(todo));</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>返回结果</strong>：使用 <code>Results</code> 类返回标准化响应（如 <code>Results.Ok()</code>、<code>Results.NotFound()</code>）。</p>
</li>
</ul>
<h6 id="3-中间件管道"><a href="#3-中间件管道" class="headerlink" title="3. 中间件管道"></a><strong>3. 中间件管道</strong></h6><ul>
<li><p>默认中间件包括：</p>
<ul>
<li><strong>路由处理</strong>：<code>UseRouting()</code></li>
<li><strong>静态文件服务</strong>：<code>UseStaticFiles()</code></li>
<li><strong>异常处理</strong>：<code>UseExceptionHandler()</code></li>
</ul>
</li>
<li><p>可通过 <code>app.Use</code></p>
<p>自定义中间件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.Use(async (context, next) =&gt; &#123;</span><br><span class="line">    await context.Response.WriteAsync(&quot;Before processing...\n&quot;);</span><br><span class="line">    await next(); // 继续后续中间件</span><br><span class="line">    await context.Response.WriteAsync(&quot;\nAfter processing!&quot;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h6 id="完整示例代码"><a href="#完整示例代码" class="headerlink" title="完整示例代码"></a><strong>完整示例代码</strong></h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var builder = WebApplication.CreateBuilder(args);</span><br><span class="line"></span><br><span class="line">// 注册服务（如数据库上下文）</span><br><span class="line">builder.Services.AddDbContext&lt;MyDbContext&gt;(options =&gt; </span><br><span class="line">    options.UseSqlServer(builder.Configuration.GetConnectionString(&quot;Default&quot;)));</span><br><span class="line"></span><br><span class="line">// 配置中间件</span><br><span class="line">var app = builder.Build();</span><br><span class="line"></span><br><span class="line">// 定义路由</span><br><span class="line">app.MapGet(&quot;/&quot;, () =&gt; &quot;Hello World!&quot;);</span><br><span class="line">app.MapGet(&quot;/api/todos&quot;, (MyDbContext db) =&gt; db.Todos.ToList()); // 使用DI服务</span><br><span class="line"></span><br><span class="line">// 启用Swagger（需安装NSwag包）</span><br><span class="line">if (app.Environment.IsDevelopment()) &#123;</span><br><span class="line">    app.UseOpenApi();</span><br><span class="line">    app.UseSwaggerUi();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="常见问题解答"><a href="#常见问题解答" class="headerlink" title="常见问题解答"></a><strong>常见问题解答</strong></h6><p><strong>Q1: 如何自定义端口？</strong></p>
<ul>
<li><p>方法1：通过命令行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet run --urls &quot;http://localhost:5001&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法2：在代码中设置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var builder = WebApplication.CreateBuilder(args);</span><br><span class="line">var app = builder.Build();</span><br><span class="line">app.Urls.Add(&quot;http://localhost:5001&quot;); // 添加多个端口</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>Q2: 如何添加控制器？</strong></p>
<ul>
<li><p>步骤：</p>
<ol>
<li><p>注册控制器服务：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddControllers();</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义控制器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ApiController]</span><br><span class="line">[Route(&quot;[controller]&quot;)]</span><br><span class="line">public class TodoController : ControllerBase &#123;</span><br><span class="line">    [HttpGet]</span><br><span class="line">    public IActionResult Get() =&gt; Ok(&quot;From Controller!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置路由：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.MapControllers(); // 启用控制器路由</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<p><strong>Q3: 如何处理POST请求？</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.MapPost(&quot;/api/todos&quot;, (Todo todo) =&gt; &#123;</span><br><span class="line">    // 处理POST数据（如保存到数据库）</span><br><span class="line">    return Results.Created($&quot;/todos/&#123;todo.Id&#125;&quot;, todo);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h6><p>这段代码展示了ASP.NET Core的<strong>最小API模式</strong>（Minimal API），通过简洁的代码实现了：</p>
<ol>
<li><strong>快速启动</strong>：无需复杂配置即可运行。</li>
<li><strong>路由定义</strong>：通过 <code>MapGet</code>&#x2F;<code>MapPost</code> 等方法直接绑定HTTP方法和路径。</li>
<li><strong>依赖注入</strong>：支持通过参数注入服务（如数据库上下文）。</li>
<li><strong>跨平台运行</strong>：使用Kestrel服务器，支持Windows&#x2F;Linux&#x2F;macOS。</li>
</ol>
<p>此模式适合快速开发小型API或原型，而复杂应用可通过扩展服务、中间件和控制器进一步增强功能。</p>
<hr>
<h3 id="3-依赖注入（Dependency-Injection-DI）"><a href="#3-依赖注入（Dependency-Injection-DI）" class="headerlink" title="3. 依赖注入（Dependency Injection, DI）"></a><strong>3. 依赖注入（Dependency Injection, DI）</strong></h3><ul>
<li><p>作用：</p>
<ul>
<li>通过 <code>Program.cs</code> 中的 <code>builder.Services</code> 配置服务注册（如数据库上下文、自定义服务）。</li>
<li>实现松耦合设计，便于测试和维护。</li>
</ul>
</li>
<li><p>示例：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddDbContext&lt;MyDbContext&gt;(options =&gt;</span><br><span class="line">    options.UseSqlServer(builder.Configuration.GetConnectionString(<span class="string">&quot;DefaultConnection&quot;</span>)));</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="4-环境配置"><a href="#4-环境配置" class="headerlink" title="4. 环境配置"></a><strong>4. 环境配置</strong></h3><ul>
<li>多环境支持：<ul>
<li>默认环境为 <code>Development</code>（开发环境）。</li>
<li>通过环境变量 <code>ASPNETCORE_ENVIRONMENT</code> 切换环境（如Production）。</li>
<li>环境特定配置文件（如 <code>appsettings.Production.json</code>）会覆盖通用配置。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="5-代码与资源组织"><a href="#5-代码与资源组织" class="headerlink" title="5. 代码与资源组织"></a><strong>5. 代码与资源组织</strong></h3><ul>
<li>视图（Views）：<ul>
<li>若使用MVC模式，存放HTML&#x2F;Razor视图文件（如 <code>Views/Home/Index.cshtml</code>）。</li>
</ul>
</li>
<li>控制器（Controllers）：<ul>
<li>处理HTTP请求的业务逻辑（如 <code>HomeController.cs</code>）。</li>
</ul>
</li>
<li>静态资源：<ul>
<li>存放CSS、JS、图片等静态文件（默认通过 <code>app.UseStaticFiles()</code> 访问）。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="架构协作流程"><a href="#架构协作流程" class="headerlink" title="架构协作流程"></a><strong>架构协作流程</strong></h3><ol>
<li>启动阶段：<ul>
<li><code>Program.cs</code> 加载 <code>appsettings.json</code> 配置，注册服务到DI容器，构建中间件管道。</li>
</ul>
</li>
<li>运行阶段：<ul>
<li>接收HTTP请求 → 通过中间件处理（路由、认证等） → 调用控制器&#x2F;服务 → 返回响应。</li>
</ul>
</li>
<li>配置管理：<ul>
<li><code>appsettings.json</code> 提供基础配置，环境特定文件实现灵活覆盖。</li>
</ul>
</li>
<li>外部服务集成：<ul>
<li>通过 <code>Connected Services</code> 管理数据库、云服务等连接，配置通过 <code>appsettings.json</code> 传递。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a><strong>总结</strong></h3><p>该架构通过以下方式实现高效开发：</p>
<ul>
<li><strong>模块化</strong>：解决方案和项目分离关注点，便于扩展。</li>
<li><strong>配置解耦</strong>：<code>appsettings.json</code> 和环境配置分离代码与配置。</li>
<li><strong>依赖管理</strong>：NuGet包和DI容器简化第三方库和内部服务的集成。</li>
<li><strong>可维护性</strong>：清晰的文件结构（如 <code>Properties</code>、<code>Connected Services</code>）提升代码可读性。</li>
</ul>
<p>此结构是ASP.NET Core项目的标准模板，适用于快速构建Web应用、API等。</p>
<h2 id="3-执行结果"><a href="#3-执行结果" class="headerlink" title="3.执行结果"></a>3.执行结果</h2><p><img src="/2025/04/08/NET-ASP-02/image-20250408205044362.png" alt="image-20250408205044362"></p>
<h1 id="2、ASP-NET应用（HttpContext）"><a href="#2、ASP-NET应用（HttpContext）" class="headerlink" title="2、ASP.NET应用（HttpContext）"></a>2、ASP.NET应用（HttpContext）</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line">app.Run(<span class="keyword">async</span> (HttpContext context) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    context.Response.ContentType = <span class="string">&quot;text/plain; charset=utf-8&quot;</span>;</span><br><span class="line">    <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的方法是<span class="subst">&#123;context.Request.Method&#125;</span>\r\n&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的路径是<span class="subst">&#123;context.Request.Path&#125;</span>\r\n&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;\r\n该请求的请求头有\r\n&quot;</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> key <span class="keyword">in</span> context.Request.Headers.Keys)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;key&#125;</span>：<span class="subst">&#123;context.Request.Headers[key]&#125;</span>\r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的请求体是<span class="subst">&#123;context.Request.Body&#125;</span>\r\n&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<h3 id="一、代码结构解析"><a href="#一、代码结构解析" class="headerlink" title="一、代码结构解析"></a>一、代码结构解析</h3><ol>
<li><p><strong>宿主构建流程</strong></p>
<ul>
<li><p><code>WebApplication.CreateBuilder(args)</code>：创建Web应用构建器，内部会初始化默认配置、日志系统、依赖注入容器等核心组件</p>
<ul>
<li><code>builder.Build()</code>：通过管道模式构建IHost对象，完成中间件管道配置、服务器(Kestrel&#x2F;IIS)初始化等操作</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>请求处理管道</strong></p>
<ul>
<li><p><code>app.Run()</code>：注册终结点中间件，拦截所有HTTP请求并执行异步处理逻辑</p>
<ul>
<li>使用<code>HttpContext</code>对象访问请求上下文，包含完整的请求&#x2F;响应元数据</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="二、核心功能解析"><a href="#二、核心功能解析" class="headerlink" title="二、核心功能解析"></a>二、核心功能解析</h3><ol>
<li><p><strong>编码设置</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.Response.ContentType = <span class="string">&quot;text/plain; charset=utf-8&quot;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>强制指定响应内容为UTF-8编码，解决中文字符乱码问题</p>
</li>
<li><p><code>text/plain</code>表示纯文本格式，与HTML响应的<code>text/html</code>形成对比</p>
</li>
</ul>
</li>
<li><p><strong>请求信息输出</strong></p>
<ul>
<li><p><strong>方法类型</strong>：<code>context.Request.Method</code> 获取HTTP动词(GET&#x2F;POST等)</p>
</li>
<li><p><strong>请求路径</strong>：<code>context.Request.Path</code> 解析URL路径</p>
</li>
<li><p><strong>请求头遍历</strong>：通过<code>Headers.Keys</code>遍历所有请求头键值对</p>
</li>
<li><p>请求体处理：当前直接输出<code>Body</code>对象，实际需用<code>StreamReader读取内容</code></p>
</li>
</ul>
</li>
</ol>
<h3 id="三、优化建议"><a href="#三、优化建议" class="headerlink" title="三、优化建议"></a>三、优化建议</h3><ol>
<li><p><strong>请求体读取改进</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">context.Request.EnableBuffering(); <span class="comment">// 允许重复读取Body</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line"><span class="keyword">var</span> bodyContent = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">context.Request.Body.Position = <span class="number">0</span>; <span class="comment">// 重置读取位置</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>功能扩展建议</strong></p>
<ul>
<li><p>添加异常处理中间件</p>
<p><code>app.UseExceptionHandler()</code></p>
<ul>
<li><p>集成路由系统</p>
<p><code>app.UseRouting()</code>+终结点配置</p>
</li>
<li><p>增加静态文件服务</p>
<p><code>app.UseStaticFiles()</code></p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="四、运行流程图解"><a href="#四、运行流程图解" class="headerlink" title="四、运行流程图解"></a>四、运行流程图解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTTP请求 → Kestrel服务器 → 中间件管道 → 自定义处理逻辑 → 返回响应</span><br></pre></td></tr></table></figure>

<p>该流程体现了ASP.NET Core的请求处理管道模式，每个请求都会经过注册的中间件组件</p>
<h3 id="五、注意事项"><a href="#五、注意事项" class="headerlink" title="五、注意事项"></a>五、注意事项</h3><ol>
<li><p><strong>编码一致性</strong></p>
<ul>
<li><p>确保代码文件保存为UTF-8格式（VS菜单：文件→高级保存选项）</p>
</li>
<li><p>若输出HTML内容，需添加<code>&lt;meta charset=&quot;utf-8&quot;&gt;</code></p>
</li>
</ul>
</li>
<li><p><strong>性能影响</strong></p>
<ul>
<li>同步写响应(<code>WriteAsync</code>)可能影响吞吐量，建议批量生成响应内容</li>
<li>频繁的字符串拼接可改用<code>StringBuilder</code></li>
</ul>
</li>
</ol>
<p>此代码可作为请求调试工具使用，完整项目建议采用分层架构（控制器&#x2F;服务层分离）</p>
<p><img src="/2025/04/08/NET-ASP-02/image-20250409102219113.png" alt="image-20250409102219113"></p>
<p><img src="/2025/04/08/NET-ASP-02/image-20250409102322113.png" alt="image-20250409102322113"></p>
<h1 id="3、ASP-NET应用（Http-GET）"><a href="#3、ASP-NET应用（Http-GET）" class="headerlink" title="3、ASP.NET应用（Http GET）"></a>3、ASP.NET应用（Http GET）</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.Run(<span class="keyword">async</span> (HttpContext context) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    context.Response.ContentType = <span class="string">&quot;text/plain; charset=utf-8&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;GET&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的方法是<span class="subst">&#123;context.Request.Method&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的路径是<span class="subst">&#123;context.Request.Path&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;\r\n该请求的请求头有\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> key <span class="keyword">in</span> context.Request.Headers.Keys)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;key&#125;</span>：<span class="subst">&#123;context.Request.Headers[key]&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的请求体是<span class="subst">&#123;context.Request.Body&#125;</span>\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> employee <span class="keyword">in</span> employees)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;employee.Name&#125;</span>: <span class="subst">&#123;employee.Position&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeesRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;工程师&quot;</span>, <span class="number">60000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">2</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;经理&quot;</span>, <span class="number">75000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">3</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;技术员&quot;</span>, <span class="number">50000</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Employee&gt; <span class="title">GetEmployees</span>()</span> =&gt; employees;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span> position, <span class="built_in">double</span> salary</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        Name = name;</span><br><span class="line">        Position = position;</span><br><span class="line">        Salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/08/NET-ASP-02/image-20250409102931582.png" alt="image-20250409102931582"></p>
<center>
<figure>
<style>.tqxhvemnusut{}</style><img src="/2025/04/08/NET-ASP-02/image-20250409104614278.png" class="tqxhvemnusut">
<style>.lcmtsjdwrxtl{}</style><img src="/2025/04/08/NET-ASP-02/image-20250409103027239.png" class="lcmtsjdwrxtl">
</figure>
</center>
# 4、ASP.NET应用（Http POST）

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.Run(<span class="keyword">async</span> (HttpContext context) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    context.Response.ContentType = <span class="string">&quot;text/plain; charset=utf-8&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;GET&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的方法是<span class="subst">&#123;context.Request.Method&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的路径是<span class="subst">&#123;context.Request.Path&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;\r\n该请求的请求头有\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> key <span class="keyword">in</span> context.Request.Headers.Keys)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;key&#125;</span>：<span class="subst">&#123;context.Request.Headers[key]&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的请求体是<span class="subst">&#123;context.Request.Body&#125;</span>\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> employee <span class="keyword">in</span> employees)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;employee.Name&#125;</span>: <span class="subst">&#123;employee.Position&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;POST&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line">            <span class="keyword">var</span> body = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">            <span class="keyword">var</span> employee = JsonSerializer.Deserialize&lt;Employee&gt;(body);</span><br><span class="line">            EmployeesRepository.AddEmployees(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeesRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;工程师&quot;</span>, <span class="number">60000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">2</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;经理&quot;</span>, <span class="number">75000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">3</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;技术员&quot;</span>, <span class="number">50000</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Employee&gt; <span class="title">GetEmployees</span>()</span> =&gt; employees;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddEmployees</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Add(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span> position, <span class="built_in">double</span> salary</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        Name = name;</span><br><span class="line">        Position = position;</span><br><span class="line">        Salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/08/NET-ASP-02/image-20250409125835179.png" alt="image-20250409125835179"></p>
<h1 id="5、ASP-NET应用（Http-PUT）"><a href="#5、ASP-NET应用（Http-PUT）" class="headerlink" title="5、ASP.NET应用（Http PUT）"></a>5、ASP.NET应用（Http PUT）</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.Run(<span class="keyword">async</span> (HttpContext context) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    context.Response.ContentType = <span class="string">&quot;text/plain; charset=utf-8&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;GET&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的方法是<span class="subst">&#123;context.Request.Method&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的路径是<span class="subst">&#123;context.Request.Path&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;\r\n该请求的请求头有\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> key <span class="keyword">in</span> context.Request.Headers.Keys)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;key&#125;</span>：<span class="subst">&#123;context.Request.Headers[key]&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的请求体是<span class="subst">&#123;context.Request.Body&#125;</span>\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> employee <span class="keyword">in</span> employees)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;employee.Name&#125;</span>: <span class="subst">&#123;employee.Position&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;POST&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line">            <span class="keyword">var</span> body = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">            <span class="keyword">var</span> employee = JsonSerializer.Deserialize&lt;Employee&gt;(body);</span><br><span class="line">            EmployeesRepository.AddEmployees(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;PUT&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line">            <span class="keyword">var</span> body = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">            <span class="keyword">var</span> employee = JsonSerializer.Deserialize&lt;Employee&gt;(body);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> result = EmployeesRepository.UpdateEmployee(employee);</span><br><span class="line">            <span class="keyword">if</span> (result)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee已经更新了&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee没有找到&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeesRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;工程师&quot;</span>, <span class="number">60000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">2</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;经理&quot;</span>, <span class="number">75000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">3</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;技术员&quot;</span>, <span class="number">50000</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Employee&gt; <span class="title">GetEmployees</span>()</span> =&gt; employees;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddEmployees</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Add(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">UpdateEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> emp = employees.FirstOrDefault(x =&gt; x.Id == employee.Id);</span><br><span class="line">            <span class="keyword">if</span> (emp <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                emp.Name = employee.Name;</span><br><span class="line">                emp.Position = employee.Position;</span><br><span class="line">                emp.Salary = employee.Salary;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span> position, <span class="built_in">double</span> salary</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        Name = name;</span><br><span class="line">        Position = position;</span><br><span class="line">        Salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<center>
<figure>
<style>.oqxgpwbojggf{}</style><img src="/2025/04/08/NET-ASP-02/image-20250409130533664.png" class="oqxgpwbojggf">
<style>.gimbwnrcavxn{}</style><img src="/2025/04/08/NET-ASP-02/image-20250409130604482.png" class="gimbwnrcavxn">
</figure>
</center>

<p><img src="/2025/04/08/NET-ASP-02/image-20250409130641925.png" alt="image-20250409130641925"></p>
<h1 id="6、ASP-NET应用（Http-DELETE）"><a href="#6、ASP-NET应用（Http-DELETE）" class="headerlink" title="6、ASP.NET应用（Http DELETE）"></a>6、ASP.NET应用（Http DELETE）</h1><p>使用路径字符串&#x2F;查询字符串（?键&#x3D;值&amp;键&#x3D;值）、Body传递信息</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.Run(<span class="keyword">async</span> (HttpContext context) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    context.Response.ContentType = <span class="string">&quot;text/plain; charset=utf-8&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>(<span class="keyword">var</span> key <span class="keyword">in</span> context.Request.Query.Keys)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;key&#125;</span>：<span class="subst">&#123;context.Request.Query[key]&#125;</span>\r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/08/NET-ASP-02/image-20250409131933358.png" alt="image-20250409131933358"></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.Run(<span class="keyword">async</span> (HttpContext context) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    context.Response.ContentType = <span class="string">&quot;text/plain; charset=utf-8&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;GET&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的方法是<span class="subst">&#123;context.Request.Method&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的路径是<span class="subst">&#123;context.Request.Path&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;\r\n该请求的请求头有\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> key <span class="keyword">in</span> context.Request.Headers.Keys)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;key&#125;</span>：<span class="subst">&#123;context.Request.Headers[key]&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的请求体是<span class="subst">&#123;context.Request.Body&#125;</span>\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> employee <span class="keyword">in</span> employees)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;employee.Name&#125;</span>: <span class="subst">&#123;employee.Position&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;POST&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line">            <span class="keyword">var</span> body = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">            <span class="keyword">var</span> employee = JsonSerializer.Deserialize&lt;Employee&gt;(body);</span><br><span class="line">            EmployeesRepository.AddEmployees(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;PUT&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line">            <span class="keyword">var</span> body = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">            <span class="keyword">var</span> employee = JsonSerializer.Deserialize&lt;Employee&gt;(body);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> result = EmployeesRepository.UpdateEmployee(employee);</span><br><span class="line">            <span class="keyword">if</span> (result)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee已经更新了&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee没有找到&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;DELETE&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (context.Request.Query.ContainsKey(<span class="string">&quot;id&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> id = context.Request.Query[<span class="string">&quot;id&quot;</span>];</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">int</span>.TryParse(id, <span class="keyword">out</span> <span class="built_in">int</span> employeeId))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">var</span> result = EmployeesRepository.DeleteEmployee(employeeId);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (result)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee已被成功删除&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee没有找到&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeesRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;工程师&quot;</span>, <span class="number">60000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">2</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;经理&quot;</span>, <span class="number">75000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">3</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;技术员&quot;</span>, <span class="number">50000</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Employee&gt; <span class="title">GetEmployees</span>()</span> =&gt; employees;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddEmployees</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Add(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">UpdateEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> emp = employees.FirstOrDefault(x =&gt; x.Id == employee.Id);</span><br><span class="line">            <span class="keyword">if</span> (emp <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                emp.Name = employee.Name;</span><br><span class="line">                emp.Position = employee.Position;</span><br><span class="line">                emp.Salary = employee.Salary;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">DeleteEmployee</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> employee = employees.FirstOrDefault(x =&gt; x.Id == id);</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Remove(employee);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span> position, <span class="built_in">double</span> salary</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        Name = name;</span><br><span class="line">        Position = position;</span><br><span class="line">        Salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<center>
<figure>
<style>.ivekeglnvnyk{zoom:80%}</style><img src="/2025/04/08/NET-ASP-02/image-20250409134744770.png" class="ivekeglnvnyk">
<style>.tqgtikducikr{zoom:80%}</style><img src="/2025/04/08/NET-ASP-02/image-20250409134934021.png" class="tqgtikducikr">
</figure>
</center>

<h1 id="7、ASP-NET应用（HTTP-Request-Headers）"><a href="#7、ASP-NET应用（HTTP-Request-Headers）" class="headerlink" title="7、ASP.NET应用（HTTP Request Headers）"></a>7、ASP.NET应用（HTTP Request Headers）</h1><p>在DELETE添加授权验证为请求头中包含”Authorization&#x3D;李“</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.Run(<span class="keyword">async</span> (HttpContext context) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    context.Response.ContentType = <span class="string">&quot;text/plain; charset=utf-8&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;GET&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的方法是<span class="subst">&#123;context.Request.Method&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的路径是<span class="subst">&#123;context.Request.Path&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;\r\n该请求的请求头有\r\n&quot;</span>);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> key <span class="keyword">in</span> context.Request.Headers.Keys)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;key&#125;</span>：<span class="subst">&#123;context.Request.Headers[key]&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的请求体是<span class="subst">&#123;context.Request.Body&#125;</span>\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> employee <span class="keyword">in</span> employees)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;employee.Name&#125;</span>: <span class="subst">&#123;employee.Position&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;POST&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line">            <span class="keyword">var</span> body = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">            <span class="keyword">var</span> employee = JsonSerializer.Deserialize&lt;Employee&gt;(body);</span><br><span class="line">            EmployeesRepository.AddEmployees(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;PUT&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line">            <span class="keyword">var</span> body = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">            <span class="keyword">var</span> employee = JsonSerializer.Deserialize&lt;Employee&gt;(body);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> result = EmployeesRepository.UpdateEmployee(employee);</span><br><span class="line">            <span class="keyword">if</span> (result)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee已经更新了&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee没有找到&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;DELETE&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (context.Request.Query.ContainsKey(<span class="string">&quot;id&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> id = context.Request.Query[<span class="string">&quot;id&quot;</span>];</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">int</span>.TryParse(id, <span class="keyword">out</span> <span class="built_in">int</span> employeeId))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (context.Request.Headers[<span class="string">&quot;Authorization&quot;</span>] == <span class="string">&quot;li&quot;</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">var</span> result = EmployeesRepository.DeleteEmployee(employeeId);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (result)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee已被成功删除&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee没有找到&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;你没有被授权&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeesRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;工程师&quot;</span>, <span class="number">60000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">2</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;经理&quot;</span>, <span class="number">75000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">3</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;技术员&quot;</span>, <span class="number">50000</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Employee&gt; <span class="title">GetEmployees</span>()</span> =&gt; employees;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddEmployees</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Add(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">UpdateEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> emp = employees.FirstOrDefault(x =&gt; x.Id == employee.Id);</span><br><span class="line">            <span class="keyword">if</span> (emp <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                emp.Name = employee.Name;</span><br><span class="line">                emp.Position = employee.Position;</span><br><span class="line">                emp.Salary = employee.Salary;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">DeleteEmployee</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> employee = employees.FirstOrDefault(x =&gt; x.Id == id);</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Remove(employee);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span> position, <span class="built_in">double</span> salary</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        Name = name;</span><br><span class="line">        Position = position;</span><br><span class="line">        Salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<center>
<figure>
<style>.fdvdbovagqmk{zoom:80%}</style><img src="/2025/04/08/NET-ASP-02/image-20250409140117162.png" class="fdvdbovagqmk">
<style>.brjlnkrzxbrh{zoom:80%}</style><img src="/2025/04/08/NET-ASP-02/image-20250409140209856.png" class="brjlnkrzxbrh">
</figure>
</center>

<h1 id="8、ASP-NET应用逻辑重构"><a href="#8、ASP-NET应用逻辑重构" class="headerlink" title="8、ASP.NET应用逻辑重构"></a>8、ASP.NET应用逻辑重构</h1><p>应当是先确定访问的路由，再确定访问的方法，顺序不要颠倒</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.Run(<span class="keyword">async</span> (HttpContext context) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    context.Response.ContentType = <span class="string">&quot;text/plain; charset=utf-8&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的方法是<span class="subst">&#123;context.Request.Method&#125;</span>\r\n&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的路径是<span class="subst">&#123;context.Request.Path&#125;</span>\r\n&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;\r\n该请求的请求头有\r\n&quot;</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> key <span class="keyword">in</span> context.Request.Headers.Keys)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;key&#125;</span>：<span class="subst">&#123;context.Request.Headers[key]&#125;</span>\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;该请求的请求体是<span class="subst">&#123;context.Request.Body&#125;</span>\r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Path.StartsWithSegments(<span class="string">&quot;/employees&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;GET&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> employee <span class="keyword">in</span> employees)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;<span class="subst">&#123;employee.Name&#125;</span>: <span class="subst">&#123;employee.Position&#125;</span>\r\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;POST&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line">            <span class="keyword">var</span> body = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">            <span class="keyword">var</span> employee = JsonSerializer.Deserialize&lt;Employee&gt;(body);</span><br><span class="line"></span><br><span class="line">            EmployeesRepository.AddEmployees(employee);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;PUT&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> reader = <span class="keyword">new</span> StreamReader(context.Request.Body);</span><br><span class="line">            <span class="keyword">var</span> body = <span class="keyword">await</span> reader.ReadToEndAsync();</span><br><span class="line">            <span class="keyword">var</span> employee = JsonSerializer.Deserialize&lt;Employee&gt;(body);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> result = EmployeesRepository.UpdateEmployee(employee);</span><br><span class="line">            <span class="keyword">if</span> (result)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee已经更新了&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee没有找到&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (context.Request.Method == <span class="string">&quot;DELETE&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (context.Request.Query.ContainsKey(<span class="string">&quot;id&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> id = context.Request.Query[<span class="string">&quot;id&quot;</span>];</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">int</span>.TryParse(id, <span class="keyword">out</span> <span class="built_in">int</span> employeeId))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (context.Request.Headers[<span class="string">&quot;Authorization&quot;</span>] == <span class="string">&quot;li&quot;</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">var</span> result = EmployeesRepository.DeleteEmployee(employeeId);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (result)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee已被成功删除&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Employee没有找到&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;你没有被授权&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeesRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;工程师&quot;</span>, <span class="number">60000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">2</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;经理&quot;</span>, <span class="number">75000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">3</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;技术员&quot;</span>, <span class="number">50000</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Employee&gt; <span class="title">GetEmployees</span>()</span> =&gt; employees;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddEmployees</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Add(employee);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">UpdateEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> emp = employees.FirstOrDefault(x =&gt; x.Id == employee.Id);</span><br><span class="line">            <span class="keyword">if</span> (emp <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                emp.Name = employee.Name;</span><br><span class="line">                emp.Position = employee.Position;</span><br><span class="line">                emp.Salary = employee.Salary;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">DeleteEmployee</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> employee = employees.FirstOrDefault(x =&gt; x.Id == id);</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Remove(employee);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span> position, <span class="built_in">double</span> salary</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        Name = name;</span><br><span class="line">        Position = position;</span><br><span class="line">        Salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="9、ASP-NET应用（HTTP-Response）"><a href="#9、ASP-NET应用（HTTP-Response）" class="headerlink" title="9、ASP.NET应用（HTTP Response）"></a>9、ASP.NET应用（HTTP Response）</h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://alsl521.github.io">kyl</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://alsl521.github.io/2025/04/08/NET-ASP-02/">https://alsl521.github.io/2025/04/08/NET-ASP-02/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://alsl521.github.io" target="_blank">kyl的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C#</a></div><div class="post-share"><div class="social-share" data-image="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/08/NET-ASP-01/" title="ASP.NET学习记录-01-基础知识"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">ASP.NET学习记录-01-基础知识</div></div><div class="info-2"><div class="info-item-1">视频教程为：ASP.NET Core Deep-Dive in .NET 9 | Udemy 1、.NET Core.NET Core 是微软开发的开源、跨平台应用程序开发框架，旨在为现代云原生、微服务及高性能场景提供支持。以下是其核心特性与定位的详细说明：  一、核心定义与定位 跨平台支持 .NET Core 可在 Windows、Linux、macOS 等操作系统上运行，并支持 x86、x64、ARM 等多种架构。 这种跨平台能力使其成为开发云原生、容器化应用（如 Docker）的理想选择。  开源与社区驱动 作为 MIT 协议下的开源项目，.NET Core 的代码托管于 GitHub，接受社区贡献，确保了技术透明度和快速迭代。    二、架构与技术特性 模块化设计 采用包化（Packages）管理，开发者可按需引用组件，减少应用体积，与传统的 .NET Framework 打包式安装形成对比。例如，通过 1dotnet restore  命令可动态还原依赖的 NuGet 包。  高性能运行时  RyuJIT 编译器：相比传统 JIT，性能提升约 25%，支持 SIMD...</div></div></div></a><a class="pagination-related" href="/2025/04/09/NET-ASP-03/" title="ASP.NET学习记录-03-中间件管道"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">ASP.NET学习记录-03-中间件管道</div></div><div class="info-2"><div class="info-item-1">1、中间件管道简介在 C# ASP.NET Core 中，中间件管道是处理 HTTP 请求和响应的核心机制，通过将多个中间件按顺序串联成一个处理流程，实现灵活的请求处理和业务逻辑组合。以下是其核心要点：  1. 中间件管道的基本概念 中间件（Middleware）：是管道中的独立组件，负责处理 HTTP 请求和响应。每个中间件可以：  对请求进行预处理（如日志、身份验证）。  调用下一个中间件（通过 next()），或直接终止处理（短路）。  对响应进行后处理（如修改响应头、记录耗时）。      管道（Pipeline）：由多个中间件按注册顺序串联而成，形成一个“请求→处理→响应”的流程。请求按顺序经过所有中间件，而响应则逆序返回  。    2. 管道的工作模式：1-n 然后 n-1 请求阶段（正向传递）：请求从第一个中间件开始，依次传递至最后一个中间件（终结点），形成“1→2→3”的顺序 。  响应阶段（逆向返回）：处理完成后，响应从终结点开始，逆序返回至第一个中间件，形成“3→2→1”的顺序  。 示例 123Middleware One: Request Start...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/04/08/NET-ASP-01/" title="ASP.NET学习记录-01-基础知识"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-01-基础知识</div></div><div class="info-2"><div class="info-item-1">视频教程为：ASP.NET Core Deep-Dive in .NET 9 | Udemy 1、.NET Core.NET Core 是微软开发的开源、跨平台应用程序开发框架，旨在为现代云原生、微服务及高性能场景提供支持。以下是其核心特性与定位的详细说明：  一、核心定义与定位 跨平台支持 .NET Core 可在 Windows、Linux、macOS 等操作系统上运行，并支持 x86、x64、ARM 等多种架构。 这种跨平台能力使其成为开发云原生、容器化应用（如 Docker）的理想选择。  开源与社区驱动 作为 MIT 协议下的开源项目，.NET Core 的代码托管于 GitHub，接受社区贡献，确保了技术透明度和快速迭代。    二、架构与技术特性 模块化设计 采用包化（Packages）管理，开发者可按需引用组件，减少应用体积，与传统的 .NET Framework 打包式安装形成对比。例如，通过 1dotnet restore  命令可动态还原依赖的 NuGet 包。  高性能运行时  RyuJIT 编译器：相比传统 JIT，性能提升约 25%，支持 SIMD...</div></div></div></a><a class="pagination-related" href="/2025/04/09/NET-ASP-03/" title="ASP.NET学习记录-03-中间件管道"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-09</div><div class="info-item-2">ASP.NET学习记录-03-中间件管道</div></div><div class="info-2"><div class="info-item-1">1、中间件管道简介在 C# ASP.NET Core 中，中间件管道是处理 HTTP 请求和响应的核心机制，通过将多个中间件按顺序串联成一个处理流程，实现灵活的请求处理和业务逻辑组合。以下是其核心要点：  1. 中间件管道的基本概念 中间件（Middleware）：是管道中的独立组件，负责处理 HTTP 请求和响应。每个中间件可以：  对请求进行预处理（如日志、身份验证）。  调用下一个中间件（通过 next()），或直接终止处理（短路）。  对响应进行后处理（如修改响应头、记录耗时）。      管道（Pipeline）：由多个中间件按注册顺序串联而成，形成一个“请求→处理→响应”的流程。请求按顺序经过所有中间件，而响应则逆序返回  。    2. 管道的工作模式：1-n 然后 n-1 请求阶段（正向传递）：请求从第一个中间件开始，依次传递至最后一个中间件（终结点），形成“1→2→3”的顺序 。  响应阶段（逆向返回）：处理完成后，响应从终结点开始，逆序返回至第一个中间件，形成“3→2→1”的顺序  。 示例 123Middleware One: Request Start...</div></div></div></a><a class="pagination-related" href="/2025/04/10/NET-ASP-04/" title="ASP.NET学习记录-04-路由"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-10</div><div class="info-item-2">ASP.NET学习记录-04-路由</div></div><div class="info-2"><div class="info-item-1">1、Routing和Endpoints简介在ASP.NET Core中，**路由（Routing）和终结点（Endpoints）**是处理HTTP请求的核心机制，它们共同构成了请求分发的管道系统。以下是对两者的详细介绍：  一、路由（Routing）路由的核心作用是将传入的HTTP请求根据URL路径和HTTP方法匹配到对应的处理逻辑（终结点）。在ASP.NET Core中，路由系统被称为终结点路由（Endpoint Routing）。 主要功能与工作流程 匹配请求：通过UseRouting中间件（即EndpointRoutingMiddleware）扫描应用中所有注册的终结点，根据请求的URL和HTTP方法选择最匹配的终结点 。示例代码：  12345app.UseRouting();app.UseEndpoints(endpoints =&gt; &#123;    endpoints.MapGet(&quot;/&quot;, async context =&gt; &#123; ......</div></div></div></a><a class="pagination-related" href="/2025/04/11/NET-ASP-05/" title="ASP.NET学习记录-05-模型数据绑定"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-11</div><div class="info-item-2">ASP.NET学习记录-05-模型数据绑定</div></div><div class="info-2"><div class="info-item-1">1、模型绑定定义模型绑定是ASP.NET Core中将HTTP请求数据自动映射到方法参数或对象属性的机制。其核心工作流程：  数据来源：  路由参数（URL片段） 查询字符串（?key&#x3D;value） 请求体（表单&#x2F;JSON&#x2F;XML） 请求头 文件上传   典型应用：   12345678910111213// 自动绑定路由参数和查询参数[HttpGet(&quot;/products/&#123;id&#125;&quot;)]public IActionResult GetProduct(int id, [FromQuery] string category) &#123;    // id来自路由参数，category来自查询字符串&#125;// 自动绑定JSON请求体[HttpPost]public IActionResult Create([FromBody] Product product)&#123;    //...</div></div></div></a><a class="pagination-related" href="/2025/04/15/NET-ASP-09/" title="ASP.NET学习记录-09-MVC"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-15</div><div class="info-item-2">ASP.NET学习记录-09-MVC</div></div><div class="info-2"><div class="info-item-1">1、MVC PatternASP.NET中的MVC（Model-View-Controller）模式是一种软件架构设计模式，它将应用程序分为三个核心组件：模型（Model）、视图（View）和控制器（Controller），以实现关注点分离，提升代码可维护性和可扩展性。  以下是其具体内涵及在ASP.NET中的应用特点： 1....</div></div></div></a><a class="pagination-related" href="/2025/04/14/NET-ASP-06/" title="ASP.NET学习记录-06-最小API结果生产"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-14</div><div class="info-item-2">ASP.NET学习记录-06-最小API结果生产</div></div><div class="info-2"><div class="info-item-1">本次学习基础代码如下： Employee.cs 12345678910111213141516171819202122232425262728293031323334353637383940414243444546using System.ComponentModel.DataAnnotations;namespace WebApi.Models&#123;    /// &lt;summary&gt;    /// 员工实体类    /// &lt;/summary&gt;    public class Employee    &#123;        /// &lt;summary&gt;        /// 员工唯一标识符        /// &lt;/summary&gt;        public int Id &#123; get; set; &#125;        /// &lt;summary&gt;        /// 员工姓名        /// &lt;/summary&gt;        public string Name...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">kyl</div><div class="author-info-description">用于记录平时学习的博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/alsl521" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:852970167@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E7%AC%AC%E4%B8%80%E4%B8%AAASP-NET%E5%BA%94%E7%94%A8%EF%BC%88Minimal-API%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">1、创建第一个ASP.NET应用（Minimal API）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E6%96%B0%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.</span> <span class="toc-text">1.创建新项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">2.项目架构简介与解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%88Solution%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">1. 解决方案（Solution）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%A1%B9%E7%9B%AE%EF%BC%88Project-WebApplication%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. 项目（Project: WebApplication）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-Connected-Services-%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">a. Connected Services 文件夹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-Properties-%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">b. Properties 文件夹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#c-%E4%BE%9D%E8%B5%96%E9%A1%B9%EF%BC%88Dependencies%EF%BC%89"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">c. 依赖项（Dependencies）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#d-appsettings-json"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">d. appsettings.json</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#e-Program-cs"><span class="toc-number">1.2.2.5.</span> <span class="toc-text">e. Program.cs</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-var-builder-WebApplication-CreateBuilder-args"><span class="toc-number">1.2.2.5.1.</span> <span class="toc-text">1. var builder &#x3D; WebApplication.CreateBuilder(args);</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-var-app-builder-Build"><span class="toc-number">1.2.2.5.2.</span> <span class="toc-text">2. var app &#x3D; builder.Build();</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-app-MapGet-Hello-World"><span class="toc-number">1.2.2.5.3.</span> <span class="toc-text">3. app.MapGet(&quot;&#x2F;&quot;, () &#x3D;&gt; &quot;Hello World!&quot;);</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-app-Run"><span class="toc-number">1.2.2.5.4.</span> <span class="toc-text">4. app.Run();</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%A7%A3"><span class="toc-number">1.2.2.5.5.</span> <span class="toc-text">完整流程图解</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5%E6%89%A9%E5%B1%95"><span class="toc-number">1.2.2.5.6.</span> <span class="toc-text">关键概念扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-WebApplicationBuilder-%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.2.2.5.6.1.</span> <span class="toc-text">1. WebApplicationBuilder 的作用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1%E4%B8%8E%E7%AB%AF%E7%82%B9%EF%BC%88Endpoints%EF%BC%89"><span class="toc-number">1.2.2.5.6.2.</span> <span class="toc-text">2. 路由与端点（Endpoints）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%AE%A1%E9%81%93"><span class="toc-number">1.2.2.5.6.3.</span> <span class="toc-text">3. 中间件管道</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">1.2.2.5.6.4.</span> <span class="toc-text">完整示例代码</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E7%AD%94"><span class="toc-number">1.2.2.5.6.5.</span> <span class="toc-text">常见问题解答</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.2.2.5.6.6.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%EF%BC%88Dependency-Injection-DI%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. 依赖注入（Dependency Injection, DI）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.4.</span> <span class="toc-text">4. 环境配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BB%A3%E7%A0%81%E4%B8%8E%E8%B5%84%E6%BA%90%E7%BB%84%E7%BB%87"><span class="toc-number">1.2.5.</span> <span class="toc-text">5. 代码与资源组织</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84%E5%8D%8F%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.6.</span> <span class="toc-text">架构协作流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">1.2.7.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">1.3.</span> <span class="toc-text">3.执行结果</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%E3%80%81ASP-NET%E5%BA%94%E7%94%A8%EF%BC%88HttpContext%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">2、ASP.NET应用（HttpContext）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BB%A3%E7%A0%81%E7%BB%93%E6%9E%84%E8%A7%A3%E6%9E%90"><span class="toc-number">2.0.1.</span> <span class="toc-text">一、代码结构解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E8%A7%A3%E6%9E%90"><span class="toc-number">2.0.2.</span> <span class="toc-text">二、核心功能解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE"><span class="toc-number">2.0.3.</span> <span class="toc-text">三、优化建议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%A7%A3"><span class="toc-number">2.0.4.</span> <span class="toc-text">四、运行流程图解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">2.0.5.</span> <span class="toc-text">五、注意事项</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%E3%80%81ASP-NET%E5%BA%94%E7%94%A8%EF%BC%88Http-GET%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">3、ASP.NET应用（Http GET）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5%E3%80%81ASP-NET%E5%BA%94%E7%94%A8%EF%BC%88Http-PUT%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">5、ASP.NET应用（Http PUT）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6%E3%80%81ASP-NET%E5%BA%94%E7%94%A8%EF%BC%88Http-DELETE%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">6、ASP.NET应用（Http DELETE）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E3%80%81ASP-NET%E5%BA%94%E7%94%A8%EF%BC%88HTTP-Request-Headers%EF%BC%89"><span class="toc-number">6.</span> <span class="toc-text">7、ASP.NET应用（HTTP Request Headers）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8%E3%80%81ASP-NET%E5%BA%94%E7%94%A8%E9%80%BB%E8%BE%91%E9%87%8D%E6%9E%84"><span class="toc-number">7.</span> <span class="toc-text">8、ASP.NET应用逻辑重构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9%E3%80%81ASP-NET%E5%BA%94%E7%94%A8%EF%BC%88HTTP-Response%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">9、ASP.NET应用（HTTP Response）</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/21/NET-ASP-13/" title="ASP.NET学习记录-13-实践2-数据库进阶">ASP.NET学习记录-13-实践2-数据库进阶</a><time datetime="2025-04-21T08:39:19.000Z" title="发表于 2025-04-21 16:39:19">2025-04-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/18/NET-ASP-12/" title="ASP.NET学习记录-12-实践2-使用MySQL数据库">ASP.NET学习记录-12-实践2-使用MySQL数据库</a><time datetime="2025-04-18T08:11:21.000Z" title="发表于 2025-04-18 16:11:21">2025-04-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/18/NET-ASP-11/" title="ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API">ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API</a><time datetime="2025-04-18T02:13:44.000Z" title="发表于 2025-04-18 10:13:44">2025-04-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/16/NET-ASP-10/" title="ASP.NET学习记录-10-过滤">ASP.NET学习记录-10-过滤</a><time datetime="2025-04-16T12:02:16.000Z" title="发表于 2025-04-16 20:02:16">2025-04-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/15/Software/" title="记录必备软件">记录必备软件</a><time datetime="2025-04-15T11:29:21.000Z" title="发表于 2025-04-15 19:29:21">2025-04-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By kyl</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>