<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ASP.NET学习记录-05-模型数据绑定 | kyl的博客</title><meta name="author" content="kyl"><meta name="copyright" content="kyl"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:type" content="article">
<meta property="og:title" content="ASP.NET学习记录-05-模型数据绑定">
<meta property="og:url" content="https://alsl521.github.io/2025/04/11/NET-ASP-05/index.html">
<meta property="og:site_name" content="kyl的博客">
<meta property="og:description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4">
<meta property="article:published_time" content="2025-04-11T07:14:31.000Z">
<meta property="article:modified_time" content="2025-04-14T13:29:54.502Z">
<meta property="article:author" content="kyl">
<meta property="article:tag" content="C#">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ASP.NET学习记录-05-模型数据绑定",
  "url": "https://alsl521.github.io/2025/04/11/NET-ASP-05/",
  "image": "https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4",
  "datePublished": "2025-04-11T07:14:31.000Z",
  "dateModified": "2025-04-14T13:29:54.502Z",
  "author": [
    {
      "@type": "Person",
      "name": "kyl",
      "url": "https://alsl521.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://alsl521.github.io/2025/04/11/NET-ASP-05/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ASP.NET学习记录-05-模型数据绑定',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">kyl的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">ASP.NET学习记录-05-模型数据绑定</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">ASP.NET学习记录-05-模型数据绑定</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-11T07:14:31.000Z" title="发表于 2025-04-11 15:14:31">2025-04-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-14T13:29:54.502Z" title="更新于 2025-04-14 21:29:54">2025-04-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/">C#</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/ASP/">ASP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="1、模型绑定定义"><a href="#1、模型绑定定义" class="headerlink" title="1、模型绑定定义"></a>1、模型绑定定义</h1><p>模型绑定是ASP.NET Core中将HTTP请求数据自动映射到方法参数或对象属性的机制。其核心工作流程：</p>
<ol>
<li><p><strong>数据来源</strong>：</p>
<ul>
<li>路由参数（URL片段）</li>
<li>查询字符串（?key&#x3D;value）</li>
<li>请求体（表单&#x2F;JSON&#x2F;XML）</li>
<li>请求头</li>
<li>文件上传</li>
</ul>
</li>
<li><p><strong>典型应用</strong>：</p>
</li>
</ol>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自动绑定路由参数和查询参数</span></span><br><span class="line">[<span class="meta">HttpGet(<span class="string">&quot;/products/&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">GetProduct</span>(<span class="params"><span class="built_in">int</span> id, [FromQuery] <span class="built_in">string</span> category</span>)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// id来自路由参数，category来自查询字符串</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自动绑定JSON请求体</span></span><br><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Create</span>(<span class="params">[FromBody] Product product</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 自动将JSON反序列化为Product对象</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p><strong>处理流程</strong>：</p>
<ol>
<li>接收HTTP请求</li>
<li>根据参数名称&#x2F;类型识别目标模型</li>
<li>从预定义数据源提取对应值</li>
<li>执行类型转换（字符串→目标类型）</li>
<li>验证数据有效性</li>
<li>填充到控制器方法参数</li>
</ol>
</li>
<li><p><strong>优势特点</strong>：</p>
<ul>
<li>消除手动数据解析代码</li>
<li>支持复杂对象嵌套绑定</li>
<li>内置类型安全验证</li>
<li>可扩展自定义绑定逻辑</li>
</ul>
</li>
</ol>
<p>简单实现</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApp.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例，用于配置和构建Web应用</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启用路由中间件，用于处理请求路由</span></span><br><span class="line">app.UseRouting();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置端点路由，定义应用程序的API端点</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义GET请求端点：获取员工信息</span></span><br><span class="line">    <span class="comment">// 路由模板：/employees/&#123;id&#125;，其中id是可选的整数参数</span></span><br><span class="line">    <span class="comment">// 使用[FromRoute]特性显式绑定路由参数，并指定参数名称为&quot;id&quot;</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/employees/&#123;id:int?&#125;&quot;</span>,</span><br><span class="line">        ([FromRoute(Name = <span class="string">&quot;id&quot;</span>)] <span class="built_in">int</span>? id) =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 检查是否提供了id参数</span></span><br><span class="line">            <span class="keyword">if</span> (id.HasValue)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 调用数据访问层方法，根据ID查询员工信息</span></span><br><span class="line">                <span class="keyword">var</span> employee = EmployeesRepository.GetEmployeeById(id.Value);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 直接返回员工对象，ASP.NET Core会自动将其序列化为JSON响应</span></span><br><span class="line">                <span class="keyword">return</span> employee;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果没有提供id参数，返回null</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动Web应用程序，开始监听HTTP请求</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<center>
<figure>
<style>.cgqfetutayqv{}</style><img src="/2025/04/11/NET-ASP-05/image-20250411152542477.png" class="cgqfetutayqv">
<style>.xervgunnqprl{}</style><img src="/2025/04/11/NET-ASP-05/image-20250411153338697.png" class="xervgunnqprl">
</figure>
</center>
# 2、**路由参数绑定**

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApp.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例，用于配置依赖注入和服务</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启用路由中间件，处理HTTP请求的路由匹配</span></span><br><span class="line">app.UseRouting();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置端点路由规则</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义有问题的GET端点：当前路由模板缺少参数占位符</span></span><br><span class="line">    <span class="comment">// ❌ 路由模板&quot;/employees&quot;未包含&#123;id&#125;参数占位符</span></span><br><span class="line">    <span class="comment">// ❌ 参数id未指定绑定来源（应使用[FromQuery]或修正路由模板）</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/employees&quot;</span>, (<span class="built_in">int</span> id) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 尝试通过未绑定的id参数查询员工</span></span><br><span class="line">        <span class="comment">// ⚠️ 实际运行时将抛出绑定异常：未指定参数来源</span></span><br><span class="line">        <span class="keyword">var</span> employee = EmployeesRepository.GetEmployeeById(id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回对象将由ASP.NET Core自动序列化为JSON</span></span><br><span class="line">        <span class="keyword">return</span> employee;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动Web主机并开始监听请求</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<center>
<figure>
<style>.cpslhawxhgjy{}</style><img src="/2025/04/11/NET-ASP-05/image-20250411154059464.png" class="cpslhawxhgjy">
<style>.xbxcxiycrpbb{}</style><img src="/2025/04/11/NET-ASP-05/image-20250411154027988.png" class="xbxcxiycrpbb">
</figure>
</center>
但如果查询参数名称与路由参数名称一致，仍然可以使用隐式绑定实现查询结果，否则就要使用显示绑定，例如：

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置端点路由，定义应用程序的API端点</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义GET请求端点：获取员工信息</span></span><br><span class="line">    <span class="comment">// 路由模板：/employees/&#123;id&#125;，其中id是可选的整数参数</span></span><br><span class="line">    <span class="comment">// 使用[FromRoute]特性显式绑定路由参数，并指定参数名称为&quot;id&quot;</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/employees&quot;</span>, (<span class="built_in">int</span> id) =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用数据访问层方法，根据ID查询员工信息</span></span><br><span class="line">            <span class="keyword">var</span> employee = EmployeesRepository.GetEmployeeById(id);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 直接返回员工对象，ASP.NET Core会自动将其序列化为JSON响应</span></span><br><span class="line">            <span class="keyword">return</span> employee;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250411155230792.png" alt="image-20250411155230792"></p>
<p>且如果同时出现查询参数与路由参数，那么会仅使用路由参数，例如：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置端点路由，定义应用程序的API端点</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义GET请求端点：获取员工信息</span></span><br><span class="line">    <span class="comment">// 路由模板：/employees/&#123;id&#125;，其中id是可选的整数参数</span></span><br><span class="line">    <span class="comment">// 使用[FromRoute]特性显式绑定路由参数，并指定参数名称为&quot;id&quot;</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/employees/&#123;id:int?&#125;&quot;</span>, ([FromRoute(Name = <span class="string">&quot;id&quot;</span>)] <span class="built_in">int</span>? id) =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 检查是否提供了id参数</span></span><br><span class="line">            <span class="keyword">if</span> (id.HasValue)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 调用数据访问层方法，根据ID查询员工信息</span></span><br><span class="line">                <span class="keyword">var</span> employee = EmployeesRepository.GetEmployeeById(id.Value);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 直接返回员工对象，ASP.NET Core会自动将其序列化为JSON响应</span></span><br><span class="line">                <span class="keyword">return</span> employee;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果没有提供id参数，返回null</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250411155134407.png" alt="image-20250411155134407"></p>
<h1 id="3、请求头参数绑定"><a href="#3、请求头参数绑定" class="headerlink" title="3、请求头参数绑定"></a>3、<strong>请求头参数绑定</strong></h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApp.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例，用于配置服务和中间件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启用路由中间件，处理请求路径匹配</span></span><br><span class="line">app.UseRouting();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置端点路由规则</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义存在问题的GET端点</span></span><br><span class="line">    <span class="comment">// ⚠️ 路由模板&quot;/employees&quot;未包含参数占位符</span></span><br><span class="line">    <span class="comment">// ⚠️ [FromHeader]绑定与路由模板不匹配</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/employees&quot;</span>,</span><br><span class="line">        <span class="comment">// 从请求头&quot;identity&quot;绑定参数，但变量命名为id</span></span><br><span class="line">        ([FromHeader(Name = <span class="string">&quot;identity&quot;</span>)] <span class="built_in">int</span> id) =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 通过数据访问层查询员工信息</span></span><br><span class="line">            <span class="comment">// ⚠️ 缺少参数有效性验证（如id&gt;0）</span></span><br><span class="line">            <span class="keyword">var</span> employee = EmployeesRepository.GetEmployeeById(id);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 自动返回JSON格式响应</span></span><br><span class="line">            <span class="keyword">return</span> employee;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动应用程序并开始监听端口</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250411163838342.png" alt="image-20250411163838342"></p>
<h1 id="4、使用-AsParameters-特性实现参数分组"><a href="#4、使用-AsParameters-特性实现参数分组" class="headerlink" title="4、使用[AsParameters]特性实现参数分组"></a>4、<strong>使用[AsParameters]特性实现参数分组</strong></h1><p>模拟多条件下使用</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApp.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例，用于配置服务和中间件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启用路由中间件，处理请求路径匹配</span></span><br><span class="line">app.UseRouting();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置端点路由规则</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义员工查询端点</span></span><br><span class="line">    <span class="comment">// ✔ 路由模板包含参数占位符 &#123;id:int&#125; 确保类型安全</span></span><br><span class="line">    <span class="comment">// ✔ 混合参数绑定方式：</span></span><br><span class="line">    <span class="comment">//   - id 从路由路径绑定（隐式[FromRoute]）</span></span><br><span class="line">    <span class="comment">//   - name 从查询字符串绑定（显式[FromQuery]）</span></span><br><span class="line">    <span class="comment">//   - position 从请求头绑定（显式[FromHeader]）</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/employees/&#123;id:int&#125;&quot;</span>, (<span class="built_in">int</span> id, [FromQuery] <span class="built_in">string</span> name, [FromHeader] <span class="built_in">string</span> position) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 通过ID查询员工基础信息</span></span><br><span class="line">        <span class="keyword">var</span> employee = EmployeesRepository.GetEmployeeById(id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 更新动态字段（需注意：此处直接修改可能违反不变性原则）</span></span><br><span class="line">        employee.Name = name;         <span class="comment">// 来自URL查询参数</span></span><br><span class="line">        employee.Position = position;  <span class="comment">// 来自请求头</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回JSON响应（自动序列化）</span></span><br><span class="line">        <span class="comment">// ⚠ 建议添加异常处理（如员工不存在的情况）</span></span><br><span class="line">        <span class="keyword">return</span> employee;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动应用程序并开始监听端口</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250411164547474.png" alt="image-20250411164547474"></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApp.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例，用于配置服务和中间件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启用路由中间件，处理请求路径匹配</span></span><br><span class="line">app.UseRouting();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置端点路由规则</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义员工查询端点（使用参数分组优化）</span></span><br><span class="line">    <span class="comment">// ✔ 路由模板包含强类型参数 &#123;id:int&#125;</span></span><br><span class="line">    <span class="comment">// ✔ 使用[AsParameters]特性将分散参数封装为DTO对象</span></span><br><span class="line">    <span class="comment">// ✔ 参数来源清晰标注：</span></span><br><span class="line">    <span class="comment">//   - Id: 从路由路径绑定</span></span><br><span class="line">    <span class="comment">//   - Name: 从查询字符串绑定  </span></span><br><span class="line">    <span class="comment">//   - Position: 从请求头绑定</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/employees/&#123;id:int&#125;&quot;</span>, ([AsParameters] GetEmployeeParameters param) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 参数自动绑定说明：</span></span><br><span class="line">        <span class="comment">// 1. 框架会自动将路由/查询/头部的参数映射到param对象</span></span><br><span class="line">        <span class="comment">// 2. 相比分散参数更易于维护和扩展</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过ID查询员工基础信息</span></span><br><span class="line">        <span class="comment">// ⚠ 建议添加null检查（param.Id可能无效）</span></span><br><span class="line">        <span class="keyword">var</span> employee = EmployeesRepository.GetEmployeeById(param.Id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 更新员工动态字段</span></span><br><span class="line">        <span class="comment">// ⚠ 注意：直接修改实体可能违反领域驱动设计原则</span></span><br><span class="line">        employee.Name = param.Name;        <span class="comment">// 来自查询字符串</span></span><br><span class="line">        employee.Position = param.Position; <span class="comment">// 来自请求头</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回JSON响应（自动序列化）</span></span><br><span class="line">        <span class="comment">// ⚠ 建议：添加NotFound等错误处理</span></span><br><span class="line">        <span class="keyword">return</span> employee;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动应用程序并开始监听端口</span></span><br><span class="line">app.Run();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 参数分组DTO类</span></span><br><span class="line"><span class="comment">// ✔ 集中管理端点参数，提高可维护性</span></span><br><span class="line"><span class="comment">// ✔ 通过特性明确每个参数的来源</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">GetEmployeeParameters</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">FromRoute</span>]  <span class="comment">// 从路由路径绑定</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">FromQuery</span>]  <span class="comment">// 从查询字符串绑定</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">FromHeader</span>] <span class="comment">// 从请求头绑定</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250411171034886.png" alt="image-20250411171034886"></p>
<h1 id="5、实现数组参数与查询字符串或请求头的绑定"><a href="#5、实现数组参数与查询字符串或请求头的绑定" class="headerlink" title="5、实现数组参数与查询字符串或请求头的绑定"></a>5、实现数组参数与查询字符串或请求头的绑定</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApp.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用初始化阶段</span></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例，用于配置服务和中间件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 中间件配置</span></span><br><span class="line"><span class="comment">// 启用路由中间件，处理请求路径匹配</span></span><br><span class="line">app.UseRouting();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 端点路由配置</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ✔ 查询字符串数组绑定示例</span></span><br><span class="line">    <span class="comment">// 传参格式：/employees?id=1&amp;id=2 或 ?id=1,2,3</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/employees&quot;</span>, ([FromQuery(Name = <span class="string">&quot;id&quot;</span>)] <span class="built_in">int</span>[] ids) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 参数处理说明：</span></span><br><span class="line">        <span class="comment">// 1. ASP.NET Core 自动将重复的查询参数转换为数组</span></span><br><span class="line">        <span class="comment">// 2. 支持逗号分隔的字符串解析为数组</span></span><br><span class="line">        <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">        <span class="keyword">var</span> emps = employees.Where(x =&gt; ids.Contains(x.Id)).ToList();</span><br><span class="line">        <span class="keyword">return</span> emps;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用启动</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250414101116698.png" alt="image-20250414101116698"></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApp.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用初始化阶段</span></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例，用于配置服务和中间件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 中间件配置</span></span><br><span class="line"><span class="comment">// 启用路由中间件，处理请求路径匹配</span></span><br><span class="line">app.UseRouting();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 端点路由配置</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ⚠ 非常规实践：通过Header传递主键数组</span></span><br><span class="line">    <span class="comment">// ✔ 请求头数组绑定示例</span></span><br><span class="line">    <span class="comment">// 传参格式：Header添加 id: 1,2,3</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/employees&quot;</span>, ([FromHeader(Name = <span class="string">&quot;id&quot;</span>)] <span class="built_in">int</span>[] ids) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 安全建议：</span></span><br><span class="line">        <span class="comment">// 1. 应验证Header来源的可靠性</span></span><br><span class="line">        <span class="comment">// 2. 建议设置最大数组长度限制</span></span><br><span class="line">        <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">        <span class="keyword">var</span> emps = employees.Where(x =&gt; ids.Contains(x.Id)).ToList();</span><br><span class="line">        <span class="keyword">return</span> emps;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用启动</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250414101349969.png" alt="image-20250414101349969"></p>
<h1 id="6、实现参数与请求体绑定"><a href="#6、实现参数与请求体绑定" class="headerlink" title="6、实现参数与请求体绑定"></a>6、实现参数与请求体绑定</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApp.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用初始化阶段</span></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例，用于配置服务和中间件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 中间件配置</span></span><br><span class="line"><span class="comment">// 启用路由中间件，处理请求路径匹配</span></span><br><span class="line">app.UseRouting();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 端点路由配置</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义员工新增端点（POST方法）</span></span><br><span class="line">    <span class="comment">// ✔ 自动模型绑定：框架会将请求体JSON反序列化为Employee对象</span></span><br><span class="line">    <span class="comment">// ✔ 基础参数验证：检查员工对象是否为null或ID是否有效</span></span><br><span class="line">    endpoints.MapPost(<span class="string">&quot;/employees&quot;</span>, (Employee employee) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 参数验证说明：</span></span><br><span class="line">        <span class="comment">// 1. 检查employee对象是否为null（请求体为空的情况）</span></span><br><span class="line">        <span class="comment">// 2. 验证ID是否为正数（基础业务规则校验）</span></span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="literal">null</span> || employee.Id &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ⚠ 建议：使用标准错误响应格式（如ProblemDetails）</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Employee is not provided or is not valid.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 调用仓储层添加员工</span></span><br><span class="line">        <span class="comment">// ⚠ 注意：缺少事务处理和并发控制</span></span><br><span class="line">        EmployeesRepository.AddEmployee(employee);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回简单成功消息</span></span><br><span class="line">        <span class="comment">// ✔ 实际项目建议返回创建成功的资源标识（如201 Created响应）</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Employee added successfully.&quot;</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用启动</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250414101749924.png" alt="image-20250414101749924"></p>
<blockquote>
<p>但该种方式仍有缺点：</p>
<ol>
<li>在Mini API下，默认为JSON格式传递，不支持其他格式，例如XML格式。</li>
<li>在Mini API下，传递的JSON不能有不同类型的多个数据，例如无法同时传递Employee和Company</li>
</ol>
</blockquote>
<h1 id="7、实现参数与异步方法自定义绑定"><a href="#7、实现参数与异步方法自定义绑定" class="headerlink" title="7、实现参数与异步方法自定义绑定"></a>7、实现参数与异步方法自定义绑定</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;  <span class="comment">// ASP.NET Core MVC 功能</span></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Text.Json;         <span class="comment">// JSON 序列化/反序列化</span></span><br><span class="line"><span class="keyword">using</span> WebApp.Models;            <span class="comment">// 应用模型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用初始化阶段</span></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例，用于配置服务和中间件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);  <span class="comment">// 创建应用构建器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();  <span class="comment">// 构建应用实例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 中间件配置</span></span><br><span class="line"><span class="comment">// 启用路由中间件，处理请求路径匹配</span></span><br><span class="line">app.UseRouting();  <span class="comment">// 启用路由功能</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 端点路由配置</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;  <span class="comment">// 配置终结点路由</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义GET请求端点，处理/people路径</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/people&quot;</span>, (Person? p) =&gt;  <span class="comment">// p参数通过BindAsync方法绑定</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Id is <span class="subst">&#123;p?.Id&#125;</span>; Name is <span class="subst">&#123;p?.Name&#125;</span>&quot;</span>;  <span class="comment">// 返回格式化字符串</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用启动</span></span><br><span class="line">app.Run();  <span class="comment">// 启动应用</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Person</span>  <span class="comment">// 人员模型类</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;      <span class="comment">// ID属性</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// 可空姓名属性</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 自定义模型绑定方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ValueTask&lt;Person?&gt; BindAsync(HttpContext context)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 从查询字符串获取id参数</span></span><br><span class="line">        <span class="keyword">var</span> idStr = context.Request.Query[<span class="string">&quot;id&quot;</span>];</span><br><span class="line">        <span class="comment">// 从请求头获取name参数</span></span><br><span class="line">        <span class="keyword">var</span> nameStr = context.Request.Headers[<span class="string">&quot;name&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 尝试解析id为整数</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">int</span>.TryParse(idStr, <span class="keyword">out</span> <span class="keyword">var</span> id))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 成功则返回Person实例</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ValueTask&lt;Person?&gt;(<span class="keyword">new</span> Person &#123; Id = id, Name = nameStr &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析失败返回null</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ValueTask&lt;Person?&gt;(Task.FromResult&lt;Person?&gt;(<span class="literal">null</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250414103655483.png" alt="image-20250414103655483"></p>
<h1 id="8、绑定优先级"><a href="#8、绑定优先级" class="headerlink" title="8、绑定优先级"></a>8、绑定优先级</h1><p>在 ASP.NET Core 中，模型绑定会从多个数据源（路由、查询字符串、表单、请求正文等）中提取数据。当这些来源中可能存在相同名称的数据时，框架需要依据内部的“Binding source priorities”（绑定源优先级）来决定最终使用哪一个值。与此同时，开发者也可以通过“显式绑定”（Explicit Binding）的方式来<strong>明确规定</strong>数据的获取过程，其中最典型的做法就是利用类型中定义的 <code>BindAsync</code> 静态方法。</p>
<ol>
<li><p>显式绑定（Explicit Binding）</p>
<p><strong>显式绑定</strong>指的是开发者明确告知 ASP.NET Core 从哪个数据来源绑定数据，而不依赖模型绑定系统的默认查找机制。通常有两种方式实现显式绑定：</p>
<ul>
<li><strong>通过特性声明</strong>：在控制器参数或模型属性上使用 <code>[FromQuery]</code>、<code>[FromBody]</code>、<code>[FromRoute]</code> 等特性。</li>
<li><strong>通过自定义绑定逻辑</strong>：实现自定义模型绑定器或在模型类型中定义一个静态的 <code>BindAsync</code> 方法。</li>
</ul>
<p>这两种方式都属于“显式”告诉框架如何获取数据，从而绕过或预设默认的绑定源优先级顺序。</p>
</li>
<li><p>BindAsync<code> 方法的角色</code> </p>
<p>在 ASP.NET Core（尤其是 Minimal API 和一些高级场景中），如果一个模型类型定义了静态的 <code>BindAsync</code> 方法，那么 ASP.NET Core 在绑定时会优先调用这个方法。</p>
<ul>
<li><p><strong>为什么使用 <code>BindAsync</code>？</strong><code>BindAsync</code> 提供了一种显式的绑定机制，使得类型的绑定过程完全由开发者定义。这种方式具有如下优势：</p>
</li>
<li><p><strong>控制权更高</strong>：你可以在方法内部检查请求上下文，从多个数据源中提取数据，自行决定如何合并或选择。</p>
</li>
<li><p><strong>简化参数声明</strong>：无需在每个参数上反复声明 <code>[FromXxx]</code> 特性，只需在类型内部编写一次 <code>BindAsync</code> 方法，所有使用该类型的参数都将采用自定义逻辑。</p>
</li>
<li><p><strong>优先级覆盖</strong>：由于显式绑定逻辑总是优先于默认绑定源优先级，当类型实现了 <code>BindAsync</code> 后，框架不会再依靠路由、查询字符串、表单等默认顺序来寻找数据，而是直接调用 <code>BindAsync</code> 进行绑定。</p>
</li>
<li><p><strong><code>BindAsync</code> 的基本签名</strong>（可能因 ASP.NET Core 版本不同有细微变化，但大致如下）：</p>
<p>当 ASP.NET Core 在处理请求到相关终结点（endpoint）时，会检测参数类型是否有 <code>BindAsync</code> 方法。如果存在，则调用这个方法，<strong>完全绕过</strong>默认的绑定源查找顺序。这就是一种非常“显式”的绑定策略，能确保绑定行为与默认优先级无关，而完全由开发者控制。</p>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">async</span> ValueTask <span class="title">BindAsync</span>(<span class="params">HttpContext context, ParameterInfo parameter</span>)</span> &#123;    </span><br><span class="line"> <span class="comment">// 从 context 中获取数据（例如查询字符串、路由数据、请求正文等）    </span></span><br><span class="line"> <span class="comment">// 根据需要进行解析和验证    </span></span><br><span class="line"> <span class="comment">// 返回构造成功的 YourModelType 实例或者 null（如果绑定失败） </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>定源优先级的基础</p>
<p>ASP.NET Core 模型绑定默认会按照一定的顺序搜索数据来源。一个常见的优先级顺序如下：</p>
<table>
<thead>
<tr>
<th>1. Route（路由数据）</th>
</tr>
</thead>
<tbody><tr>
<td>2. Query String（查询字符串）</td>
</tr>
<tr>
<td>3. Form Data（表单数据）</td>
</tr>
<tr>
<td>4. Body（请求正文）</td>
</tr>
<tr>
<td>5. Header（请求头）</td>
</tr>
</tbody></table>
<p>这种默认顺序确保了当同一参数在多个数据源存在值时，框架能有条不紊地进行选择。如果不希望走这种默认的优先级模型，可以利用绑定属性（如 <code>[FromQuery]</code>、<code>[FromBody]</code> 等）来<strong>显式</strong>指定绑定来源。</p>
<ol>
<li><p><strong>模型绑定的基本流程</strong></p>
<p>当 ASP.NET 处理请求时，会根据请求中的数据自动将传入数据映射到控制器方法的参数或模型属性上。这些数据可能来源于：</p>
<ul>
<li><strong>路由数据</strong>（Route Data）：URL 路径中提取的信息，如 <code>api/products/5</code> 中的 <code>5</code>。</li>
<li><strong>查询字符串</strong>（Query String）：URL 中 <code>?key=value</code> 部分的数据。</li>
<li><strong>表单数据</strong>（Form Data）：POST 请求中通过表单提交的数据。</li>
<li><strong>请求正文</strong>（Body）：例如 JSON 或 XML 格式的数据（常用于 Web API）。</li>
<li><strong>请求头</strong>（Header）：HTTP 头中的数据。</li>
</ul>
<p>如果相同的键在多个来源中都有值，模型绑定系统将依据“绑定源优先级”来决定最终使用哪一个值。</p>
</li>
<li><p><strong>显式指定绑定源与默认优先级</strong></p>
<p>为了避免歧义，ASP.NET Core 提供了用于明确声明数据来源的特性，如：</p>
<ul>
<li><code>[FromRoute]</code>：指示数据应从路由数据中绑定。</li>
<li><code>[FromQuery]</code>：指示数据应从查询字符串中绑定。</li>
<li><code>[FromForm]</code>：指示数据应从表单数据中绑定。</li>
<li><code>[FromBody]</code>：指示数据应从请求正文中绑定。</li>
</ul>
<p>如果没有明确指定，框架会根据参数的数据类型等特性采用默认规则，这就涉及到默认的绑定源优先级。例如：</p>
<ul>
<li><strong>简单类型</strong>（如 int、string 等）通常会从路由数据、查询字符串或表单中查找匹配的值。</li>
<li><strong>复杂类型</strong>默认往往预期来自请求正文（特别是在 Web API 场景下），但也可能从其它来源（例如表单）中获取数据，具体取决于请求方法和配置。</li>
</ul>
<p>这种优先级的设置确保了当同一参数在多个数据源中都有数据时，系统能有一个明确的决策规则，从而避免不确定的行为。例如：如果在 URL 中既有路由参数 <code>id</code>，又在查询字符串中传递了 <code>id</code>，而未显式标明绑定属性，那么通常路由数据将具有更高优先级，最终 <code>id</code> 的值就会采用路由数据中的那个。</p>
</li>
</ol>
</li>
<li><p>显式绑定与绑定源优先级的对比</p>
</li>
</ol>
<p>默认过程（依靠绑定源优先级）：</p>
<ul>
<li>参数未标明具体绑定方式时，框架会按照内部的优先级顺序（路由 &gt; 查询 &gt; 表单 &gt; 请求正文等）查找数据。</li>
<li>当多个数据源存在同名的键时，就会依据优先级选择先出现的数据源。</li>
</ul>
<p>显式绑定（通过 <code>[FromXxx]</code> 或 <code>BindAsync</code>）：</p>
<ul>
<li><p>使用 <code>[FromXxx]</code> 特性，参数的绑定源已经固定，框架将仅从该数据源中查找数据。</p>
</li>
<li><p>使用 <code>BindAsync</code> 定义绑定逻辑时，整个绑定过程由该方法全部掌控，开发者可以自行决定：</p>
<ul>
<li>从哪些数据源读取数据</li>
<li>如何处理多个数据源间的取舍</li>
<li>如何验证和转换数据</li>
</ul>
</li>
</ul>
<p>因此，当你在模型中使用 <code>BindAsync</code> 进行显式绑定时，这个显式逻辑的优先级会高于内置的多数据源优先查找顺序，相当于告诉框架，“我知道数据该从哪里来，按我的规则处理”。</p>
<ol start="5">
<li>一个简化的示意图</li>
</ol>
<table>
<thead>
<tr>
<th align="center"><strong>流程类型</strong></th>
<th align="center"><strong>执行逻辑</strong></th>
<th align="center"><strong>详细说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>参数显式标识</strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">使用 <code>[FromXxx]</code> 特性</td>
<td align="center">指定单一数据源（如 <code>[FromQuery]</code>、<code>[FromRoute]</code>）</td>
<td align="center">强制模型绑定仅从指定源获取数据，忽略其他源（例如 <code>[FromHeader]</code> 从请求头中取值）</td>
</tr>
<tr>
<td align="center">实现 <code>BindAsync</code> 方法</td>
<td align="center">自定义绑定逻辑，覆盖默认行为</td>
<td align="center">在类型中定义 <code>BindAsync(HttpContext, ParameterInfo)</code> 方法，处理复杂或特殊场景（如自定义格式解析）</td>
</tr>
<tr>
<td align="center"><strong>参数无显式绑定</strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">1. 检查 Route 数据</td>
<td align="center">从 URL 路径中提取路由参数（如 <code>/user/&#123;id&#125;</code>）</td>
<td align="center">优先匹配路由模板中的参数名称，适用于简单类型和部分复杂类型</td>
</tr>
<tr>
<td align="center">2. 检查 Query 数据</td>
<td align="center">从 URL 的查询字符串中获取参数（如 <code>?name=John</code>）</td>
<td align="center">通过键值对形式传递，支持简单类型和集合类型（需同名参数）</td>
</tr>
<tr>
<td align="center">3. 检查 Form 数据</td>
<td align="center">从 HTTP 请求的正文中获取表单数据（如 <code>application/x-www-form-urlencoded</code>）</td>
<td align="center">适用于 POST 请求的表单提交，支持复杂类型绑定（需属性名称匹配）</td>
</tr>
<tr>
<td align="center">4. 检查 Body 数据</td>
<td align="center">从请求正文中解析 JSON&#x2F;XML 等结构化数据（如 <code>application/json</code>）</td>
<td align="center">默认使用 JSON 输入格式化器，需用 <code>[FromBody]</code> 显式指定；复杂类型优先从此处绑定</td>
</tr>
</tbody></table>
<p>总结</p>
<ul>
<li><strong>Binding source priorities</strong> 定义了 ASP.NET Core 如何从多个数据源中拉取数据的默认顺序；</li>
<li>默认的模型绑定会依赖这种顺序，但开发者可以<strong>显式</strong>指定数据源，比如使用 <code>[FromXxx]</code> 特性；</li>
<li>如果模型类型定义了静态的 <code>BindAsync</code> 方法，则 ASP.NET Core 会调用该方法来执行自定义绑定，从而<strong>覆盖默认优先级</strong>，实现更高控制精度的显式绑定。</li>
</ul>
<p>这种设计使得 ASP.NET Core 的模型绑定既灵活又强大，既能满足简单场景下轻松映射传统数据，又能支持复杂需求下的定制数据处理逻辑。</p>
<blockquote>
<p>依照7中的代码，在路由中添加的数据无法起到作用，因为指定了从Header中获取name，从而使得在获取name时显示查询Header的优先级最高。</p>
<p><img src="/2025/04/11/NET-ASP-05/image-20250414104730080.png" alt="image-20250414104730080"></p>
</blockquote>
<h1 id="9、使用数据注解进行模型数据验证"><a href="#9、使用数据注解进行模型数据验证" class="headerlink" title="9、使用数据注解进行模型数据验证"></a>9、使用数据注解进行模型数据验证</h1><p>需要安装“MinimalApis.Extensions”</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.ComponentModel.DataAnnotations;  <span class="comment">// 数据验证特性</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用构建器</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="comment">// 构建应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义POST端点，添加员工</span></span><br><span class="line">app.MapPost(<span class="string">&quot;/employees&quot;</span>, (Employee employee) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 调用仓库方法添加员工</span></span><br><span class="line">    EmployeesRepository.AddEmployee(employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Employee is added successfully.&quot;</span>;  <span class="comment">// 返回成功消息</span></span><br><span class="line">&#125;).WithParameterValidation();  <span class="comment">// 启用参数验证</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动应用</span></span><br><span class="line">app.Run();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 员工数据仓库</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeesRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化员工列表</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;John Doe&quot;</span>, <span class="string">&quot;Engineer&quot;</span>, <span class="number">60000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">2</span>, <span class="string">&quot;Jane Smith&quot;</span>, <span class="string">&quot;Manager&quot;</span>, <span class="number">75000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">3</span>, <span class="string">&quot;Sam Brown&quot;</span>, <span class="string">&quot;Technician&quot;</span>, <span class="number">50000</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取所有员工</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Employee&gt; <span class="title">GetEmployees</span>()</span> =&gt; employees;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据ID获取员工</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Employee? GetEmployeeById(<span class="built_in">int</span> id)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> employees.FirstOrDefault(x =&gt; x.Id == id);  <span class="comment">// 使用LINQ查询</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加员工</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)  <span class="comment">// 非空检查</span></span><br><span class="line">        &#123;</span><br><span class="line">            employees.Add(employee);  <span class="comment">// 添加到列表</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新员工信息</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">UpdateEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> emp = employees.FirstOrDefault(x =&gt; x.Id == employee.Id);  <span class="comment">// 查找员工</span></span><br><span class="line">            <span class="keyword">if</span> (emp <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 更新属性</span></span><br><span class="line">                emp.Name = employee.Name;</span><br><span class="line">                emp.Position = employee.Position;</span><br><span class="line">                emp.Salary = employee.Salary;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">// 更新成功</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// 更新失败</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除员工</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">DeleteEmployee</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> employee = employees.FirstOrDefault(x =&gt; x.Id == id);  <span class="comment">// 查找员工</span></span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Remove(employee);  <span class="comment">// 从列表移除</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">// 删除成功</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// 删除失败</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 员工实体类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// 员工ID</span></span><br><span class="line"></span><br><span class="line">    [<span class="meta">Required</span>]  <span class="comment">// 必填验证</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// 员工姓名</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// 职位</span></span><br><span class="line"></span><br><span class="line">    [<span class="meta">Required</span>]  <span class="comment">// 必填验证</span></span><br><span class="line">    [<span class="meta">Range(50000, 200000)</span>]  <span class="comment">// 薪资范围验证</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// 薪资</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span> position, <span class="built_in">double</span> salary</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        Name = name;</span><br><span class="line">        Position = position;</span><br><span class="line">        Salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250414145106182.png" alt="image-20250414145106182"></p>
<h1 id="10、自定义模型数据验证"><a href="#10、自定义模型数据验证" class="headerlink" title="10、自定义模型数据验证"></a>10、自定义模型数据验证</h1><p>Employee_EnsureSalary.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.ComponentModel.DataAnnotations;  <span class="comment">// 引入数据验证命名空间</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 自定义薪资验证特性，继承自ValidationAttribute</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee_EnsureSalary</span> : <span class="title">ValidationAttribute</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 重写验证方法</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">override</span> ValidationResult? IsValid(<span class="built_in">object</span>? <span class="keyword">value</span>, ValidationContext validationContext)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 将验证对象转换为Employee类型</span></span><br><span class="line">            <span class="keyword">var</span> employee = validationContext.ObjectInstance <span class="keyword">as</span> Employee;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 检查员工是否为经理且薪资是否符合要求</span></span><br><span class="line">            <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span> &amp;&amp;</span><br><span class="line">                !<span class="built_in">string</span>.IsNullOrWhiteSpace(employee.Position) &amp;&amp;</span><br><span class="line">                employee.Position.Equals(<span class="string">&quot;Manager&quot;</span>, StringComparison.OrdinalIgnoreCase))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 如果经理薪资低于100000，返回错误信息</span></span><br><span class="line">                <span class="keyword">if</span> (employee.Salary &lt; <span class="number">100000</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> ValidationResult(<span class="string">&quot;经理的薪资必须至少为100000&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 验证通过</span></span><br><span class="line">            <span class="keyword">return</span> ValidationResult.Success;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Program.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.ComponentModel.DataAnnotations;  <span class="comment">// 引入数据验证特性</span></span><br><span class="line"><span class="keyword">using</span> WebApp;  <span class="comment">// 引入自定义验证特性</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用构建器实例</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义POST端点用于添加员工</span></span><br><span class="line">app.MapPost(<span class="string">&quot;/employees&quot;</span>, (Employee employee) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 调用数据仓库方法添加员工</span></span><br><span class="line">    EmployeesRepository.AddEmployee(employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;员工添加成功&quot;</span>;  <span class="comment">// 返回成功消息</span></span><br><span class="line">&#125;).WithParameterValidation();  <span class="comment">// 启用参数自动验证</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动Web应用</span></span><br><span class="line">app.Run();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 员工数据仓库类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeesRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 初始化员工数据列表</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;工程师&quot;</span>, <span class="number">60000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">2</span>, <span class="string">&quot;李四&quot;</span>, <span class="string">&quot;经理&quot;</span>, <span class="number">75000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">3</span>, <span class="string">&quot;王五&quot;</span>, <span class="string">&quot;技术员&quot;</span>, <span class="number">50000</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取所有员工数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Employee&gt; <span class="title">GetEmployees</span>()</span> =&gt; employees;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据ID查询单个员工</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Employee? GetEmployeeById(<span class="built_in">int</span> id)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> employees.FirstOrDefault(x =&gt; x.Id == id);  <span class="comment">// 使用LINQ查询</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加新员工</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)  <span class="comment">// 非空检查</span></span><br><span class="line">        &#123;</span><br><span class="line">            employees.Add(employee);  <span class="comment">// 添加到员工列表</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新员工信息</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">UpdateEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> emp = employees.FirstOrDefault(x =&gt; x.Id == employee.Id);  <span class="comment">// 查找要更新的员工</span></span><br><span class="line">            <span class="keyword">if</span> (emp <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 更新员工属性</span></span><br><span class="line">                emp.Name = employee.Name;</span><br><span class="line">                emp.Position = employee.Position;</span><br><span class="line">                emp.Salary = employee.Salary;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">// 返回更新成功</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// 返回更新失败</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除员工</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">DeleteEmployee</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> employee = employees.FirstOrDefault(x =&gt; x.Id == id);  <span class="comment">// 查找要删除的员工</span></span><br><span class="line">        <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            employees.Remove(employee);  <span class="comment">// 从列表中移除</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">// 返回删除成功</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">// 返回删除失败</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 员工实体类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// 员工ID属性</span></span><br><span class="line"></span><br><span class="line">    [<span class="meta">Required(ErrorMessage = <span class="string">&quot;员工姓名不能为空&quot;</span>)</span>]  <span class="comment">// 必填验证</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// 员工姓名属性</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// 职位属性</span></span><br><span class="line"></span><br><span class="line">    [<span class="meta">Required(ErrorMessage = <span class="string">&quot;薪资不能为空&quot;</span>)</span>]  <span class="comment">// 必填验证</span></span><br><span class="line">    [<span class="meta">Range(50000, 200000, ErrorMessage = <span class="string">&quot;薪资必须在50000到200000之间&quot;</span>)</span>]  <span class="comment">// 范围验证</span></span><br><span class="line">    [<span class="meta">Employee_EnsureSalary(ErrorMessage = <span class="string">&quot;经理薪资不能低于100000&quot;</span>)</span>]  <span class="comment">// 自定义验证</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// 薪资属性</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span> position, <span class="built_in">double</span> salary</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Id = id;</span><br><span class="line">        Name = name;</span><br><span class="line">        Position = position;</span><br><span class="line">        Salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/11/NET-ASP-05/image-20250414151202170.png" alt="image-20250414151202170"></p>
<h1 id="11、注册信息验证"><a href="#11、注册信息验证" class="headerlink" title="11、注册信息验证"></a>11、注册信息验证</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;  <span class="comment">// 引入ASP.NET Core MVC功能</span></span><br><span class="line"><span class="keyword">using</span> System.ComponentModel.DataAnnotations;  <span class="comment">// 引入数据验证命名空间</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);  <span class="comment">// 创建Web应用构建器</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();  <span class="comment">// 构建Web应用程序</span></span><br><span class="line"></span><br><span class="line">app.UseRouting();  <span class="comment">// 启用路由中间件</span></span><br><span class="line"></span><br><span class="line">app.UseEndpoints(endpoints =&gt; &#123;  <span class="comment">// 配置终结点路由</span></span><br><span class="line">    endpoints.MapGet(<span class="string">&quot;/register&quot;</span>, (Registration reg) =&gt;  <span class="comment">// 映射GET请求到/register路径</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;获取成功：用户邮箱<span class="subst">&#123;reg.Email&#125;</span>，用户密码<span class="subst">&#123;reg.Password&#125;</span>，用户确认密码<span class="subst">&#123;reg.ConfirmPassword&#125;</span>&quot;</span>;  <span class="comment">// 返回注册信息</span></span><br><span class="line">    &#125;).WithParameterValidation();</span><br><span class="line"></span><br><span class="line">    endpoints.MapPost(<span class="string">&quot;/register&quot;</span>, ([FromBody] Registration reg) =&gt;  <span class="comment">// 映射POST请求到/register路径，从请求体获取数据</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;注册成功：用户邮箱<span class="subst">&#123;reg.Email&#125;</span>，用户密码<span class="subst">&#123;reg.Password&#125;</span>，用户确认密码<span class="subst">&#123;reg.ConfirmPassword&#125;</span>&quot;</span>;  <span class="comment">// 返回注册信息</span></span><br><span class="line">    &#125;).WithParameterValidation();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.Run();  <span class="comment">// 启动Web应用</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Registration</span>  <span class="comment">// 用户注册模型类</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">Required</span>]  <span class="comment">// 必填字段</span></span><br><span class="line">    [<span class="meta">EmailAddress(ErrorMessage = <span class="string">&quot;不合理的格式&quot;</span>)</span>]  <span class="comment">// 必须为邮箱格式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? Email &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Required</span>]  <span class="comment">// 必填字段</span></span><br><span class="line">    [<span class="meta">StringLength(100, MinimumLength = 6, ErrorMessage = <span class="string">&quot;密码长度至少6位数&quot;</span>)</span>]  <span class="comment">// 密码长度6-100字符</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? Password &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Required(ErrorMessage = <span class="string">&quot;请输入确认密码&quot;</span>)</span>]  <span class="comment">// 必填字段</span></span><br><span class="line">    [<span class="meta">Compare(nameof(Password), ErrorMessage = <span class="string">&quot;两次密码不一致&quot;</span>)</span>]  <span class="comment">// 必须与Password字段值相同</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? ConfirmPassword &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ValueTask&lt;Registration?&gt; BindAsync(HttpContext context)  <span class="comment">// 从请求绑定注册数据</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> email = context.Request.Query[<span class="string">&quot;email&quot;</span>];  <span class="comment">// 从查询字符串获取email参数</span></span><br><span class="line">        <span class="keyword">var</span> password = context.Request.Query[<span class="string">&quot;password&quot;</span>];  <span class="comment">// 从查询字符串获取password参数</span></span><br><span class="line">        <span class="keyword">var</span> confirmPassword = context.Request.Query[<span class="string">&quot;confirmPassword&quot;</span>];  <span class="comment">// 从查询字符串获取confirmPassword参数</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ValueTask&lt;Registration?&gt;(<span class="keyword">new</span> Registration &#123; Email = email, Password = password, ConfirmPassword = confirmPassword &#125;);  <span class="comment">// 返回注册对象</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>错误演示：</p>
<p><img src="/2025/04/11/NET-ASP-05/image-20250414154516295.png" alt="image-20250414154516295"></p>
<p><img src="/2025/04/11/NET-ASP-05/image-20250414155032773.png" alt="image-20250414155032773"></p>
<p>正确演示：</p>
<p><img src="/2025/04/11/NET-ASP-05/image-20250414154612788.png" alt="image-20250414154612788"></p>
<p><img src="/2025/04/11/NET-ASP-05/image-20250414155101556.png" alt="image-20250414155101556"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://alsl521.github.io">kyl</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://alsl521.github.io/2025/04/11/NET-ASP-05/">https://alsl521.github.io/2025/04/11/NET-ASP-05/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://alsl521.github.io" target="_blank">kyl的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C#</a></div><div class="post-share"><div class="social-share" data-image="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/10/NET-ASP-04/" title="ASP.NET学习记录-03-路由"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">ASP.NET学习记录-03-路由</div></div><div class="info-2"><div class="info-item-1">1、Routing和Endpoints简介在ASP.NET Core中，**路由（Routing）和终结点（Endpoints）**是处理HTTP请求的核心机制，它们共同构成了请求分发的管道系统。以下是对两者的详细介绍：  一、路由（Routing）路由的核心作用是将传入的HTTP请求根据URL路径和HTTP方法匹配到对应的处理逻辑（终结点）。在ASP.NET Core中，路由系统被称为终结点路由（Endpoint Routing）。 主要功能与工作流程 匹配请求：通过UseRouting中间件（即EndpointRoutingMiddleware）扫描应用中所有注册的终结点，根据请求的URL和HTTP方法选择最匹配的终结点 。示例代码：  12345app.UseRouting();app.UseEndpoints(endpoints =&gt; &#123;    endpoints.MapGet(&quot;/&quot;, async context =&gt; &#123; ......</div></div></div></a><a class="pagination-related" href="/2025/04/14/NET-ASP-06/" title="ASP.NET学习记录-06-最小API结果生产"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">ASP.NET学习记录-06-最小API结果生产</div></div><div class="info-2"><div class="info-item-1">本次学习基础代码如下： Employee.cs 12345678910111213141516171819202122232425262728293031323334353637383940414243444546using System.ComponentModel.DataAnnotations;namespace WebApi.Models&#123;    /// &lt;summary&gt;    /// 员工实体类    /// &lt;/summary&gt;    public class Employee    &#123;        /// &lt;summary&gt;        /// 员工唯一标识符        /// &lt;/summary&gt;        public int Id &#123; get; set; &#125;        /// &lt;summary&gt;        /// 员工姓名        /// &lt;/summary&gt;        public string Name...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/04/08/NET-ASP-03/" title="ASP.NET学习记录-03-中间件管道"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-03-中间件管道</div></div><div class="info-2"><div class="info-item-1">1、中间件管道简介在 C# ASP.NET Core 中，中间件管道是处理 HTTP 请求和响应的核心机制，通过将多个中间件按顺序串联成一个处理流程，实现灵活的请求处理和业务逻辑组合。以下是其核心要点：  1. 中间件管道的基本概念 中间件（Middleware）：是管道中的独立组件，负责处理 HTTP 请求和响应。每个中间件可以：  对请求进行预处理（如日志、身份验证）。  调用下一个中间件（通过 next()），或直接终止处理（短路）。  对响应进行后处理（如修改响应头、记录耗时）。      管道（Pipeline）：由多个中间件按注册顺序串联而成，形成一个“请求→处理→响应”的流程。请求按顺序经过所有中间件，而响应则逆序返回  。    2. 管道的工作模式：1-n 然后 n-1 请求阶段（正向传递）：请求从第一个中间件开始，依次传递至最后一个中间件（终结点），形成“1→2→3”的顺序 。  响应阶段（逆向返回）：处理完成后，响应从终结点开始，逆序返回至第一个中间件，形成“3→2→1”的顺序  。 示例 123Middleware One: Request Start...</div></div></div></a><a class="pagination-related" href="/2025/04/08/NET-ASP-01/" title="ASP.NET学习记录-01-基础知识"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-01-基础知识</div></div><div class="info-2"><div class="info-item-1">视频教程为：ASP.NET Core Deep-Dive in .NET 9 | Udemy 1、.NET Core.NET Core 是微软开发的开源、跨平台应用程序开发框架，旨在为现代云原生、微服务及高性能场景提供支持。以下是其核心特性与定位的详细说明：  一、核心定义与定位 跨平台支持 .NET Core 可在 Windows、Linux、macOS 等操作系统上运行，并支持 x86、x64、ARM 等多种架构。 这种跨平台能力使其成为开发云原生、容器化应用（如 Docker）的理想选择。  开源与社区驱动 作为 MIT 协议下的开源项目，.NET Core 的代码托管于 GitHub，接受社区贡献，确保了技术透明度和快速迭代。    二、架构与技术特性 模块化设计 采用包化（Packages）管理，开发者可按需引用组件，减少应用体积，与传统的 .NET Framework 打包式安装形成对比。例如，通过 1dotnet restore  命令可动态还原依赖的 NuGet 包。  高性能运行时  RyuJIT 编译器：相比传统 JIT，性能提升约 25%，支持 SIMD...</div></div></div></a><a class="pagination-related" href="/2025/04/08/NET-ASP-02/" title="ASP.NET学习记录-02-最小API模式"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-02-最小API模式</div></div><div class="info-2"><div class="info-item-1">1、创建第一个ASP.NET应用（Minimal API）1.创建新项目 选择新的空项目  设定基本信息  使用最新版.NET作为学习内容  2.项目架构简介与解析 1. 解决方案（Solution） 名称：MyFirstWebApplication 作用： 作为容器管理多个相关项目（当前仅包含一个项目 WebApplication）。 支持团队协作和复杂应用的模块化开发（如Web API、类库、单元测试等）。   关键点： 可通过解决方案配置统一管理所有项目的依赖和环境设置。   新增项目 右键单击解决方案-&gt;添加-&gt;新建项目      2. 项目（Project: WebApplication） 核心结构：包含构建和运行Web应用所需的所有文件与配置，分为以下关键部分：  a. Connected Services 文件夹 作用： 存储与外部服务的连接配置（如数据库、Azure服务、第三方API）。 通过右键添加服务（如Entity Framework、Azure认证），自动生成连接配置文件。   示例：添加Azure...</div></div></div></a><a class="pagination-related" href="/2025/04/10/NET-ASP-04/" title="ASP.NET学习记录-03-路由"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-10</div><div class="info-item-2">ASP.NET学习记录-03-路由</div></div><div class="info-2"><div class="info-item-1">1、Routing和Endpoints简介在ASP.NET Core中，**路由（Routing）和终结点（Endpoints）**是处理HTTP请求的核心机制，它们共同构成了请求分发的管道系统。以下是对两者的详细介绍：  一、路由（Routing）路由的核心作用是将传入的HTTP请求根据URL路径和HTTP方法匹配到对应的处理逻辑（终结点）。在ASP.NET Core中，路由系统被称为终结点路由（Endpoint Routing）。 主要功能与工作流程 匹配请求：通过UseRouting中间件（即EndpointRoutingMiddleware）扫描应用中所有注册的终结点，根据请求的URL和HTTP方法选择最匹配的终结点 。示例代码：  12345app.UseRouting();app.UseEndpoints(endpoints =&gt; &#123;    endpoints.MapGet(&quot;/&quot;, async context =&gt; &#123; ......</div></div></div></a><a class="pagination-related" href="/2025/04/15/NET-ASP-09/" title="ASP.NET学习记录-09-MVC"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-15</div><div class="info-item-2">ASP.NET学习记录-09-MVC</div></div><div class="info-2"><div class="info-item-1">1、MVC PatternASP.NET中的MVC（Model-View-Controller）模式是一种软件架构设计模式，它将应用程序分为三个核心组件：模型（Model）、视图（View）和控制器（Controller），以实现关注点分离，提升代码可维护性和可扩展性。  以下是其具体内涵及在ASP.NET中的应用特点： 1....</div></div></div></a><a class="pagination-related" href="/2025/04/18/NET-ASP-11/" title="ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-18</div><div class="info-item-2">ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API</div></div><div class="info-2"><div class="info-item-1">1、初始化项目本实践将创建以下 API：     API 说明 请求正文 响应正文    GET /api/todoitems 获取所有待办事项 无 待办事项的数组   GET /api/todoitems/&#123;id&#125; 按 ID 获取项 无 待办事项   POST /api/todoitems 添加新项 待办事项 待办事项   PUT /api/todoitems/&#123;id&#125; 更新现有项 待办事项 无   DELETE /api/todoitems/&#123;id&#125; 删除项 无 无   1.初始化项目首先要确保安装必备的相关内容，即ASP.NET和Web开发。  在此基础上，创建项目：  首先选择合理的项目模板   随后选择并输入名称，具体内容随意   依据需求选择，本次不使用HTTPS，随后创建项目。    2.项目内容介绍：  该项目是一个典型的 ASP.NET Core Web 应用项目，采用标准的 MVC（模型-视图-控制器）分层架构。  1. 项目整体架构 分层逻辑： 控制器（Controllers）：处理 HTTP...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">kyl</div><div class="author-info-description">用于记录平时学习的博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">61</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/alsl521" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:852970167@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E3%80%81%E6%A8%A1%E5%9E%8B%E7%BB%91%E5%AE%9A%E5%AE%9A%E4%B9%89"><span class="toc-number">1.</span> <span class="toc-text">1、模型绑定定义</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%E3%80%81%E8%AF%B7%E6%B1%82%E5%A4%B4%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A"><span class="toc-number">2.</span> <span class="toc-text">3、请求头参数绑定</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4%E3%80%81%E4%BD%BF%E7%94%A8-AsParameters-%E7%89%B9%E6%80%A7%E5%AE%9E%E7%8E%B0%E5%8F%82%E6%95%B0%E5%88%86%E7%BB%84"><span class="toc-number">3.</span> <span class="toc-text">4、使用[AsParameters]特性实现参数分组</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5%E3%80%81%E5%AE%9E%E7%8E%B0%E6%95%B0%E7%BB%84%E5%8F%82%E6%95%B0%E4%B8%8E%E6%9F%A5%E8%AF%A2%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%96%E8%AF%B7%E6%B1%82%E5%A4%B4%E7%9A%84%E7%BB%91%E5%AE%9A"><span class="toc-number">4.</span> <span class="toc-text">5、实现数组参数与查询字符串或请求头的绑定</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6%E3%80%81%E5%AE%9E%E7%8E%B0%E5%8F%82%E6%95%B0%E4%B8%8E%E8%AF%B7%E6%B1%82%E4%BD%93%E7%BB%91%E5%AE%9A"><span class="toc-number">5.</span> <span class="toc-text">6、实现参数与请求体绑定</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E3%80%81%E5%AE%9E%E7%8E%B0%E5%8F%82%E6%95%B0%E4%B8%8E%E5%BC%82%E6%AD%A5%E6%96%B9%E6%B3%95%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%91%E5%AE%9A"><span class="toc-number">6.</span> <span class="toc-text">7、实现参数与异步方法自定义绑定</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8%E3%80%81%E7%BB%91%E5%AE%9A%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">7.</span> <span class="toc-text">8、绑定优先级</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9%E3%80%81%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E6%B3%A8%E8%A7%A3%E8%BF%9B%E8%A1%8C%E6%A8%A1%E5%9E%8B%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81"><span class="toc-number">8.</span> <span class="toc-text">9、使用数据注解进行模型数据验证</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9E%8B%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81"><span class="toc-number">9.</span> <span class="toc-text">10、自定义模型数据验证</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11%E3%80%81%E6%B3%A8%E5%86%8C%E4%BF%A1%E6%81%AF%E9%AA%8C%E8%AF%81"><span class="toc-number">10.</span> <span class="toc-text">11、注册信息验证</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/21/NET-ASP-13/" title="ASP.NET学习记录-13-实践2-数据库进阶">ASP.NET学习记录-13-实践2-数据库进阶</a><time datetime="2025-04-21T08:39:19.000Z" title="发表于 2025-04-21 16:39:19">2025-04-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/18/NET-ASP-12/" title="ASP.NET学习记录-12-实践2-使用MySQL数据库">ASP.NET学习记录-12-实践2-使用MySQL数据库</a><time datetime="2025-04-18T08:11:21.000Z" title="发表于 2025-04-18 16:11:21">2025-04-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/18/NET-ASP-11/" title="ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API">ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API</a><time datetime="2025-04-18T02:13:44.000Z" title="发表于 2025-04-18 10:13:44">2025-04-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/16/NET-ASP-10/" title="ASP.NET学习记录-10-过滤">ASP.NET学习记录-10-过滤</a><time datetime="2025-04-16T12:02:16.000Z" title="发表于 2025-04-16 20:02:16">2025-04-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/15/Software/" title="记录必备软件">记录必备软件</a><time datetime="2025-04-15T11:29:21.000Z" title="发表于 2025-04-15 19:29:21">2025-04-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By kyl</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>