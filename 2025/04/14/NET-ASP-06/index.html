<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ASP.NET学习记录-06-最小API结果生产 | kyl的博客</title><meta name="author" content="kyl"><meta name="copyright" content="kyl"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:type" content="article">
<meta property="og:title" content="ASP.NET学习记录-06-最小API结果生产">
<meta property="og:url" content="https://alsl521.github.io/2025/04/14/NET-ASP-06/index.html">
<meta property="og:site_name" content="kyl的博客">
<meta property="og:description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4">
<meta property="article:published_time" content="2025-04-14T07:52:27.000Z">
<meta property="article:modified_time" content="2025-04-14T09:03:27.756Z">
<meta property="article:author" content="kyl">
<meta property="article:tag" content="C#">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ASP.NET学习记录-06-最小API结果生产",
  "url": "https://alsl521.github.io/2025/04/14/NET-ASP-06/",
  "image": "https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4",
  "datePublished": "2025-04-14T07:52:27.000Z",
  "dateModified": "2025-04-14T09:03:27.756Z",
  "author": [
    {
      "@type": "Person",
      "name": "kyl",
      "url": "https://alsl521.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://alsl521.github.io/2025/04/14/NET-ASP-06/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ASP.NET学习记录-06-最小API结果生产',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">kyl的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">ASP.NET学习记录-06-最小API结果生产</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">ASP.NET学习记录-06-最小API结果生产</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-14T07:52:27.000Z" title="发表于 2025-04-14 15:52:27">2025-04-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-14T09:03:27.756Z" title="更新于 2025-04-14 17:03:27">2025-04-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/">C#</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/ASP/">ASP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>本次学习基础代码如下：</p>
<p>Employee.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.ComponentModel.DataAnnotations;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApi.Models</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 员工实体类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 员工唯一标识符</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 员工姓名</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 员工职位（必填字段）</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        [<span class="meta">Required</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Position &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 员工薪资</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">double</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 员工构造函数</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>员工ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span>员工姓名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;position&quot;&gt;</span>员工职位<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;salary&quot;&gt;</span>员工薪资<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span> position, <span class="built_in">double</span> salary</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Id = id;</span><br><span class="line">            Name = name;</span><br><span class="line">            Position = position;</span><br><span class="line">            Salary = salary;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>EmployeesRepository.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">WebApi.Models</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 员工数据存储库（静态类，模拟数据访问层）</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EmployeesRepository</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 使用静态列表模拟内存数据库存储</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 初始化测试数据</span></span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;John Doe&quot;</span>, <span class="string">&quot;Engineer&quot;</span>, <span class="number">60000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">2</span>, <span class="string">&quot;Jane Smith&quot;</span>, <span class="string">&quot;Manager&quot;</span>, <span class="number">75000</span>),</span><br><span class="line">        <span class="keyword">new</span> Employee(<span class="number">3</span>, <span class="string">&quot;Sam Brown&quot;</span>, <span class="string">&quot;Technician&quot;</span>, <span class="number">50000</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取所有员工列表</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>员工集合<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Employee&gt; <span class="title">GetEmployees</span>()</span> =&gt; employees;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 根据ID查询单个员工</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>员工ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>匹配的员工对象，未找到返回null<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Employee? GetEmployeeById(<span class="built_in">int</span> id)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> employees.FirstOrDefault(x =&gt; x.Id == id);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 添加新员工</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;employee&quot;&gt;</span>要添加的员工对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                employees.Add(employee);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新员工信息</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;employee&quot;&gt;</span>更新后的员工对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>更新成功返回true，失败返回false<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">UpdateEmployee</span>(<span class="params">Employee? employee</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> emp = employees.FirstOrDefault(x =&gt; x.Id == employee.Id);</span><br><span class="line">                <span class="keyword">if</span> (emp <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 更新员工属性</span></span><br><span class="line">                    emp.Name = employee.Name;</span><br><span class="line">                    emp.Position = employee.Position;</span><br><span class="line">                    emp.Salary = employee.Salary;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 根据ID删除员工</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>要删除的员工ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>删除成功返回true，失败返回false<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">DeleteEmployee</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> employee = employees.FirstOrDefault(x =&gt; x.Id == id);</span><br><span class="line">            <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                employees.Remove(employee);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Program.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApi.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用构建器</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根路径响应测试端点</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/&quot;</span>, () =&gt; <span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 员工数据查询端点</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/employees&quot;</span>, () =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 从仓储层获取所有员工数据</span></span><br><span class="line">    <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">    <span class="comment">// 返回员工列表</span></span><br><span class="line">    <span class="keyword">return</span> employees;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 员工数据新增端点</span></span><br><span class="line">app.MapPost(<span class="string">&quot;/employees&quot;</span>, (Employee employee) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 参数有效性检查</span></span><br><span class="line">    <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="literal">null</span> || employee.Id &lt;= <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Employee is not provided or is not valid.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用仓储层添加员工</span></span><br><span class="line">    EmployeesRepository.AddEmployee(employee);</span><br><span class="line">    <span class="comment">// 返回成功响应</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Employee added successfully.&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;).WithParameterValidation();  <span class="comment">// 启用参数自动验证（需配合验证库使用）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动Web应用程序</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<h1 id="1、IResult"><a href="#1、IResult" class="headerlink" title="1、IResult"></a>1、IResult</h1><p>在 ASP.NET Core 中，<strong><code>IResult</code></strong> 是一个接口，用于表示 Web 应用程序中的<strong>返回结果</strong>。它是 Minimal API 模型的重要部分，设计目的是提供一种简化的方式来定义 HTTP 响应。</p>
<p>核心功能</p>
<ul>
<li><strong>抽象化 HTTP 响应</strong>：<code>IResult</code> 封装了控制器或终结点（endpoint）返回的 HTTP 响应，使代码更加简洁和可维护。</li>
<li><strong>灵活性</strong>：允许开发者使用内置方法或创建自定义结果来生成 HTTP 响应。</li>
</ul>
<p>示例</p>
<p>以下是一个使用 <code>IResult</code> 的基本示例：</p>
<p><code>app.MapGet(&quot;/hello&quot;, () =&gt; Results.Ok(&quot;Hello, World!&quot;));</code></p>
<p>在这个例子中，<code>Results.Ok</code> 是一个实现了 <code>IResult</code> 的方法，用于返回一个 HTTP 200 状态码的响应。</p>
<p>常见的 <code>Results</code> 方法</p>
<p>ASP.NET Core 提供了多个内置的 <code>IResult</code> 实现，可用于构建不同类型的响应，例如：</p>
<ul>
<li><code>Results.Ok()</code>：返回 200 状态码。</li>
<li><code>Results.BadRequest()</code>：返回 400 状态码。</li>
<li><code>Results.NotFound()</code>：返回 404 状态码。</li>
<li><code>Results.Redirect()</code>：用于重定向。</li>
<li><code>Results.Json()</code>：返回 JSON 格式的响应。</li>
</ul>
<p>优势</p>
<ol>
<li><strong>代码更简洁</strong>：适合 Minimal API，使得定义终结点和响应逻辑变得直接明了。</li>
<li><strong>可测试性高</strong>：通过 <code>IResult</code> 抽象，可以更方便地测试终结点逻辑。</li>
<li><strong>高度灵活</strong>：支持自定义实现，满足复杂响应需求。</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApi.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用构建器</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"><span class="comment">// 构建Web应用实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根路径响应测试端点</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/&quot;</span>, () =&gt; <span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 员工数据查询端点</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/employees&quot;</span>, () =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 从仓储层获取所有员工数据</span></span><br><span class="line">    <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">    <span class="comment">// 返回200状态码和员工列表</span></span><br><span class="line">    <span class="keyword">return</span> TypedResults.Ok(employees);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 员工数据新增端点</span></span><br><span class="line">app.MapPost(<span class="string">&quot;/employees&quot;</span>, (Employee employee) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 参数有效性检查</span></span><br><span class="line">    <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="literal">null</span> || employee.Id &lt;= <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Results.BadRequest(<span class="string">&quot;Employee is not provided or is not valid.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用仓储层添加员工</span></span><br><span class="line">    EmployeesRepository.AddEmployee(employee);</span><br><span class="line">    <span class="comment">// 返回成功响应</span></span><br><span class="line">    <span class="keyword">return</span> Results.Ok(<span class="string">&quot;Employee added successfully.&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;).WithParameterValidation();  <span class="comment">// 启用参数自动验证（需配合验证库使用）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动Web应用程序</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<h1 id="2、混合匹配Results和TypedResults"><a href="#2、混合匹配Results和TypedResults" class="headerlink" title="2、混合匹配Results和TypedResults"></a>2、混合匹配Results和TypedResults</h1><p>当使用TypedResults时，方法中所有的返回类型必须一致，如果不一致则会出现错误。所以需混合使用Results和TypedResults</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.MapPost(<span class="string">&quot;/employees&quot;</span>, (Employee employee) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="literal">null</span> || employee.Id &lt;= <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Results.BadRequest(<span class="string">&quot;Employee is not provided or is not valid.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    EmployeesRepository.AddEmployee(employee);</span><br><span class="line">    <span class="keyword">return</span> Results.Ok(<span class="string">&quot;Employee added successfully.&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;).WithParameterValidation();</span><br></pre></td></tr></table></figure>

<h1 id="3、问题详情标准"><a href="#3、问题详情标准" class="headerlink" title="3、问题详情标准"></a>3、问题详情标准</h1><p>在 ASP.NET 中，“Problem Details standard”（问题详情标准）是一种用于表达 API 错误响应的规范化格式。它遵循 <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc7807">RFC 7807</a>，为 HTTP API 提供了一种一致的方式来描述错误的详细信息。这种标准化格式旨在帮助客户端更轻松地处理错误响应，并且能更清晰地了解错误的原因和上下文。</p>
<p>核心内容</p>
<p><strong>Problem Details</strong> 定义了一个 JSON 对象结构，用于传递错误信息。以下是该标准推荐的字段：</p>
<ul>
<li><strong><code>type</code></strong>: 表示错误的 URI 或分类，指向详细的文档。</li>
<li><strong><code>title</code></strong>: 简短的人类可读的错误描述。</li>
<li><strong><code>status</code></strong>: 与 HTTP 响应码一致的状态码，例如 404、500。</li>
<li><strong><code>detail</code></strong>: 详细的错误信息，可帮助客户端理解问题。</li>
<li><strong><code>instance</code></strong>: 指向具体问题实例的 URI，便于追踪。</li>
</ul>
<p>例如，一个典型的 Problem Details 响应可能是这样的：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>  </span><br><span class="line"> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://example.com/probs/out-of-credit&quot;</span><span class="punctuation">,</span>  </span><br><span class="line"> <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;You do not have enough credit.&quot;</span><span class="punctuation">,</span>  </span><br><span class="line"> <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">403</span><span class="punctuation">,</span>  </span><br><span class="line"> <span class="attr">&quot;detail&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Your account balance is too low to proceed.&quot;</span><span class="punctuation">,</span>  </span><br><span class="line"> <span class="attr">&quot;instance&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/account/12345/transactions/67890&quot;</span> </span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>在 ASP.NET 中的应用</p>
<p>ASP.NET Core 提供了对 Problem Details 标准的内置支持。使用 <code>ProblemDetails</code> 类可以方便地创建符合 RFC 7807 的错误响应。例如，在控制器中，可以这样使用：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> Problem(</span><br><span class="line">    detail: <span class="string">&quot;Your account balance is too low to proceed.&quot;</span>,</span><br><span class="line">    title: <span class="string">&quot;Not enough credit&quot;</span>,</span><br><span class="line">    statusCode: <span class="number">403</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>或者，如果你需要自定义 Problem Details，可以直接实例化 <code>ProblemDetails</code> 对象并返回：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> problemDetails = <span class="keyword">new</span> ProblemDetails</span><br><span class="line">&#123;</span><br><span class="line">    Type = <span class="string">&quot;https://example.com/probs/out-of-credit&quot;</span>,</span><br><span class="line">    Title = <span class="string">&quot;Insufficient Credit&quot;</span>,</span><br><span class="line">    Detail = <span class="string">&quot;Your balance is $0.&quot;</span>,</span><br><span class="line">    Status = StatusCodes.Status403Forbidden</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ObjectResult(problemDetails) &#123; StatusCode = problemDetails.Status &#125;;</span><br></pre></td></tr></table></figure>

<p>优势</p>
<ol>
<li><strong>统一的错误响应结构</strong>：使 API 客户端可以一致地处理不同类型的错误。</li>
<li><strong>可扩展性</strong>：可以添加自定义字段，以便提供更多错误相关的信息。</li>
<li><strong>易于调试</strong>：清晰描述问题所在，减少开发者调试时间。</li>
</ol>
<p>通过 Problem Details 标准，ASP.NET Core 的 API 错误处理变得更加规范化和可读。如果你希望进一步了解如何扩展 <code>ProblemDetails</code> 或结合中间件处理错误，我们可以继续探讨！希望这些信息对你有帮助。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">app.MapPost(<span class="string">&quot;/employees&quot;</span>, (Employee employee) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="literal">null</span> || employee.Id &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Results.ValidationProblem(<span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>[]&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            &#123;<span class="string">&quot;id&quot;</span>, <span class="keyword">new</span>[] &#123; <span class="string">&quot;Employee is not provided or is not valid.&quot;</span> &#125; &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    EmployeesRepository.AddEmployee(employee);</span><br><span class="line">    <span class="keyword">return</span> TypedResults.Created(<span class="string">$&quot;/employees/<span class="subst">&#123;employee.Id&#125;</span>&quot;</span>, employee);    </span><br><span class="line"></span><br><span class="line">&#125;).WithParameterValidation();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/14/NET-ASP-06/image-20250414163105587.png" alt="image-20250414163105587"></p>
<h1 id="4、标准化所有输出"><a href="#4、标准化所有输出" class="headerlink" title="4、标准化所有输出"></a>4、标准化所有输出</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApi.Models;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化Web应用构建器，自动加载appsettings.json配置文件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加问题详情服务，用于生成标准化的错误响应</span></span><br><span class="line">builder.Services.AddProblemDetails();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例，初始化中间件管道</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 非开发环境下配置异常处理中间件</span></span><br><span class="line"><span class="keyword">if</span> (!app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 使用统一的异常处理器处理未捕获异常</span></span><br><span class="line">    app.UseExceptionHandler();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加状态码页面处理中间件，自动处理4xx/5xx状态码</span></span><br><span class="line">app.UseStatusCodePages();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义根路径端点，用于服务健康检查</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/&quot;</span>, () =&gt; <span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义获取所有员工的GET端点</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/employees&quot;</span>, () =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 从仓储层获取所有员工数据</span></span><br><span class="line">    <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">    <span class="comment">// 返回200 OK响应，自动将结果序列化为JSON</span></span><br><span class="line">    <span class="keyword">return</span> TypedResults.Ok(employees);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义创建新员工的POST端点</span></span><br><span class="line">app.MapPost(<span class="string">&quot;/employees&quot;</span>, (Employee employee) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 参数验证：检查员工对象是否为空和ID是否有效</span></span><br><span class="line">    <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="literal">null</span> || employee.Id &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 返回符合RFC 7807标准的验证错误响应</span></span><br><span class="line">        <span class="keyword">return</span> Results.ValidationProblem(<span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>[]&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            &#123;<span class="string">&quot;id&quot;</span>, <span class="keyword">new</span>[] &#123; <span class="string">&quot;必须提供有效的员工信息&quot;</span> &#125; &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用仓储层添加新员工</span></span><br><span class="line">    EmployeesRepository.AddEmployee(employee);</span><br><span class="line">    <span class="comment">// 返回201 Created响应，包含新创建资源的URI</span></span><br><span class="line">    <span class="keyword">return</span> TypedResults.Created(<span class="string">$&quot;/employees/<span class="subst">&#123;employee.Id&#125;</span>&quot;</span>, employee);</span><br><span class="line"></span><br><span class="line">&#125;).WithParameterValidation();  <span class="comment">// 启用基于数据注解的自动参数验证</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动Web应用</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/14/NET-ASP-06/image-20250414163828659.png" alt="image-20250414163828659"></p>
<p><img src="/2025/04/14/NET-ASP-06/image-20250414163957776.png" alt="image-20250414163957776"></p>
<h1 id="5、自定义实现IResult"><a href="#5、自定义实现IResult" class="headerlink" title="5、自定义实现IResult"></a>5、自定义实现IResult</h1><p>HtmlResult.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApi.Results</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 自定义HTML响应结果类，实现IResult接口</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HtmlResult</span> : <span class="title">IResult</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> html;  <span class="comment">// 存储HTML内容</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 构造函数，初始化HTML内容</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;html&quot;&gt;</span>要返回的HTML字符串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">HtmlResult</span>(<span class="params"><span class="built_in">string</span> html</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.html = html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行结果处理方法</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;httpContext&quot;&gt;</span>HTTP上下文对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">ExecuteAsync</span>(<span class="params">HttpContext httpContext</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 设置响应内容类型为HTML</span></span><br><span class="line">            httpContext.Response.ContentType = <span class="string">&quot;text/html&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 计算并设置响应内容长度（UTF-8编码）</span></span><br><span class="line">            httpContext.Response.ContentLength = Encoding.UTF8.GetByteCount(html);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将HTML内容写入响应流</span></span><br><span class="line">            <span class="keyword">await</span> httpContext.Response.WriteAsync(html);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Program.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义根路径端点，用于服务健康检查</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/&quot;</span>, HtmlResult() =&gt; &#123; </span><br><span class="line">    <span class="built_in">string</span> html = <span class="string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Web API&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> HtmlResult(html);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/14/NET-ASP-06/image-20250414164428107.png" alt="image-20250414164428107"></p>
<h1 id="6、重构员工相关代码"><a href="#6、重构员工相关代码" class="headerlink" title="6、重构员工相关代码"></a>6、重构员工相关代码</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.Json;</span><br><span class="line"><span class="keyword">using</span> WebApi.Models;</span><br><span class="line"><span class="keyword">using</span> WebApi.Results;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化Web应用构建器，自动加载appsettings.json配置文件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加问题详情服务，用于生成标准化的错误响应</span></span><br><span class="line">builder.Services.AddProblemDetails();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用实例，初始化中间件管道</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 非开发环境下配置异常处理中间件</span></span><br><span class="line"><span class="keyword">if</span> (!app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 使用统一的异常处理器处理未捕获异常</span></span><br><span class="line">    app.UseExceptionHandler();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加状态码页面处理中间件，自动处理4xx/5xx状态码</span></span><br><span class="line">app.UseStatusCodePages();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义根路径端点，返回HTML页面用于服务健康检查</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/&quot;</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 创建简单的HTML页面内容</span></span><br><span class="line">    <span class="built_in">string</span> html = <span class="string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Web API&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>;</span><br><span class="line">    <span class="comment">// 返回自定义的HTML响应结果</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> HtmlResult(html);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义获取所有员工的GET端点</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/employees&quot;</span>, () =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 从仓储层获取所有员工数据</span></span><br><span class="line">    <span class="keyword">var</span> employees = EmployeesRepository.GetEmployees();</span><br><span class="line">    <span class="comment">// 返回200 OK响应，自动将结果序列化为JSON</span></span><br><span class="line">    <span class="keyword">return</span> TypedResults.Ok(employees);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义获取单个员工的GET端点，支持ID参数</span></span><br><span class="line">app.MapGet(<span class="string">&quot;/employees/&#123;id:int&#125;&quot;</span>, (<span class="built_in">int</span> id) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 调用仓储层获取指定ID的员工对象</span></span><br><span class="line">    <span class="keyword">var</span> employee = EmployeesRepository.GetEmployeeById(id);</span><br><span class="line">    <span class="comment">// 如果员工存在返回200 OK，否则返回404错误</span></span><br><span class="line">    <span class="keyword">return</span> employee <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span> ?</span><br><span class="line">        TypedResults.Ok(employee) : Results.ValidationProblem(<span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>[]&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            &#123;<span class="string">&quot;id&quot;</span>, <span class="keyword">new</span>[] &#123; <span class="string">$&quot;员工<span class="subst">&#123;id&#125;</span>并不存在&quot;</span> &#125; &#125;</span><br><span class="line">        &#125;, statusCode: <span class="number">404</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义创建新员工的POST端点</span></span><br><span class="line">app.MapPost(<span class="string">&quot;/employees&quot;</span>, (Employee employee) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 参数验证：检查员工对象是否为空和ID是否有效</span></span><br><span class="line">    <span class="keyword">if</span> (employee <span class="keyword">is</span> <span class="literal">null</span> || employee.Id &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 返回符合RFC 7807标准的验证错误响应，状态码400</span></span><br><span class="line">        <span class="keyword">return</span> Results.ValidationProblem(<span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>[]&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            &#123;<span class="string">&quot;id&quot;</span>, <span class="keyword">new</span>[] &#123; <span class="string">&quot;必须提供有效的员工信息&quot;</span> &#125; &#125;</span><br><span class="line">        &#125;, statusCode: <span class="number">400</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用仓储层添加新员工</span></span><br><span class="line">    EmployeesRepository.AddEmployee(employee);</span><br><span class="line">    <span class="comment">// 返回201 Created响应，包含新创建资源的URI</span></span><br><span class="line">    <span class="keyword">return</span> TypedResults.Created(<span class="string">$&quot;/employees/<span class="subst">&#123;employee.Id&#125;</span>&quot;</span>, employee);</span><br><span class="line"></span><br><span class="line">&#125;).WithParameterValidation();  <span class="comment">// 启用基于数据注解的自动参数验证</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义更新员工的PUT端点</span></span><br><span class="line">app.MapPut(<span class="string">&quot;/employees/&#123;id:int&#125;&quot;</span>, (<span class="built_in">int</span> id, Employee employee) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 参数验证：检查URL中的ID与请求体中的ID是否一致</span></span><br><span class="line">    <span class="keyword">if</span> (employee.Id != id)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 返回ID不一致的错误响应，状态码400</span></span><br><span class="line">        <span class="keyword">return</span> Results.ValidationProblem(<span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>[]&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            &#123;<span class="string">&quot;id&quot;</span>, <span class="keyword">new</span>[] &#123; <span class="string">$&quot;<span class="subst">&#123;id&#125;</span>与员工id不一致&quot;</span> &#125; &#125;</span><br><span class="line">        &#125;, statusCode: <span class="number">400</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用仓储层更新员工信息，成功返回204 NoContent，失败返回404错误</span></span><br><span class="line">    <span class="keyword">return</span> EmployeesRepository.UpdateEmployee(employee) ?</span><br><span class="line">        TypedResults.NoContent() :</span><br><span class="line">        Results.ValidationProblem(<span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>[]&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            &#123;<span class="string">&quot;id&quot;</span>, <span class="keyword">new</span>[] &#123; <span class="string">$&quot;员工<span class="subst">&#123;id&#125;</span>并不存在&quot;</span> &#125; &#125;</span><br><span class="line">        &#125;, statusCode: <span class="number">404</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义删除员工的DELETE端点</span></span><br><span class="line">app.MapDelete(<span class="string">&quot;/employees/&#123;id:int&#125;&quot;</span>, (<span class="built_in">int</span> id) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 先获取要删除的员工信息</span></span><br><span class="line">    <span class="keyword">var</span> employee = EmployeesRepository.GetEmployeeById(id);</span><br><span class="line">    <span class="comment">// 调用仓储层删除员工，成功返回200 OK和员工信息，失败返回404错误</span></span><br><span class="line">    <span class="keyword">return</span> EmployeesRepository.DeleteEmployee(id) ?</span><br><span class="line">        TypedResults.Ok(employee) :</span><br><span class="line">        Results.ValidationProblem(<span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>[]&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            &#123;<span class="string">&quot;id&quot;</span>, <span class="keyword">new</span>[] &#123; <span class="string">$&quot;员工<span class="subst">&#123;id&#125;</span>并不存在&quot;</span> &#125; &#125;</span><br><span class="line">        &#125;, statusCode: <span class="number">404</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动Web应用</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://alsl521.github.io">kyl</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://alsl521.github.io/2025/04/14/NET-ASP-06/">https://alsl521.github.io/2025/04/14/NET-ASP-06/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://alsl521.github.io" target="_blank">kyl的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C#</a></div><div class="post-share"><div class="social-share" data-image="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/11/NET-ASP-05/" title="ASP.NET学习记录-05-模型数据绑定"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">ASP.NET学习记录-05-模型数据绑定</div></div><div class="info-2"><div class="info-item-1">1、模型绑定定义模型绑定是ASP.NET Core中将HTTP请求数据自动映射到方法参数或对象属性的机制。其核心工作流程：  数据来源：  路由参数（URL片段） 查询字符串（?key&#x3D;value） 请求体（表单&#x2F;JSON&#x2F;XML） 请求头 文件上传   典型应用：   12345678910111213// 自动绑定路由参数和查询参数[HttpGet(&quot;/products/&#123;id&#125;&quot;)]public IActionResult GetProduct(int id, [FromQuery] string category) &#123;    // id来自路由参数，category来自查询字符串&#125;// 自动绑定JSON请求体[HttpPost]public IActionResult Create([FromBody] Product product)&#123;    //...</div></div></div></a><a class="pagination-related" href="/2025/04/14/NET-ASP-07/" title="ASP.NET学习记录-07-代码组织和依赖注入"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">ASP.NET学习记录-07-代码组织和依赖注入</div></div><div class="info-2"><div class="info-item-1">1、代码组织在 ASP.NET 中，“代码组织”指的是如何结构化代码，以提高可维护性、可读性和可扩展性。这涉及多个方面，包括项目结构、分层架构、模块化设计和最佳实践。  项目结构  在 ASP.NET Core 中，一个典型的项目组织方式如下： 12345678910/MyApp ├── Controllers/      // 处理 HTTP 请求的控制器 ├── Models/           // 数据模型 ├── Views/            // Razor 视图（如果使用 MVC） ├── Services/         // 业务逻辑层 ├── Middleware/       // 自定义中间件 ├── Data/             // 数据访问层（EF Core、存储库等） ├── wwwroot/          // 静态文件（CSS、JS、Images） ├── Program.cs        // 应用程序启动入口 ├── appsettings.json  //...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/04/08/NET-ASP-01/" title="ASP.NET学习记录-01-基础知识"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-01-基础知识</div></div><div class="info-2"><div class="info-item-1">视频教程为：ASP.NET Core Deep-Dive in .NET 9 | Udemy 1、.NET Core.NET Core 是微软开发的开源、跨平台应用程序开发框架，旨在为现代云原生、微服务及高性能场景提供支持。以下是其核心特性与定位的详细说明：  一、核心定义与定位 跨平台支持 .NET Core 可在 Windows、Linux、macOS 等操作系统上运行，并支持 x86、x64、ARM 等多种架构。 这种跨平台能力使其成为开发云原生、容器化应用（如 Docker）的理想选择。  开源与社区驱动 作为 MIT 协议下的开源项目，.NET Core 的代码托管于 GitHub，接受社区贡献，确保了技术透明度和快速迭代。    二、架构与技术特性 模块化设计 采用包化（Packages）管理，开发者可按需引用组件，减少应用体积，与传统的 .NET Framework 打包式安装形成对比。例如，通过 1dotnet restore  命令可动态还原依赖的 NuGet 包。  高性能运行时  RyuJIT 编译器：相比传统 JIT，性能提升约 25%，支持 SIMD...</div></div></div></a><a class="pagination-related" href="/2025/04/08/NET-ASP-02/" title="ASP.NET学习记录-02-最小API模式"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-02-最小API模式</div></div><div class="info-2"><div class="info-item-1">1、创建第一个ASP.NET应用（Minimal API）1.创建新项目 选择新的空项目  设定基本信息  使用最新版.NET作为学习内容  2.项目架构简介与解析 1. 解决方案（Solution） 名称：MyFirstWebApplication 作用： 作为容器管理多个相关项目（当前仅包含一个项目 WebApplication）。 支持团队协作和复杂应用的模块化开发（如Web API、类库、单元测试等）。   关键点： 可通过解决方案配置统一管理所有项目的依赖和环境设置。   新增项目 右键单击解决方案-&gt;添加-&gt;新建项目      2. 项目（Project: WebApplication） 核心结构：包含构建和运行Web应用所需的所有文件与配置，分为以下关键部分：  a. Connected Services 文件夹 作用： 存储与外部服务的连接配置（如数据库、Azure服务、第三方API）。 通过右键添加服务（如Entity Framework、Azure认证），自动生成连接配置文件。   示例：添加Azure...</div></div></div></a><a class="pagination-related" href="/2025/04/08/NET-ASP-03/" title="ASP.NET学习记录-03-中间件管道"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-03-中间件管道</div></div><div class="info-2"><div class="info-item-1">1、中间件管道简介在 C# ASP.NET Core 中，中间件管道是处理 HTTP 请求和响应的核心机制，通过将多个中间件按顺序串联成一个处理流程，实现灵活的请求处理和业务逻辑组合。以下是其核心要点：  1. 中间件管道的基本概念 中间件（Middleware）：是管道中的独立组件，负责处理 HTTP 请求和响应。每个中间件可以：  对请求进行预处理（如日志、身份验证）。  调用下一个中间件（通过 next()），或直接终止处理（短路）。  对响应进行后处理（如修改响应头、记录耗时）。      管道（Pipeline）：由多个中间件按注册顺序串联而成，形成一个“请求→处理→响应”的流程。请求按顺序经过所有中间件，而响应则逆序返回  。    2. 管道的工作模式：1-n 然后 n-1 请求阶段（正向传递）：请求从第一个中间件开始，依次传递至最后一个中间件（终结点），形成“1→2→3”的顺序 。  响应阶段（逆向返回）：处理完成后，响应从终结点开始，逆序返回至第一个中间件，形成“3→2→1”的顺序  。 示例 123Middleware One: Request Start...</div></div></div></a><a class="pagination-related" href="/2025/04/10/NET-ASP-04/" title="ASP.NET学习记录-03-路由"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-10</div><div class="info-item-2">ASP.NET学习记录-03-路由</div></div><div class="info-2"><div class="info-item-1">1、Routing和Endpoints简介在ASP.NET Core中，**路由（Routing）和终结点（Endpoints）**是处理HTTP请求的核心机制，它们共同构成了请求分发的管道系统。以下是对两者的详细介绍：  一、路由（Routing）路由的核心作用是将传入的HTTP请求根据URL路径和HTTP方法匹配到对应的处理逻辑（终结点）。在ASP.NET Core中，路由系统被称为终结点路由（Endpoint Routing）。 主要功能与工作流程 匹配请求：通过UseRouting中间件（即EndpointRoutingMiddleware）扫描应用中所有注册的终结点，根据请求的URL和HTTP方法选择最匹配的终结点 。示例代码：  12345app.UseRouting();app.UseEndpoints(endpoints =&gt; &#123;    endpoints.MapGet(&quot;/&quot;, async context =&gt; &#123; ......</div></div></div></a><a class="pagination-related" href="/2025/04/11/NET-ASP-05/" title="ASP.NET学习记录-05-模型数据绑定"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-11</div><div class="info-item-2">ASP.NET学习记录-05-模型数据绑定</div></div><div class="info-2"><div class="info-item-1">1、模型绑定定义模型绑定是ASP.NET Core中将HTTP请求数据自动映射到方法参数或对象属性的机制。其核心工作流程：  数据来源：  路由参数（URL片段） 查询字符串（?key&#x3D;value） 请求体（表单&#x2F;JSON&#x2F;XML） 请求头 文件上传   典型应用：   12345678910111213// 自动绑定路由参数和查询参数[HttpGet(&quot;/products/&#123;id&#125;&quot;)]public IActionResult GetProduct(int id, [FromQuery] string category) &#123;    // id来自路由参数，category来自查询字符串&#125;// 自动绑定JSON请求体[HttpPost]public IActionResult Create([FromBody] Product product)&#123;    //...</div></div></div></a><a class="pagination-related" href="/2025/04/15/NET-ASP-09/" title="ASP.NET学习记录-09-MVC"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-15</div><div class="info-item-2">ASP.NET学习记录-09-MVC</div></div><div class="info-2"><div class="info-item-1">1、MVC PatternASP.NET中的MVC（Model-View-Controller）模式是一种软件架构设计模式，它将应用程序分为三个核心组件：模型（Model）、视图（View）和控制器（Controller），以实现关注点分离，提升代码可维护性和可扩展性。  以下是其具体内涵及在ASP.NET中的应用特点： 1....</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">kyl</div><div class="author-info-description">用于记录平时学习的博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/alsl521" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:852970167@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E3%80%81IResult"><span class="toc-number">1.</span> <span class="toc-text">1、IResult</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%E3%80%81%E6%B7%B7%E5%90%88%E5%8C%B9%E9%85%8DResults%E5%92%8CTypedResults"><span class="toc-number">2.</span> <span class="toc-text">2、混合匹配Results和TypedResults</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%E3%80%81%E9%97%AE%E9%A2%98%E8%AF%A6%E6%83%85%E6%A0%87%E5%87%86"><span class="toc-number">3.</span> <span class="toc-text">3、问题详情标准</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4%E3%80%81%E6%A0%87%E5%87%86%E5%8C%96%E6%89%80%E6%9C%89%E8%BE%93%E5%87%BA"><span class="toc-number">4.</span> <span class="toc-text">4、标准化所有输出</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AE%9E%E7%8E%B0IResult"><span class="toc-number">5.</span> <span class="toc-text">5、自定义实现IResult</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6%E3%80%81%E9%87%8D%E6%9E%84%E5%91%98%E5%B7%A5%E7%9B%B8%E5%85%B3%E4%BB%A3%E7%A0%81"><span class="toc-number">6.</span> <span class="toc-text">6、重构员工相关代码</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/21/NET-ASP-13/" title="ASP.NET学习记录-13-实践2-数据库进阶">ASP.NET学习记录-13-实践2-数据库进阶</a><time datetime="2025-04-21T08:39:19.000Z" title="发表于 2025-04-21 16:39:19">2025-04-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/18/NET-ASP-12/" title="ASP.NET学习记录-12-实践2-使用MySQL数据库">ASP.NET学习记录-12-实践2-使用MySQL数据库</a><time datetime="2025-04-18T08:11:21.000Z" title="发表于 2025-04-18 16:11:21">2025-04-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/18/NET-ASP-11/" title="ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API">ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API</a><time datetime="2025-04-18T02:13:44.000Z" title="发表于 2025-04-18 10:13:44">2025-04-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/16/NET-ASP-10/" title="ASP.NET学习记录-10-过滤">ASP.NET学习记录-10-过滤</a><time datetime="2025-04-16T12:02:16.000Z" title="发表于 2025-04-16 20:02:16">2025-04-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/15/Software/" title="记录必备软件">记录必备软件</a><time datetime="2025-04-15T11:29:21.000Z" title="发表于 2025-04-15 19:29:21">2025-04-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By kyl</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>