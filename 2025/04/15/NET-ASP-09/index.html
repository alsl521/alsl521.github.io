<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ASP.NET学习记录-09-MVC | kyl的博客</title><meta name="author" content="kyl"><meta name="copyright" content="kyl"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:type" content="article">
<meta property="og:title" content="ASP.NET学习记录-09-MVC">
<meta property="og:url" content="https://alsl521.github.io/2025/04/15/NET-ASP-09/index.html">
<meta property="og:site_name" content="kyl的博客">
<meta property="og:description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4">
<meta property="article:published_time" content="2025-04-15T02:26:32.000Z">
<meta property="article:modified_time" content="2025-04-16T12:02:31.697Z">
<meta property="article:author" content="kyl">
<meta property="article:tag" content="C#">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ASP.NET学习记录-09-MVC",
  "url": "https://alsl521.github.io/2025/04/15/NET-ASP-09/",
  "image": "https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4",
  "datePublished": "2025-04-15T02:26:32.000Z",
  "dateModified": "2025-04-16T12:02:31.697Z",
  "author": [
    {
      "@type": "Person",
      "name": "kyl",
      "url": "https://alsl521.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://alsl521.github.io/2025/04/15/NET-ASP-09/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ASP.NET学习记录-09-MVC',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">66</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">23</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">kyl的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">ASP.NET学习记录-09-MVC</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">ASP.NET学习记录-09-MVC</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-15T02:26:32.000Z" title="发表于 2025-04-15 10:26:32">2025-04-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-16T12:02:31.697Z" title="更新于 2025-04-16 20:02:31">2025-04-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/">C#</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/ASP/">ASP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="1、MVC-Pattern"><a href="#1、MVC-Pattern" class="headerlink" title="1、MVC Pattern"></a>1、MVC Pattern</h1><p>ASP.NET中的MVC（Model-View-Controller）模式是一种软件架构设计模式，它将应用程序分为三个核心组件：<strong>模型（Model）、视图（View）和控制器（Controller）</strong>，以实现关注点分离，提升代码可维护性和可扩展性。</p>
<p><img src="/2025/04/15/NET-ASP-09/MVC.png" alt="What is MVC? How to use ASP.NET Core? – RI-TECH BLOG"></p>
<p>以下是其具体内涵及在ASP.NET中的应用特点：</p>
<h3 id="1-MVC的核心组件"><a href="#1-MVC的核心组件" class="headerlink" title="1. MVC的核心组件"></a>1. <strong>MVC的核心组件</strong></h3><ul>
<li><p><strong>模型（Model）</strong><br>负责处理应用程序的数据逻辑和业务规则。模型直接与数据库交互，执行数据的存取、验证及业务逻辑处理，例如定义商品信息的属性及操作（如增删改查）。在ASP.NET中，模型可以是简单的数据传输对象（DTO），也可以是包含复杂业务逻辑的领域模型。</p>
</li>
<li><p><strong>视图（View）</strong><br>负责用户界面的展示。视图通过HTML、CSS和JavaScript动态渲染模型传递的数据，例如生成商品列表页面或订单详情页面。ASP.NET支持Razor视图引擎，允许在视图中嵌入C#代码，实现灵活的数据绑定。</p>
</li>
<li><p><strong>控制器（Controller）</strong><br>作为用户请求的中转站，接收输入（如HTTP请求），调用模型处理数据，并选择合适的视图返回响应。例如，用户点击“购买”按钮时，控制器会调用业务逻辑验证库存，再跳转到支付页面或错误提示。</p>
</li>
</ul>
<h3 id="2-MVC在ASP-NET中的优势"><a href="#2-MVC在ASP-NET中的优势" class="headerlink" title="2. MVC在ASP.NET中的优势"></a>2. <strong>MVC在ASP.NET中的优势</strong></h3><ul>
<li><p><strong>关注点分离</strong><br>业务逻辑（Model）、界面（View）和流程控制（Controller）的解耦使代码更清晰，便于团队协作开发。例如，前端开发者可独立设计视图，后端开发者专注模型和控制器。</p>
</li>
<li><p><strong>增强可测试性</strong><br>各组件独立设计，支持单元测试和测试驱动开发（TDD）。例如，控制器可通过Mock模型进行测试，无需启动完整Web服务。</p>
</li>
<li><p><strong>灵活的URL路由</strong><br>ASP.NET MVC提供强大的路由系统，允许自定义URL规则（如<code>/products/details/123</code>映射到控制器动作），提升SEO友好性。</p>
</li>
<li><p><strong>无ViewState与服务器控件</strong><br>相比传统Web Forms，MVC不依赖ViewState和服务器控件，开发者可更精细地控制HTML和HTTP请求行为，减少页面性能开销。</p>
</li>
</ul>
<h3 id="3-与传统ASP-NET-Web-Forms的对比"><a href="#3-与传统ASP-NET-Web-Forms的对比" class="headerlink" title="3. 与传统ASP.NET Web Forms的对比"></a>3. <strong>与传统ASP.NET Web Forms的对比</strong></h3><ul>
<li><p><strong>Web Forms</strong><br>采用事件驱动模型和服务器控件，适合快速开发小型应用，但代码耦合度高，测试困难。</p>
</li>
<li><p><strong>MVC</strong><br>更适合复杂、需要长期维护的大型项目，支持现代开发实践（如依赖注入、跨平台部署）。例如，ASP.NET Core MVC可运行于Linux环境，通过中间件配置简化请求处理流程。</p>
</li>
</ul>
<h3 id="4-实际应用场景"><a href="#4-实际应用场景" class="headerlink" title="4. 实际应用场景"></a>4. <strong>实际应用场景</strong></h3><ul>
<li><p><strong>企业级系统</strong><br>如电商平台，模型处理订单逻辑，视图展示商品信息，控制器协调用户操作与库存管理。</p>
</li>
<li><p><strong>API开发</strong><br>MVC模式天然支持RESTful API设计，通过<code>ActionResult&lt;T&gt;</code>返回JSON或XML数据。</p>
</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>ASP.NET MVC通过分层架构优化了Web应用的结构，尤其适用于需要高可维护性、可测试性和灵活性的项目。其核心思想是通过分离职责，让开发者能够专注于不同层面的逻辑实现，从而提升开发效率和代码质量。</p>
<h1 id="2、Razor"><a href="#2、Razor" class="headerlink" title="2、Razor"></a>2、Razor</h1><p>ASP.NET中的<strong>Razor</strong>是一种基于C#或VB.NET的服务器端标记语法，用于在HTML中嵌入动态代码以生成Web页面内容。它最初随ASP.NET MVC 3发布，现已成为ASP.NET Core的核心组件之一，广泛应用于MVC和Razor Pages等开发模式中。以下是其核心特性及功能：</p>
<hr>
<h3 id="1-Razor的核心设计理念"><a href="#1-Razor的核心设计理念" class="headerlink" title="1. Razor的核心设计理念"></a>1. <strong>Razor的核心设计理念</strong></h3><ul>
<li><p><strong>代码与HTML无缝融合</strong><br>Razor通过<code>@</code>符号将C#代码嵌入HTML，无需传统ASP.NET Web Forms的<code>&lt;% %&gt;</code>标签，简化了代码与标记的切换。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>当前时间：@DateTime.Now.ToString(&quot;yyyy-MM-dd&quot;)<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>代码块通过<code>@&#123;&#125;</code>包裹，支持多行逻辑。</p>
</li>
<li><p><strong>智能语法解析</strong><br>Razor能自动识别代码与HTML的边界。例如，在条件语句中可直接混用HTML标签：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@if (isAdmin) &#123;</span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span>&gt;</span>管理员操作<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="2-Razor语法的主要特性"><a href="#2-Razor语法的主要特性" class="headerlink" title="2. Razor语法的主要特性"></a>2. <strong>Razor语法的主要特性</strong></h3><ul>
<li><p><strong>表达式与编码</strong></p>
<ul>
<li><p>隐式表达式：直接使用<code>@变量名</code>输出内容（如<code>@Model.Title</code>），自动对HTML敏感字符编码以防止XSS攻击。</p>
</li>
<li><p>显式表达式：通过<code>@()</code>包裹复杂表达式（如<code>@(a + b)</code>）或泛型方法调用（如<code>@(GenericMethod&lt;int&gt;(10))</code>）。</p>
</li>
</ul>
</li>
<li><p><strong>控制结构</strong><br>支持完整的C#流程控制，包括条件语句（<code>@if</code>、<code>@switch</code>）和循环（<code>@for</code>、<code>@foreach</code>），例如动态生成列表：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    @foreach (var item in items) &#123;</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>@item.Name<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>模板化与复用</strong></p>
<ul>
<li><p>布局页（Layout）：通过<code>@&#123; Layout = &quot;_Layout.cshtml&quot;; &#125;</code>定义公共页面结构，实现UI复用。</p>
</li>
<li><p>分部视图（Partial View）：使用<code>@await Html.PartialAsync(&quot;_PartialView.cshtml&quot;)</code>嵌入可重用的UI片段。</p>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-Razor在ASP-NET技术栈中的应用"><a href="#3-Razor在ASP-NET技术栈中的应用" class="headerlink" title="3. Razor在ASP.NET技术栈中的应用"></a>3. <strong>Razor在ASP.NET技术栈中的应用</strong></h3><ul>
<li><p><strong>与ASP.NET Core MVC集成</strong><br>Razor是MVC视图引擎的标准选择，通过控制器（Controller）传递模型（Model）数据到视图（View），动态渲染页面 。例如，使用<code>@Html.ActionLink</code>生成超链接，关联控制器动作。</p>
</li>
<li><p><strong>Razor Pages模型</strong><br>在ASP.NET Core中，Razor Pages将页面逻辑与UI绑定，每个<code>.cshtml</code>文件可包含<code>@page</code>指令和直接处理HTTP请求的代码块，简化小型应用的开发。</p>
</li>
<li><p><strong>跨平台支持</strong><br>Razor与ASP.NET Core深度集成，可在Windows、Linux和macOS上运行，并支持Docker容器化部署。</p>
</li>
</ul>
<hr>
<h3 id="4-Razor的优势与适用场景"><a href="#4-Razor的优势与适用场景" class="headerlink" title="4. Razor的优势与适用场景"></a>4. <strong>Razor的优势与适用场景</strong></h3><ul>
<li><p>开发效率高：通过智能提示和简洁语法减少代码量，支持Visual Studio的强类型检查和调试。</p>
</li>
<li><p>安全性强：自动编码输出内容，减少XSS风险。</p>
</li>
<li><p>灵活性：可与JavaScript框架（如React）结合，或通过<code>Html.Raw()</code>输出原始HTML。</p>
</li>
<li><p>适用场景：适用于动态内容渲染（如电商产品列表）、表单处理、以及需要服务器端逻辑的复杂UI生成。</p>
</li>
</ul>
<hr>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>Razor通过其简洁的语法、强大的模板功能和与ASP.NET生态的深度集成，成为构建动态Web应用的高效工具。无论是传统的MVC项目还是现代化的Razor Pages，它都能提供灵活且安全的服务器端渲染方案。</p>
<h1 id="3、主页面实现"><a href="#3、主页面实现" class="headerlink" title="3、主页面实现"></a>3、主页面实现</h1><p>DepartsCRUD\WebApp\Controllers\HomeController.cs</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">@using WebApp.Models @* 引入应用程序模型命名空间 *@</span><br><span class="line"></span><br><span class="line">@* 声明Razor代码块开始 *@</span><br><span class="line">@&#123;</span><br><span class="line">    // 计算当前日期到今年圣诞节的天数差</span><br><span class="line">    var days = new DateTime(DateTime.Today.Year, 12, 25) - DateTime.Today;</span><br><span class="line"></span><br><span class="line">    // 处理跨年情况：如果今年圣诞已过，计算到明年圣诞的天数</span><br><span class="line">    if (DateTime.Today &gt; new DateTime(DateTime.Today.Year, 12, 25))</span><br><span class="line">    &#123;</span><br><span class="line">        days = new DateTime(DateTime.Today.Year + 1, 12, 25) - DateTime.Today;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 根据天数奇偶性设置文字颜色（交替显示红绿）</span><br><span class="line">    string color = days.Days % 2 == 0 ? &quot;green&quot; : &quot;red&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Home page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    @* 条件渲染：当剩余天数≤35天时显示节日提示 *@</span><br><span class="line">    @if (days.Days &lt;= 35)</span><br><span class="line">    &#123;</span><br><span class="line">        @* 直接输出HTML元素 *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Christmas is around the corner!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        @* 使用@:输出纯文本内容 *@</span><br><span class="line">        @:Happy holidays!</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        @* 根据颜色变量切换标题样式 *@</span><br><span class="line">        switch (color)</span><br><span class="line">        &#123;</span><br><span class="line">            case &quot;green&quot;:</span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&quot;color:green&quot;</span>&gt;</span>Welcome home!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                break;</span><br><span class="line">            case &quot;red&quot;:</span><br><span class="line">                <span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>Welcome home!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @* 混合输出：C#表达式 + 纯文本内容 *@</span><br><span class="line">        @days.Days</span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span> days before Christmas!<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>DepartsCRUD\WebApp\Views\Home\Index.cshtml</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入MVC核心命名空间</span></span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Controllers</span> <span class="comment">// 控制器所在的命名空间</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HomeController</span> : <span class="title">Controller</span> <span class="comment">// 继承Controller基类</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 处理根路径请求的Action方法</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Index</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 显式指定返回名为&quot;Index&quot;的视图</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ViewResult &#123; ViewName = <span class="string">&quot;Index&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 等效写法（被注释的默认返回方式）：</span></span><br><span class="line">            <span class="comment">// 根据约定自动查找Views/Home/Index.cshtml视图</span></span><br><span class="line">            <span class="comment">//return View();</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>DepartsCRUD\WebApp\Program.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个Web应用程序构建器实例</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向构建器添加控制器和视图的支持</span></span><br><span class="line">builder.Services.AddControllersWithViews();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建应用程序</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用路由中间件</span></span><br><span class="line">app.UseRouting();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置路由端点</span></span><br><span class="line">app.UseEndpoints(endpoints =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 定义默认路由模式，将请求映射到控制器和操作方法</span></span><br><span class="line">    endpoints.MapControllerRoute(</span><br><span class="line">        name: <span class="string">&quot;default&quot;</span>, <span class="comment">// 路由名称</span></span><br><span class="line">        pattern: <span class="string">&quot;&#123;controller=Home&#125;/&#123;action=Index&#125;/&#123;id?&#125;&quot;</span> <span class="comment">// 路由模式，&#123;controller&#125;默认值为Home，&#123;action&#125;默认值为Index，&#123;id&#125;为可选参数</span></span><br><span class="line">    );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 运行应用程序</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/15/NET-ASP-09/image-20250416104251455.png" alt="image-20250416104251455"></p>
<h1 id="4、Department相关实现"><a href="#4、Department相关实现" class="headerlink" title="4、Department相关实现"></a>4、Department相关实现</h1><h2 id="1-Department"><a href="#1-Department" class="headerlink" title="1.Department"></a>1.Department</h2><p>DepartsCRUD\WebApp\Model\Department.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入MVC核心命名空间和数据注解命名空间</span></span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> System.ComponentModel.DataAnnotations;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Models</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Department</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 默认构造函数（实体框架ORM需要空构造）</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Department</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 全参构造函数用于快速初始化对象</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Department</span>(<span class="params"><span class="built_in">int</span> id, <span class="built_in">string</span> name, <span class="built_in">string</span>? description = <span class="string">&quot;&quot;</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.Id = id;          <span class="comment">// 部门唯一标识</span></span><br><span class="line">            <span class="keyword">this</span>.Name = name;      <span class="comment">// 必填部门名称</span></span><br><span class="line">            <span class="keyword">this</span>.Description = description; <span class="comment">// 可选描述信息</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 部门ID（主键）</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">Required</span>] <span class="comment">// 数据验证：名称字段必填</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">// 可为空的字符串类型</span></span><br><span class="line"></span><br><span class="line">        [<span class="meta">StringLength(500)</span>] <span class="comment">// 数据验证：最大允许500字符</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Description &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">// 可选描述字段</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-DepartmentsRepository"><a href="#2-DepartmentsRepository" class="headerlink" title="2.DepartmentsRepository"></a>2.DepartmentsRepository</h2><p>DepartsCRUD\WebApp\Model\DepartmentsRepository.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Xml.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Models</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">DepartmentsRepository</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 静态内存数据源（模拟数据库表）</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Department&gt; Departments = <span class="keyword">new</span> List&lt;Department&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">new</span> Department(<span class="number">1</span>, <span class="string">&quot;Sales&quot;</span>, <span class="string">&quot;Sales Department&quot;</span>),       <span class="comment">// 初始化销售部门</span></span><br><span class="line">            <span class="keyword">new</span> Department(<span class="number">2</span>, <span class="string">&quot;Engineering&quot;</span>, <span class="string">&quot;Engineering Department&quot;</span>), <span class="comment">// 技术部门</span></span><br><span class="line">            <span class="keyword">new</span> Department(<span class="number">3</span>, <span class="string">&quot;QA&quot;</span>, <span class="string">&quot;Quanlity Assurance&quot;</span>)         <span class="comment">// 质量保障部门</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取全部部门列表（直接返回内存集合）</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Department&gt; <span class="title">GetDepartments</span>()</span> =&gt; Departments;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 按ID查询单个部门（可能返回null）</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Department? GetDepartmentById(<span class="built_in">int</span> id)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Departments.FirstOrDefault(x =&gt; x.Id == id); <span class="comment">// LINQ查询匹配ID</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 添加新部门（自动生成递增ID）</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddDepartment</span>(<span class="params">Department? department</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (department <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 计算当前最大ID并+1生成新ID</span></span><br><span class="line">                <span class="built_in">int</span> maxId = Departments.Max(x =&gt; x.Id);</span><br><span class="line">                department.Id = maxId + <span class="number">1</span>;</span><br><span class="line">                Departments.Add(department); <span class="comment">// 加入内存集合</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 更新部门信息（基于ID定位）</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">UpdateDepartment</span>(<span class="params">Department? department</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (department <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> emp = Departments.FirstOrDefault(x =&gt; x.Id == department.Id);</span><br><span class="line">                <span class="keyword">if</span> (emp <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 更新可修改字段（保留原始ID）</span></span><br><span class="line">                    emp.Name = department.Name;</span><br><span class="line">                    emp.Description = department.Description;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 更新成功</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 更新失败</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 删除部门记录（物理删除）</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">DeleteDepartment</span>(<span class="params">Department? department</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (department <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Departments.Remove(department); <span class="comment">// 从集合移除对象</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 删除成功</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 删除失败</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-DepartmentsController"><a href="#3-DepartmentsController" class="headerlink" title="3.DepartmentsController"></a>3.DepartmentsController</h2><p>DepartsCRUD\WebApp\Controllers\DepartmentsController.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入MVC核心组件和模型命名空间</span></span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> WebApp.Models;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DepartmentsController</span> : <span class="title">Controller</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">HttpGet</span>] <span class="comment">// 处理GET请求：显示部门列表</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Index</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> departments = DepartmentsRepository.GetDepartments(); <span class="comment">// 从仓储获取全部数据</span></span><br><span class="line">            <span class="keyword">return</span> View(departments); <span class="comment">// 将数据模型传递给列表视图</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">HttpGet</span>] <span class="comment">// 处理GET请求：显示单个部门详情</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Details</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> department = DepartmentsRepository.GetDepartmentById(id);</span><br><span class="line">            <span class="keyword">if</span> (department == <span class="literal">null</span>) <span class="comment">// 处理数据不存在的情况</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> View(<span class="string">&quot;Error&quot;</span>, <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;Department not found.&quot;</span> &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> View(department); <span class="comment">// 传递部门对象到详情视图</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">HttpPost</span>] <span class="comment">// 处理POST请求：更新部门信息</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Edit</span>(<span class="params">Department department</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!ModelState.IsValid) <span class="comment">// 验证模型数据有效性</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> View(<span class="string">&quot;Error&quot;</span>, GetErrors());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            DepartmentsRepository.UpdateDepartment(department); <span class="comment">// 调用仓储更新方法</span></span><br><span class="line">            <span class="keyword">return</span> RedirectToAction(<span class="keyword">nameof</span>(Index)); <span class="comment">// 返回列表页</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">HttpGet</span>] <span class="comment">// 处理GET请求：显示新建表单</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Create</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> View(<span class="keyword">new</span> Department()); <span class="comment">// 初始化空对象给表单视图</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">HttpPost</span>] <span class="comment">// 处理POST请求：提交新建数据</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Create</span>(<span class="params">Department department</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!ModelState.IsValid) <span class="comment">// 验证数据有效性</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> View(<span class="string">&quot;Error&quot;</span>, GetErrors());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            DepartmentsRepository.AddDepartment(department); <span class="comment">// 调用仓储新增方法</span></span><br><span class="line">            <span class="keyword">return</span> RedirectToAction(<span class="keyword">nameof</span>(Index)); <span class="comment">// 返回列表页</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">HttpPost</span>] <span class="comment">// 处理POST请求：删除指定部门</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Delete</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> department = DepartmentsRepository.GetDepartmentById(id);</span><br><span class="line">            <span class="keyword">if</span> (department == <span class="literal">null</span>) <span class="comment">// 处理目标数据不存在的情况</span></span><br><span class="line">            &#123;</span><br><span class="line">                ModelState.AddModelError(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;Department not found.&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> View(<span class="string">&quot;Error&quot;</span>, GetErrors());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            DepartmentsRepository.DeleteDepartment(department); <span class="comment">// 执行删除操作</span></span><br><span class="line">            <span class="keyword">return</span> RedirectToAction(<span class="keyword">nameof</span>(Index)); <span class="comment">// 返回列表页</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 辅助方法：从ModelState中提取验证错误信息</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">GetErrors</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ModelState.Values</span><br><span class="line">                .SelectMany(v =&gt; v.Errors)</span><br><span class="line">                .Select(e =&gt; e.ErrorMessage)</span><br><span class="line">                .ToList();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-Create"><a href="#4-Create" class="headerlink" title="4.Create"></a>4.Create</h2><p>DepartsCRUD\WebApp\Views\Departments\Create.cshtml</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">@using WebApp.Models  @* 引入应用程序模型命名空间 *@</span><br><span class="line">@model Department     @* 声明视图使用的模型类型为Department *@</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    @* 引入Bootstrap CSS样式表 *@</span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">integrity</span>=<span class="string">&quot;sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH&quot;</span> <span class="attr">crossorigin</span>=<span class="string">&quot;anonymous&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span> @* Bootstrap容器布局 *@</span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>添加部门<span class="tag">&lt;/<span class="name">h3</span>&gt;</span> @* 页面标题 *@</span><br><span class="line">    </span><br><span class="line">    @* 表单定义：提交到/departments/create路径 *@</span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&#x27;post&#x27;</span> <span class="attr">action</span>=<span class="string">&#x27;/departments/create&#x27;</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        @* 部门名称输入行 *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row mb-3&quot;</span>&gt;</span> @* Bootstrap行布局 *@</span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-2&quot;</span>&gt;</span> @* 左侧标签列 *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;col-form-label&quot;</span>&gt;</span>名称<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-6&quot;</span>&gt;</span> @* 右侧输入框列 *@</span><br><span class="line">                @* 绑定模型Name属性 *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;Name&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;@Model.Name&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        @* 部门描述输入行 *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;col-form-label&quot;</span>&gt;</span>描述<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-6&quot;</span>&gt;</span></span><br><span class="line">                @* 绑定模型Description属性 *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;Description&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;@Model.Description&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        @* 按钮操作行 *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-2&quot;</span>&gt;</span></span><br><span class="line">                @* 提交按钮 *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&#x27;submit&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                    <span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span> @* 按钮间距 *@</span><br><span class="line">                @* 取消按钮(返回部门列表) *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/departments&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span>            </span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-4&quot;</span>&gt;</span></span><br><span class="line">                @* 预留空白列 *@</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/15/NET-ASP-09/image-20250416143805140.png" alt="image-20250416143805140"></p>
<h2 id="5-Details"><a href="#5-Details" class="headerlink" title="5.Details"></a>5.Details</h2><p>DepartsCRUD\WebApp\Views\Departments\Details.cshtml</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">@using WebApp.Models  @* 引入应用程序模型命名空间 *@</span><br><span class="line">@model Department     @* 声明视图使用的模型类型为Department *@</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    @* 引入Bootstrap CSS样式表 *@</span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">integrity</span>=<span class="string">&quot;sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH&quot;</span> <span class="attr">crossorigin</span>=<span class="string">&quot;anonymous&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span> @* Bootstrap容器布局 *@</span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>部门详情<span class="tag">&lt;/<span class="name">h3</span>&gt;</span> @* 页面标题 *@</span><br><span class="line">    </span><br><span class="line">    @* 编辑表单：提交到/departments/edit路径 *@</span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&#x27;post&#x27;</span> <span class="attr">action</span>=<span class="string">&#x27;/departments/edit&#x27;</span>&gt;</span></span><br><span class="line">        @* 隐藏字段：部门ID *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;hidden&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;Id&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;@Model.Id&#x27;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        @* 部门名称输入行 *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row mb-3&quot;</span>&gt;</span> @* Bootstrap行布局 *@</span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-2&quot;</span>&gt;</span> @* 左侧标签列 *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;col-form-label&quot;</span>&gt;</span>名称<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-6&quot;</span>&gt;</span> @* 右侧输入框列 *@</span><br><span class="line">                @* 绑定模型Name属性 *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;Name&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;@Model.Name&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        @* 部门描述输入行 *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;col-form-label&quot;</span>&gt;</span>描述<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-6&quot;</span>&gt;</span></span><br><span class="line">                @* 绑定模型Description属性 *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;Description&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;@Model.Description&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        @* 按钮操作行 *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-2&quot;</span>&gt;</span></span><br><span class="line">                @* 提交按钮 *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&#x27;submit&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                    <span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span> @* 按钮间距 *@</span><br><span class="line">                @* 取消按钮(返回部门列表) *@</span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/departments&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span>            </span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-4&quot;</span>&gt;</span></span><br><span class="line">                @* 预留空白列 *@</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    @* 删除表单：提交到/departments/delete/&#123;id&#125;路径 *@</span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&#x27;post&#x27;</span> <span class="attr">action</span>=<span class="string">&#x27;/departments/delete/@Model.Id&#x27;</span>&gt;</span></span><br><span class="line">        @* 删除按钮(红色危险样式) *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&#x27;submit&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-danger&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/15/NET-ASP-09/image-20250416143308714.png" alt="image-20250416143308714"></p>
<h2 id="6-Error"><a href="#6-Error" class="headerlink" title="6.Error"></a>6.Error</h2><p>DepartsCRUD\WebApp\Views\Departments\Error.cshtml</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@model List<span class="tag">&lt;<span class="name">string</span>&gt;</span>  @* 声明视图模型为字符串列表，用于显示错误信息集合 *@</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Error<span class="tag">&lt;/<span class="name">title</span>&gt;</span>  @* 页面标题设置为&quot;Error&quot; *@</span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        @* 红色错误标题 *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>Errors:<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>  </span><br><span class="line">        </span><br><span class="line">        @* 错误信息列表容器 *@</span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            @* 检查模型数据是否存在且非空 *@</span><br><span class="line">            @if (Model is not null &amp;&amp; Model.Count &gt; 0)</span><br><span class="line">            &#123;</span><br><span class="line">                @* 遍历所有错误信息并显示为列表项 *@</span><br><span class="line">                foreach (var errorMessage in Model)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>@errorMessage<span class="tag">&lt;/<span class="name">li</span>&gt;</span>  @* 显示单条错误信息 *@</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span>        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="7-Index"><a href="#7-Index" class="headerlink" title="7.Index"></a>7.Index</h2><p>DepartsCRUD\WebApp\Views\Departments\Index.cshtml</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">@using WebApp.Models </span><br><span class="line">@* 声明视图模型为Department列表 *@</span><br><span class="line">@model List&lt;Department&gt; </span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        @* 引入Bootstrap CSS样式表 *@</span><br><span class="line">        &lt;link href=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span> integrity=<span class="string">&quot;sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH&quot;</span> crossorigin=<span class="string">&quot;anonymous&quot;</span>&gt;    </span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;div <span class="keyword">class</span>=<span class="string">&quot;container&quot;</span>&gt; @* Bootstrap容器布局 *@</span><br><span class="line">        </span><br><span class="line">            &lt;h3&gt;部门列表&lt;/h3&gt; @* 页面标题 *@</span><br><span class="line">        </span><br><span class="line">                @* 检查部门数据是否存在且非空 *@</span><br><span class="line">                @if (Model <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span> &amp;&amp; Model.Count &gt; <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    &lt;table <span class="keyword">class</span>=<span class="string">&quot;table table-striped&quot;</span>&gt; @* 条纹表格样式 *@</span><br><span class="line">                        &lt;thread&gt; @* 表头部分 *@</span><br><span class="line">                            &lt;tr&gt;</span><br><span class="line">                                &lt;th&gt;名称&lt;/th&gt; @* 部门名称列标题 *@</span><br><span class="line">                                &lt;th&gt;描述&lt;/th&gt; @* 部门描述列标题 *@</span><br><span class="line">                                &lt;th&gt;&lt;/th&gt; @* 操作列标题 *@</span><br><span class="line">                            &lt;/tr&gt;</span><br><span class="line">                        &lt;/thread&gt;</span><br><span class="line">                        &lt;tbody&gt; @* 表格内容部分 *@</span><br><span class="line">                            @* 遍历所有部门数据 *@</span><br><span class="line">                            @foreach(<span class="keyword">var</span> department <span class="keyword">in</span> Model)</span><br><span class="line">                            &#123;</span><br><span class="line">                                &lt;tr&gt;</span><br><span class="line">                                    &lt;td&gt;@department.Name&lt;/td&gt; @* 显示部门名称 *@</span><br><span class="line">                                    &lt;td&gt;@department.Description&lt;/td&gt; @* 显示部门描述 *@</span><br><span class="line">                                    &lt;td&gt;</span><br><span class="line">                                        @* 编辑按钮，链接到部门详情页 *@</span><br><span class="line">                                        &lt;a <span class="keyword">class</span>=<span class="string">&quot;btn btn-link&quot;</span> href=<span class="string">&quot;/departments/details/@department.Id&quot;</span>&gt;编辑&lt;/a&gt;</span><br><span class="line">                                    &lt;/td&gt;</span><br><span class="line">                                &lt;/tr&gt;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &lt;/tbody&gt;</span><br><span class="line">                    &lt;/table&gt;</span><br><span class="line">                &#125;             </span><br><span class="line">        </span><br><span class="line">            &lt;br/&gt;</span><br><span class="line">            @* 添加部门按钮 *@</span><br><span class="line">            &lt;a <span class="keyword">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> href=<span class="string">&#x27;/departments/create&#x27;</span>&gt;添加&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/15/NET-ASP-09/image-20250416143148251.png" alt="image-20250416143148251"></p>
<h1 id="5、依赖注入方式"><a href="#5、依赖注入方式" class="headerlink" title="5、依赖注入方式"></a>5、依赖注入方式</h1><p>在 ASP.NET Core 中，依赖注入的实现方式主要分为以下两类，涵盖服务注册与具体注入技术：</p>
<hr>
<h3 id="一、服务注册的实现方式"><a href="#一、服务注册的实现方式" class="headerlink" title="一、服务注册的实现方式"></a>一、<strong>服务注册的实现方式</strong></h3><ol>
<li><p><strong>内置依赖注入容器</strong><br>ASP.NET Core 自带的轻量级容器是默认方案，通过 <code>Startup.cs</code> 或 <code>Program.cs</code> 的 <code>ConfigureServices</code> 方法注册服务，支持三种生命周期（<code>AddTransient</code>、<code>AddScoped</code>、<code>AddSingleton</code>）。开发者无需额外配置即可完成基本依赖管理。</p>
</li>
<li><p><strong>第三方依赖注入库</strong><br>如 Autofac、Ninject 等，提供更高级功能（如属性注入、模块化注册）。例如，Autofac 支持基于条件的注册和复杂的生命周期管理，需通过替换默认容器实现集成。</p>
</li>
<li><p><strong>自定义依赖注入容器</strong><br>继承 <code>ServiceProvider</code> 类并重写方法，适用于需要深度定制容器行为的场景（如特殊实例化逻辑），但开发复杂度较高。</p>
</li>
<li><p><strong>服务定位器模式</strong><br>通过全局 <code>IServiceProvider</code> 手动解析服务（如 <code>GetService&lt;T&gt;()</code>），虽能解决某些特殊需求，但会导致代码耦合，官方明确不推荐使用。</p>
</li>
</ol>
<hr>
<h3 id="二、依赖注入的应用方式"><a href="#二、依赖注入的应用方式" class="headerlink" title="二、依赖注入的应用方式"></a>二、<strong>依赖注入的应用方式</strong></h3><ol>
<li><p><strong>构造函数注入</strong></p>
<p><strong>​推荐方式​</strong>​：在类的构造函数中声明依赖项，容器自动解析并注入。例如，控制器的构造函数接收服务接口参数，实现高可测试性和松耦合 。</p>
<ul>
<li><p>特点：</p>
<ul>
<li><p>显式声明依赖：所有依赖项在对象初始化时即被明确声明，确保类实例的完整性和不可变性。</p>
</li>
<li><p>高可测试性：便于单元测试时通过 Mock 对象替换实际依赖。</p>
</li>
</ul>
</li>
<li><p>应用场景：</p>
<ul>
<li><p>控制器（Controller）：在 MVC 中，控制器的构造函数中注入服务（如数据库上下文、日志服务）。</p>
</li>
<li><p>中间件（Middleware）：中间件类的构造函数中可注入自定义服务。</p>
</li>
<li><p>服务层：业务逻辑层的服务类通过构造函数接收其他服务依赖。</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>示例</strong>：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WeatherForecastController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;WeatherForecastController&gt; _logger;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeatherForecastController</span>(<span class="params">ILogger&lt;WeatherForecastController&gt; logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _logger = logger; <span class="comment">// 依赖注入</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p><strong>属性注入</strong><br>通过属性标记（如 <code>[FromServices]</code>）注入依赖项。ASP.NET Core 原生不支持此方式，需借助第三方库（如 Autofac）或手动在 <code>Startup</code> 中赋值。</p>
<ul>
<li><p>特点：</p>
<ul>
<li>灵活性：允许依赖项在对象初始化后动态注入，适用于可选依赖或复杂对象图。</li>
<li>耦合风险：属性可被修改，可能破坏对象状态一致性。</li>
</ul>
</li>
<li><p>应用场景：</p>
<ul>
<li>扩展框架组件：当无法通过构造函数注入时（如某些框架限制或遗留代码改造）。</li>
<li>动态配置：需要运行时根据条件动态切换依赖实现。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>示例（Autofac 实现）</strong>：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyService</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">Autowired</span>] <span class="comment">// Autofac 特性标记</span></span><br><span class="line">    <span class="keyword">public</span> ILogger Logger &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p><strong>方法注入</strong><br>在方法参数中使用 <code>[FromServices]</code> 特性动态获取服务实例，适用于临时依赖的场景（如中间件或特定业务逻辑方法）。</p>
<ul>
<li><p>特点：</p>
<ul>
<li>按需使用：仅在特定方法中需要依赖时注入，减少类整体耦合。</li>
<li>灵活性：支持在运行时动态解析依赖项。</li>
</ul>
</li>
<li><p>应用场景：</p>
<ul>
<li>中间件的 <code>Invoke/InvokeAsync</code> 方法：处理 HTTP 请求时动态获取服务。</li>
<li>Startup 类的 <code>Configure</code> 方法：注册中间件时直接注入服务。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>示例</strong>：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">IApplicationBuilder app, IWebHostEnvironment env, ILoggerFactory loggerFactory</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 方法参数中注入 env 和 loggerFactory</span></span><br><span class="line">    <span class="keyword">if</span> (env.IsDevelopment()) </span><br><span class="line">    &#123;</span><br><span class="line">        app.UseDeveloperExceptionPage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="三、服务生命周期管理"><a href="#三、服务生命周期管理" class="headerlink" title="三、服务生命周期管理"></a>三、<strong>服务生命周期管理</strong></h3><p>注册服务时需指定生命周期，直接影响实例的创建与共享：</p>
<ul>
<li><p>Transient：每次请求创建新实例，适用于无状态服务（如工具类）。</p>
</li>
<li><p>Scoped：同一请求内共享实例，常见于数据库上下文（如<code>DbContext</code>）。</p>
</li>
<li><p>Singleton：全局单例，适用于配置、缓存等全局共享资源。</p>
</li>
</ul>
<hr>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://alsl521.github.io">kyl</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://alsl521.github.io/2025/04/15/NET-ASP-09/">https://alsl521.github.io/2025/04/15/NET-ASP-09/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://alsl521.github.io" target="_blank">kyl的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C#</a></div><div class="post-share"><div class="social-share" data-image="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/14/NET-ASP-08/" title="ASP.NET学习记录-08-MVC路由"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">ASP.NET学习记录-08-MVC路由</div></div><div class="info-2"><div class="info-item-1">1、什么是controller？为什么用controller？模型-视图-控制器 (MVC) 体系结构模式将应用分成 3 个主要组件：模型 (M)、视图 (V) 和控制器 (C) 。 MVC 模式有助于创建比传统单片应用更易于测试和更新的应用。 基于 MVC 的应用包含：  模型 (M)：是表示应用数据的类。 模型类使用验证逻辑来对该数据强制实施业务规则。 通常，模型对象检索模型状态并将其存储在数据库中。 本教程中，Movie 模型将从数据库中检索电影数据，并将其提供给视图或对其进行更新。 更新后的数据将写入到数据库。 视图 (V)：视图是显示应用用户界面 (UI) 的组件。 此 UI 通常会显示模型数据。 控制器 (C)：具有以下特征的类： 处理浏览器请求。 检索模型数据。 调用返回响应的视图模板。    在 MVC 应用中，视图仅显示信息。 控制器处理用户输入和交互并对其进行响应。 例如，控制器处理 URL 段和查询字符串值，并将这些值传递给模型。 该模型可使用这些值查询数据库。 例如：  https://localhost:5001/Home/Privacy：指定...</div></div></div></a><a class="pagination-related" href="/2025/04/15/Software/" title="记录必备软件"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">记录必备软件</div></div><div class="info-2"><div class="info-item-1">1、PC v2rayN  地址：https://github.com/2dust/v2rayN potplayer（LAV+MAD） 地址：https://potplayer.daum.net/ Bandizip 地址：https://www.bandisoft.com/bandizip/ qbittorrent 地址：https://github.com/c0re100/qBittorrent-Enhanced-Edition Uninstall Tool  2、手机 v2rayNG  地址：https://github.com/2dust/v2rayNG  </div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/04/08/NET-ASP-03/" title="ASP.NET学习记录-03-中间件管道"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-03-中间件管道</div></div><div class="info-2"><div class="info-item-1">1、中间件管道简介在 C# ASP.NET Core 中，中间件管道是处理 HTTP 请求和响应的核心机制，通过将多个中间件按顺序串联成一个处理流程，实现灵活的请求处理和业务逻辑组合。以下是其核心要点：  1. 中间件管道的基本概念 中间件（Middleware）：是管道中的独立组件，负责处理 HTTP 请求和响应。每个中间件可以：  对请求进行预处理（如日志、身份验证）。  调用下一个中间件（通过 next()），或直接终止处理（短路）。  对响应进行后处理（如修改响应头、记录耗时）。      管道（Pipeline）：由多个中间件按注册顺序串联而成，形成一个“请求→处理→响应”的流程。请求按顺序经过所有中间件，而响应则逆序返回  。    2. 管道的工作模式：1-n 然后 n-1 请求阶段（正向传递）：请求从第一个中间件开始，依次传递至最后一个中间件（终结点），形成“1→2→3”的顺序 。  响应阶段（逆向返回）：处理完成后，响应从终结点开始，逆序返回至第一个中间件，形成“3→2→1”的顺序  。 示例 123Middleware One: Request Start...</div></div></div></a><a class="pagination-related" href="/2025/04/08/NET-ASP-01/" title="ASP.NET学习记录-01-基础知识"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-01-基础知识</div></div><div class="info-2"><div class="info-item-1">视频教程为：ASP.NET Core Deep-Dive in .NET 9 | Udemy 1、.NET Core.NET Core 是微软开发的开源、跨平台应用程序开发框架，旨在为现代云原生、微服务及高性能场景提供支持。以下是其核心特性与定位的详细说明：  一、核心定义与定位 跨平台支持 .NET Core 可在 Windows、Linux、macOS 等操作系统上运行，并支持 x86、x64、ARM 等多种架构。 这种跨平台能力使其成为开发云原生、容器化应用（如 Docker）的理想选择。  开源与社区驱动 作为 MIT 协议下的开源项目，.NET Core 的代码托管于 GitHub，接受社区贡献，确保了技术透明度和快速迭代。    二、架构与技术特性 模块化设计 采用包化（Packages）管理，开发者可按需引用组件，减少应用体积，与传统的 .NET Framework 打包式安装形成对比。例如，通过 1dotnet restore  命令可动态还原依赖的 NuGet 包。  高性能运行时  RyuJIT 编译器：相比传统 JIT，性能提升约 25%，支持 SIMD...</div></div></div></a><a class="pagination-related" href="/2025/04/08/NET-ASP-02/" title="ASP.NET学习记录-02-最小API模式"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-02-最小API模式</div></div><div class="info-2"><div class="info-item-1">1、创建第一个ASP.NET应用（Minimal API）1.创建新项目 选择新的空项目  设定基本信息  使用最新版.NET作为学习内容  2.项目架构简介与解析 1. 解决方案（Solution） 名称：MyFirstWebApplication 作用： 作为容器管理多个相关项目（当前仅包含一个项目 WebApplication）。 支持团队协作和复杂应用的模块化开发（如Web API、类库、单元测试等）。   关键点： 可通过解决方案配置统一管理所有项目的依赖和环境设置。   新增项目 右键单击解决方案-&gt;添加-&gt;新建项目      2. 项目（Project: WebApplication） 核心结构：包含构建和运行Web应用所需的所有文件与配置，分为以下关键部分：  a. Connected Services 文件夹 作用： 存储与外部服务的连接配置（如数据库、Azure服务、第三方API）。 通过右键添加服务（如Entity Framework、Azure认证），自动生成连接配置文件。   示例：添加Azure...</div></div></div></a><a class="pagination-related" href="/2025/04/10/NET-ASP-04/" title="ASP.NET学习记录-03-路由"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-10</div><div class="info-item-2">ASP.NET学习记录-03-路由</div></div><div class="info-2"><div class="info-item-1">1、Routing和Endpoints简介在ASP.NET Core中，**路由（Routing）和终结点（Endpoints）**是处理HTTP请求的核心机制，它们共同构成了请求分发的管道系统。以下是对两者的详细介绍：  一、路由（Routing）路由的核心作用是将传入的HTTP请求根据URL路径和HTTP方法匹配到对应的处理逻辑（终结点）。在ASP.NET Core中，路由系统被称为终结点路由（Endpoint Routing）。 主要功能与工作流程 匹配请求：通过UseRouting中间件（即EndpointRoutingMiddleware）扫描应用中所有注册的终结点，根据请求的URL和HTTP方法选择最匹配的终结点 。示例代码：  12345app.UseRouting();app.UseEndpoints(endpoints =&gt; &#123;    endpoints.MapGet(&quot;/&quot;, async context =&gt; &#123; ......</div></div></div></a><a class="pagination-related" href="/2025/04/11/NET-ASP-05/" title="ASP.NET学习记录-05-模型数据绑定"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-11</div><div class="info-item-2">ASP.NET学习记录-05-模型数据绑定</div></div><div class="info-2"><div class="info-item-1">1、模型绑定定义模型绑定是ASP.NET Core中将HTTP请求数据自动映射到方法参数或对象属性的机制。其核心工作流程：  数据来源：  路由参数（URL片段） 查询字符串（?key&#x3D;value） 请求体（表单&#x2F;JSON&#x2F;XML） 请求头 文件上传   典型应用：   12345678910111213// 自动绑定路由参数和查询参数[HttpGet(&quot;/products/&#123;id&#125;&quot;)]public IActionResult GetProduct(int id, [FromQuery] string category) &#123;    // id来自路由参数，category来自查询字符串&#125;// 自动绑定JSON请求体[HttpPost]public IActionResult Create([FromBody] Product product)&#123;    //...</div></div></div></a><a class="pagination-related" href="/2025/04/18/NET-ASP-11/" title="ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-18</div><div class="info-item-2">ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API</div></div><div class="info-2"><div class="info-item-1">1、初始化项目本实践将创建以下 API：     API 说明 请求正文 响应正文    GET /api/todoitems 获取所有待办事项 无 待办事项的数组   GET /api/todoitems/&#123;id&#125; 按 ID 获取项 无 待办事项   POST /api/todoitems 添加新项 待办事项 待办事项   PUT /api/todoitems/&#123;id&#125; 更新现有项 待办事项 无   DELETE /api/todoitems/&#123;id&#125; 删除项 无 无   1.初始化项目首先要确保安装必备的相关内容，即ASP.NET和Web开发。  在此基础上，创建项目：  首先选择合理的项目模板   随后选择并输入名称，具体内容随意   依据需求选择，本次不使用HTTPS，随后创建项目。    2.项目内容介绍：  该项目是一个典型的 ASP.NET Core Web 应用项目，采用标准的 MVC（模型-视图-控制器）分层架构。  1. 项目整体架构 分层逻辑： 控制器（Controllers）：处理 HTTP...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">kyl</div><div class="author-info-description">用于记录平时学习的博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">66</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">23</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/alsl521" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:852970167@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E3%80%81MVC-Pattern"><span class="toc-number">1.</span> <span class="toc-text">1、MVC Pattern</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-MVC%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="toc-number">1.0.1.</span> <span class="toc-text">1. MVC的核心组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MVC%E5%9C%A8ASP-NET%E4%B8%AD%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">1.0.2.</span> <span class="toc-text">2. MVC在ASP.NET中的优势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%B8%8E%E4%BC%A0%E7%BB%9FASP-NET-Web-Forms%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-number">1.0.3.</span> <span class="toc-text">3. 与传统ASP.NET Web Forms的对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.0.4.</span> <span class="toc-text">4. 实际应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.0.5.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%E3%80%81Razor"><span class="toc-number">2.</span> <span class="toc-text">2、Razor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Razor%E7%9A%84%E6%A0%B8%E5%BF%83%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5"><span class="toc-number">2.0.1.</span> <span class="toc-text">1. Razor的核心设计理念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Razor%E8%AF%AD%E6%B3%95%E7%9A%84%E4%B8%BB%E8%A6%81%E7%89%B9%E6%80%A7"><span class="toc-number">2.0.2.</span> <span class="toc-text">2. Razor语法的主要特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Razor%E5%9C%A8ASP-NET%E6%8A%80%E6%9C%AF%E6%A0%88%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">2.0.3.</span> <span class="toc-text">3. Razor在ASP.NET技术栈中的应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Razor%E7%9A%84%E4%BC%98%E5%8A%BF%E4%B8%8E%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.0.4.</span> <span class="toc-text">4. Razor的优势与适用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">2.0.5.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%E3%80%81%E4%B8%BB%E9%A1%B5%E9%9D%A2%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">3、主页面实现</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4%E3%80%81Department%E7%9B%B8%E5%85%B3%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.</span> <span class="toc-text">4、Department相关实现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Department"><span class="toc-number">4.1.</span> <span class="toc-text">1.Department</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-DepartmentsRepository"><span class="toc-number">4.2.</span> <span class="toc-text">2.DepartmentsRepository</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-DepartmentsController"><span class="toc-number">4.3.</span> <span class="toc-text">3.DepartmentsController</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Create"><span class="toc-number">4.4.</span> <span class="toc-text">4.Create</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Details"><span class="toc-number">4.5.</span> <span class="toc-text">5.Details</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Error"><span class="toc-number">4.6.</span> <span class="toc-text">6.Error</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Index"><span class="toc-number">4.7.</span> <span class="toc-text">7.Index</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5%E3%80%81%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">5.</span> <span class="toc-text">5、依赖注入方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="toc-number">5.0.1.</span> <span class="toc-text">一、服务注册的实现方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%9A%84%E5%BA%94%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">5.0.2.</span> <span class="toc-text">二、依赖注入的应用方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%9C%8D%E5%8A%A1%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%AE%A1%E7%90%86"><span class="toc-number">5.0.3.</span> <span class="toc-text">三、服务生命周期管理</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/21/NET-ASP-13/" title="ASP.NET学习记录-13-实践2-数据库进阶">ASP.NET学习记录-13-实践2-数据库进阶</a><time datetime="2025-04-21T08:39:19.000Z" title="发表于 2025-04-21 16:39:19">2025-04-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/18/NET-ASP-12/" title="ASP.NET学习记录-12-实践2-使用MySQL数据库">ASP.NET学习记录-12-实践2-使用MySQL数据库</a><time datetime="2025-04-18T08:11:21.000Z" title="发表于 2025-04-18 16:11:21">2025-04-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/18/NET-ASP-11/" title="ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API">ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API</a><time datetime="2025-04-18T02:13:44.000Z" title="发表于 2025-04-18 10:13:44">2025-04-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/16/NET-ASP-10/" title="ASP.NET学习记录-10-过滤">ASP.NET学习记录-10-过滤</a><time datetime="2025-04-16T12:02:16.000Z" title="发表于 2025-04-16 20:02:16">2025-04-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/15/Software/" title="记录必备软件">记录必备软件</a><time datetime="2025-04-15T11:29:21.000Z" title="发表于 2025-04-15 19:29:21">2025-04-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By kyl</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>