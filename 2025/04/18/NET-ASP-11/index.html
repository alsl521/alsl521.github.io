<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API | kyl的博客</title><meta name="author" content="kyl"><meta name="copyright" content="kyl"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:type" content="article">
<meta property="og:title" content="ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API">
<meta property="og:url" content="https://alsl521.github.io/2025/04/18/NET-ASP-11/index.html">
<meta property="og:site_name" content="kyl的博客">
<meta property="og:description" content="C# .NET ASP.NET Core 基础入门 简单学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4">
<meta property="article:published_time" content="2025-04-18T02:13:44.000Z">
<meta property="article:modified_time" content="2025-04-19T05:29:10.966Z">
<meta property="article:author" content="kyl">
<meta property="article:tag" content="C#">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API",
  "url": "https://alsl521.github.io/2025/04/18/NET-ASP-11/",
  "image": "https://avatars.githubusercontent.com/u/61216968?s=400&u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&v=4",
  "datePublished": "2025-04-18T02:13:44.000Z",
  "dateModified": "2025-04-19T05:29:10.966Z",
  "author": [
    {
      "@type": "Person",
      "name": "kyl",
      "url": "https://alsl521.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://alsl521.github.io/2025/04/18/NET-ASP-11/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">kyl的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">ASP.NET学习记录-11-实践1-使用 ASP.NET Core 生成基于控制器的 Web API</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-18T02:13:44.000Z" title="发表于 2025-04-18 10:13:44">2025-04-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-19T05:29:10.966Z" title="更新于 2025-04-19 13:29:10">2025-04-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/">C#</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/ASP/">ASP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="1、初始化项目"><a href="#1、初始化项目" class="headerlink" title="1、初始化项目"></a>1、初始化项目</h1><p>本实践将创建以下 API：</p>
<p><img src="/2025/04/18/NET-ASP-11/architecture.png"></p>
<table>
<thead>
<tr>
<th align="left">API</th>
<th align="left">说明</th>
<th align="left">请求正文</th>
<th align="left">响应正文</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>GET /api/todoitems</code></td>
<td align="left">获取所有待办事项</td>
<td align="left">无</td>
<td align="left">待办事项的数组</td>
</tr>
<tr>
<td align="left"><code>GET /api/todoitems/&#123;id&#125;</code></td>
<td align="left">按 ID 获取项</td>
<td align="left">无</td>
<td align="left">待办事项</td>
</tr>
<tr>
<td align="left"><code>POST /api/todoitems</code></td>
<td align="left">添加新项</td>
<td align="left">待办事项</td>
<td align="left">待办事项</td>
</tr>
<tr>
<td align="left"><code>PUT /api/todoitems/&#123;id&#125;</code></td>
<td align="left">更新现有项</td>
<td align="left">待办事项</td>
<td align="left">无</td>
</tr>
<tr>
<td align="left"><code>DELETE /api/todoitems/&#123;id&#125;</code></td>
<td align="left">删除项</td>
<td align="left">无</td>
<td align="left">无</td>
</tr>
</tbody></table>
<h2 id="1-初始化项目"><a href="#1-初始化项目" class="headerlink" title="1.初始化项目"></a>1.初始化项目</h2><p>首先要确保安装必备的相关内容，即<code>ASP.NET和Web开发</code>。</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418104041815.png" alt="image-20250418104041815"></p>
<p>在此基础上，创建项目：</p>
<ol>
<li><p>首先选择合理的项目模板</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418104117800.png" alt="image-20250418104117800"><img src="/2025/04/18/NET-ASP-11/image-20250418104146066.png" alt="image-20250418104146066"></p>
</li>
<li><p>随后选择并输入名称，具体内容随意</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418104325021.png" alt="image-20250418104325021"></p>
</li>
<li><p>依据需求选择，本次不使用<code>HTTPS</code>，随后创建项目。</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418104510305.png" alt="image-20250418104510305"></p>
</li>
</ol>
<h2 id="2-项目内容介绍："><a href="#2-项目内容介绍：" class="headerlink" title="2.项目内容介绍："></a>2.项目内容介绍：</h2><p> <img src="/2025/04/18/NET-ASP-11/image-20250418104719181.png" alt="image-20250418104719181"></p>
<p>该项目是一个典型的 ASP.NET Core Web 应用项目，采用标准的 MVC（模型-视图-控制器）分层架构。</p>
<hr>
<h3 id="1-项目整体架构"><a href="#1-项目整体架构" class="headerlink" title="1. 项目整体架构"></a><strong>1. 项目整体架构</strong></h3><ul>
<li>分层逻辑：<ul>
<li><strong>控制器（Controllers）</strong>：处理 HTTP 请求，协调业务逻辑与视图&#x2F;数据返回。</li>
<li><strong>模型（Models）</strong>：定义数据结构（如 <code>WeatherForecast.cs</code>），用于数据传输与业务处理。</li>
<li><strong>配置与入口（Program.cs &#x2F; appsettings.json）</strong>：全局配置与启动流程。</li>
<li><strong>依赖管理（Dependencies）</strong>：管理第三方库与框架依赖。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-关键文件与文件夹说明"><a href="#2-关键文件与文件夹说明" class="headerlink" title="2. 关键文件与文件夹说明"></a><strong>2. 关键文件与文件夹说明</strong></h3><h4 id="1-WebApp（项目根目录）"><a href="#1-WebApp（项目根目录）" class="headerlink" title="**(1) **WebApp（项目根目录）"></a>**(1) **<code>WebApp</code>（项目根目录）</h4><ul>
<li><strong>作用</strong>：项目主体代码存放位置，包含应用核心逻辑和配置。</li>
</ul>
<h4 id="2-Connected-Services"><a href="#2-Connected-Services" class="headerlink" title="**(2) **Connected Services"></a>**(2) **<code>Connected Services</code></h4><ul>
<li><strong>作用</strong>：管理与外部服务的连接配置（如 Azure 服务、数据库连接）</li>
</ul>
<h4 id="3-Properties-与-launchSettings-json"><a href="#3-Properties-与-launchSettings-json" class="headerlink" title="**(3) **Properties 与 launchSettings.json"></a>**(3) **<code>Properties</code> 与 <code>launchSettings.json</code></h4><ul>
<li><p><code>launchSettings.json</code>：</p>
<ul>
<li><p><strong>作用</strong>：定义应用的启动配置（如开发环境变量、启动 URL、端口号）。</p>
</li>
<li><p>示例配置项</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;profiles&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;WebApp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;commandName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Project&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;launchBrowser&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;applicationUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://localhost:5001;http://localhost:5000&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;environmentVariables&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;ASPNETCORE_ENVIRONMENT&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Development&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="4-Dependencies"><a href="#4-Dependencies" class="headerlink" title="**(4) **Dependencies"></a>**(4) **<code>Dependencies</code></h4><ul>
<li>作用：管理项目依赖项，包括：<ul>
<li><strong>NuGet 包</strong>：第三方库（如 Entity Framework Core、Swagger）。</li>
<li><strong>分析器（Analyzers）</strong>：静态代码分析工具，帮助检测潜在代码问题。</li>
<li><strong>框架（Frameworks）</strong>：.NET Core SDK 和运行时依赖。</li>
</ul>
</li>
</ul>
<h4 id="5-Controllers-WeatherForecastController-cs"><a href="#5-Controllers-WeatherForecastController-cs" class="headerlink" title="**(5) **Controllers/WeatherForecastController.cs"></a>**(5) **<code>Controllers/WeatherForecastController.cs</code></h4><ul>
<li><p><strong>作用</strong>：控制器类，处理 <code>/WeatherForecast</code> 相关的 HTTP 请求（如 GET&#x2F;POST）。</p>
</li>
<li><p>典型代码逻辑：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WeatherForecastController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IEnumerable&lt;WeatherForecast&gt; <span class="title">Get</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 生成天气数据并返回</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="6-appsettings-json"><a href="#6-appsettings-json" class="headerlink" title="**(6) **appsettings.json"></a>**(6) **<code>appsettings.json</code></h4><ul>
<li><p><strong>作用</strong>：存储应用配置（如数据库连接字符串、日志级别、自定义参数）。</p>
</li>
<li><p>示例配置：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Logging&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;LogLevel&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Information&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Microsoft.AspNetCore&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Warning&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;AllowedHosts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="7-Program-cs"><a href="#7-Program-cs" class="headerlink" title="**(7) **Program.cs"></a>**(7) **<code>Program.cs</code></h4><ul>
<li><p><strong>作用</strong>：程序入口，配置主机（Host）、服务容器（DI）、中间件管道。</p>
</li>
<li><p>核心代码流程：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line">builder.Services.AddControllers(); <span class="comment">// 注册控制器</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line">app.UseHttpsRedirection();</span><br><span class="line">app.MapControllers(); <span class="comment">// 路由映射</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="8-WeatherForecast-cs"><a href="#8-WeatherForecast-cs" class="headerlink" title="**(8) **WeatherForecast.cs"></a>**(8) **<code>WeatherForecast.cs</code></h4><ul>
<li><p><strong>作用</strong>：数据模型类，定义天气预测数据的结构（如日期、温度）。</p>
</li>
<li><p>示例代码：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WeatherForecast</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> DateTime Date &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> TemperatureC &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? Summary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="9-WebApp-http"><a href="#9-WebApp-http" class="headerlink" title="**(9) **WebApp.http"></a>**(9) **<code>WebApp.http</code></h4><ul>
<li><p><strong>作用</strong>：HTTP 请求测试文件（类似 Postman 的快捷脚本），用于快速调试 API 接口。</p>
</li>
<li><p>示例请求：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET https://localhost:5001/WeatherForecast</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="3-协作流程示例"><a href="#3-协作流程示例" class="headerlink" title="3. 协作流程示例"></a><strong>3. 协作流程示例</strong></h3><ol>
<li><strong>启动应用</strong>：根据 <code>launchSettings.json</code> 配置启动环境与端口。</li>
<li><strong>加载配置</strong>：<code>Program.cs</code> 读取 <code>appsettings.json</code>，初始化服务容器。</li>
<li><strong>处理请求</strong>：用户访问 <code>/WeatherForecast</code>，<code>WeatherForecastController</code> 生成数据并返回 JSON。</li>
<li><strong>依赖管理</strong>：通过 <code>Dependencies</code> 中的包支持数据库操作或日志记录。</li>
</ol>
<h2 id="4-具体代码解析"><a href="#4-具体代码解析" class="headerlink" title="4.具体代码解析"></a>4.具体代码解析</h2><h3 id="1-WeatherForecast-cs"><a href="#1-WeatherForecast-cs" class="headerlink" title="1.WeatherForecast.cs"></a>1.WeatherForecast.cs</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 天气预报类，用于存储和处理天气预报数据</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WeatherForecast</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置天气预报的日期</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DateOnly Date &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置摄氏温度值</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> TemperatureC &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取华氏温度值，根据摄氏温度自动计算</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 公式: F = 32 + (C / 0.5556)</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> TemperatureF =&gt; <span class="number">32</span> + (<span class="built_in">int</span>)(TemperatureC / <span class="number">0.5556</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置天气概述描述</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Summary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-WeatherForecastController-cs"><a href="#2-WeatherForecastController-cs" class="headerlink" title="2.WeatherForecastController.cs"></a>2.WeatherForecastController.cs</h3><p>Controllers\WeatherForecastController.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 天气预报控制器，提供天气预报数据的API端点</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WeatherForecastController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 天气状况描述的静态数组</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span>[] Summaries = <span class="keyword">new</span>[]</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;Freezing&quot;</span>, <span class="string">&quot;Bracing&quot;</span>, <span class="string">&quot;Chilly&quot;</span>, <span class="string">&quot;Cool&quot;</span>, <span class="string">&quot;Mild&quot;</span>, <span class="string">&quot;Warm&quot;</span>, <span class="string">&quot;Balmy&quot;</span>, <span class="string">&quot;Hot&quot;</span>, <span class="string">&quot;Sweltering&quot;</span>, <span class="string">&quot;Scorching&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 日志记录器实例</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;WeatherForecastController&gt; _logger;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 构造函数，通过依赖注入接收日志记录器</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;logger&quot;&gt;</span>注入的日志记录器实例<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">WeatherForecastController</span>(<span class="params">ILogger&lt;WeatherForecastController&gt; logger</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _logger = logger;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取天气预报数据的GET方法</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回5天的随机天气预报数据集合<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpGet(Name = <span class="string">&quot;GetWeatherForecast&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> IEnumerable&lt;WeatherForecast&gt; <span class="title">Get</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Enumerable.Range(<span class="number">1</span>, <span class="number">5</span>).Select(index =&gt; <span class="keyword">new</span> WeatherForecast</span><br><span class="line">            &#123;</span><br><span class="line">                Date = DateOnly.FromDateTime(DateTime.Now.AddDays(index)),  <span class="comment">// 设置未来日期</span></span><br><span class="line">                TemperatureC = Random.Shared.Next(<span class="number">-20</span>, <span class="number">55</span>),                 <span class="comment">// 生成随机温度(-20°C到55°C)</span></span><br><span class="line">                Summary = Summaries[Random.Shared.Next(Summaries.Length)]   <span class="comment">// 随机选择天气描述</span></span><br><span class="line">            &#125;)</span><br><span class="line">            .ToArray();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-Program-cs"><a href="#3-Program-cs" class="headerlink" title="3.Program.cs"></a>3.Program.cs</h3><p>Program.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建Web应用程序构建器，用于配置应用程序的服务和中间件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向依赖注入容器添加服务</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加MVC控制器服务，使应用程序能够处理API控制器</span></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line"><span class="comment">// 添加API浏览器服务，用于生成OpenAPI规范</span></span><br><span class="line"><span class="comment">// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle</span></span><br><span class="line">builder.Services.AddEndpointsApiExplorer();</span><br><span class="line"><span class="comment">// 添加Swagger生成器服务，用于生成Swagger UI和Swagger JSON端点</span></span><br><span class="line">builder.Services.AddSwaggerGen();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建应用程序实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置HTTP请求处理管道</span></span><br><span class="line"><span class="comment">// 检查应用程序是否在开发环境中运行</span></span><br><span class="line"><span class="keyword">if</span> (app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 启用Swagger中间件，生成JSON端点</span></span><br><span class="line">    app.UseSwagger();</span><br><span class="line">    <span class="comment">// 启用SwaggerUI中间件，提供Web UI以浏览API</span></span><br><span class="line">    app.UseSwaggerUI();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加授权中间件，处理身份验证和授权</span></span><br><span class="line">app.UseAuthorization();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加路由中间件，将请求映射到控制器操作方法</span></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动应用程序并等待请求</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/18/NET-ASP-11/image-20250418110608788.png" alt="image-20250418110608788"></p>
<p>将项目按照SpringBoot的模板进行文件内容重构，以适应架构内容。</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418111629762.png" alt="image-20250418111629762"></p>
<blockquote>
<p>1.<strong>VO（View Object）视图对象</strong></p>
<p>用于展示层（如Web或移动端界面），根据前端需求聚合或格式化数据。例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserVO</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String displayName;</span><br><span class="line">    <span class="keyword">private</span> String formattedEmail;  <span class="comment">// 例如&quot;xxx@xxx.com&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>VO的字段可能与数据库字段不完全一致，且可能包含界面特有的逻辑（如日期格式化）</p>
<p>2.<strong>DTO（Data Transfer Object）数据传输对象</strong></p>
<p>用于跨层（如服务层与控制器层）或跨服务（如微服务调用）传输数据，通常用于减少网络传输量或隐藏敏感字段。例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDTO</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String email;  <span class="comment">// 不暴露密码字段</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>DTO的设计注重网络效率和安全性</p>
</blockquote>
<h1 id="2、新建模型类"><a href="#2、新建模型类" class="headerlink" title="2、新建模型类"></a>2、新建模型类</h1><ul>
<li>在“解决方案资源管理器”中，右键单击项目。 选择<strong>添加</strong>&gt;<strong>新建文件夹</strong>。 将该文件夹命名为 <code>Models</code>。</li>
<li>右键单击文件夹，然后选择<strong>添加</strong>&gt;<strong>类</strong>。 将类命名为<code>TodoItem</code>，然后选择“添加”。</li>
</ul>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418112015950.png" alt="image-20250418112015950"></p>
<p>Pojo\DTO\TodoItem.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Pojo.DTO</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 表示待办事项的数据传输对象（DTO）</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItem</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项的唯一标识符</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项的名称</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 可以为 null</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项是否已完成的标志</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> IsComplete &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3、添加数据库上下文"><a href="#3、添加数据库上下文" class="headerlink" title="3、添加数据库上下文"></a>3、添加数据库上下文</h1><p>数据库上下文是为数据模型协调 Entity Framework 功能的主类。 此类由 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/microsoft.entityframeworkcore.dbcontext">Microsoft.EntityFrameworkCore.DbContext</a> 类派生而来。因此需要先安装<code>Microsoft.EntityFrameworkCore.DbContext</code>NuGet包。</p>
<ul>
<li>右键单击文件夹，然后选择<strong>添加</strong>&gt;<strong>类</strong>。 将类命名为 TodoContext，然后单击“添加”。</li>
</ul>
<p>Mapper\TodoContext.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.EntityFrameworkCore;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.DTO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Mapper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 数据库上下文类，用于管理与数据库的连接及 TodoItem 实体的数据操作</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 继承自 EntityFrameworkCore 的 DbContext 类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoContext</span> : <span class="title">DbContext</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 构造函数，接收数据库上下文配置选项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;options&quot;&gt;</span>数据库上下文配置选项<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TodoContext</span>(<span class="params">DbContextOptions&lt;TodoContext&gt; options</span>) : <span class="title">base</span>(<span class="params">options</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> TodoItem 实体的数据库集合，用于对 TodoItem 表进行查询和操作</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 通过 DbSet 可以进行增删改查等数据库操作</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 标记为 null! 表示该属性在构造后不会为 null</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;TodoItem&gt; TodoItems &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="literal">null</span>!;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4、注册数据库上下文"><a href="#4、注册数据库上下文" class="headerlink" title="4、注册数据库上下文"></a>4、注册数据库上下文</h1><p>在 ASP.NET Core 中，服务（如数据库上下文）必须向<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-8.0">依赖关系注入 (DI)</a> 容器进行注册。 该容器向控制器提供服务。在使用之前，需要安装<code>Microsoft.EntityFrameworkCore.InMemory</code>。</p>
<p>Program.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入所需的命名空间</span></span><br><span class="line"><span class="keyword">using</span> Microsoft.EntityFrameworkCore;</span><br><span class="line"><span class="keyword">using</span> WebApp.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建Web应用程序构建器实例，用于配置应用程序</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向依赖注入容器添加服务</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加MVC控制器服务，使应用程序能够处理API请求</span></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册TodoContext数据库上下文，配置为使用内存数据库</span></span><br><span class="line"><span class="comment">// 名为&quot;TodoList&quot;的内存数据库将用于存储待办事项数据</span></span><br><span class="line">builder.Services.AddDbContext&lt;TodoContext&gt;(opt =&gt;</span><br><span class="line">    opt.UseInMemoryDatabase(<span class="string">&quot;TodoList&quot;</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"><span class="comment">// Swagger/OpenAPI配置，用于API文档和测试</span></span><br><span class="line"><span class="comment">// 更多信息可参考：https://aka.ms/aspnetcore/swashbuckle</span></span><br><span class="line">builder.Services.AddEndpointsApiExplorer();  <span class="comment">// 添加API端点探索服务</span></span><br><span class="line">builder.Services.AddSwaggerGen();            <span class="comment">// 添加Swagger文档生成服务</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建Web应用程序实例</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置HTTP请求处理管道</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果应用程序运行在开发环境中，启用Swagger文档和UI</span></span><br><span class="line"><span class="keyword">if</span> (app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    app.UseSwagger();      <span class="comment">// 启用Swagger文档生成</span></span><br><span class="line">    app.UseSwaggerUI();    <span class="comment">// 启用Swagger UI界面</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启用授权中间件，处理授权相关逻辑</span></span><br><span class="line">app.UseAuthorization();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加控制器路由映射，将HTTP请求映射到相应的控制器</span></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动应用程序，开始监听HTTP请求</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<h1 id="5、构建控制器"><a href="#5、构建控制器" class="headerlink" title="5、构建控制器"></a>5、构建控制器</h1><ul>
<li><p>右键单击 <code>Controllers</code> 文件夹。</p>
</li>
<li><p>选择<strong>添加</strong>&gt;<strong>New Scaffolded Item</strong>。</p>
</li>
<li><p>选择“其操作使用实体框架的 API 控制器”，然后选择“添加”。</p>
</li>
<li><p>在“添加其操作使用实体框架的 API 控制器”对话框中：</p>
<ul>
<li><p>在“模型类”中选择“TodoItem (TodoApi.Models)”。</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418143558304.png" alt="image-20250418143558304"></p>
</li>
<li><p>在“数据上下文类”中选择“TodoContext (TodoAPI.Models)”。</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418143709704.png" alt="image-20250418143709704"></p>
</li>
<li><p>选择“添加”，会自动下载安装所需内容，并且会自动生成一系列代码。</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418144058489.png" alt="image-20250418144058489"></p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418144143223.png" alt="image-20250418144143223"></p>
</li>
</ul>
</li>
</ul>
<p>Controllers\TodoItemsController.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Http;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> Microsoft.EntityFrameworkCore;</span><br><span class="line"><span class="keyword">using</span> WebApp.Mapper;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.DTO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项控制器，提供待办事项的CRUD API接口</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;api/[controller]&quot;</span>)</span>]  <span class="comment">// 定义API路由为 &quot;api/TodoItems&quot;</span></span><br><span class="line">    [<span class="meta">ApiController</span>]              <span class="comment">// 标识此类为API控制器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemsController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 数据库上下文实例，用于操作待办事项数据</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> TodoContext _context;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 构造函数，通过依赖注入接收数据库上下文</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;context&quot;&gt;</span>待办事项数据库上下文<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TodoItemsController</span>(<span class="params">TodoContext context</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _context = context;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取所有待办事项列表</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>待办事项集合<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment">// GET: api/TodoItems</span></span><br><span class="line">        [<span class="meta">HttpGet</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;IEnumerable&lt;TodoItem&gt;&gt;&gt; GetTodoItems()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> _context.TodoItems.ToListAsync();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 根据ID获取单个待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>指定ID的待办事项，若不存在则返回404<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment">// GET: api/TodoItems/5</span></span><br><span class="line">        [<span class="meta">HttpGet(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;TodoItem&gt;&gt; GetTodoItem(<span class="built_in">long</span> id)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> todoItem = <span class="keyword">await</span> _context.TodoItems.FindAsync(id);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> NotFound();  <span class="comment">// 返回404状态码，表示资源未找到</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> todoItem;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItem&quot;&gt;</span>待更新的待办事项对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>更新结果：成功返回204，失败返回400或404<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment">// PUT: api/TodoItems/5</span></span><br><span class="line">        <span class="comment">// To protect from overposting attacks, see https://go.microsoft.com/fwlink/?linkid=2123754</span></span><br><span class="line">        [<span class="meta">HttpPut(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">PutTodoItem</span>(<span class="params"><span class="built_in">long</span> id, TodoItem todoItem</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (id != todoItem.Id)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> BadRequest();  <span class="comment">// 返回400状态码，表示请求参数错误</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将实体状态标记为已修改</span></span><br><span class="line">            _context.Entry(todoItem).State = EntityState.Modified;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 保存更改到数据库</span></span><br><span class="line">                <span class="keyword">await</span> _context.SaveChangesAsync();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (DbUpdateConcurrencyException)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 处理并发冲突异常</span></span><br><span class="line">                <span class="keyword">if</span> (!TodoItemExists(id))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> NotFound();  <span class="comment">// 返回404状态码，表示资源未找到</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">throw</span>;  <span class="comment">// 重新抛出异常</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> NoContent();  <span class="comment">// 返回204状态码，表示成功但无返回内容</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 创建新的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItem&quot;&gt;</span>新的待办事项对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>创建的待办事项及其资源位置<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment">// POST: api/TodoItems</span></span><br><span class="line">        <span class="comment">// To protect from overposting attacks, see https://go.microsoft.com/fwlink/?linkid=2123754</span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;TodoItem&gt;&gt; PostTodoItem(TodoItem todoItem)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 添加待办事项到数据库</span></span><br><span class="line">            _context.TodoItems.Add(todoItem);</span><br><span class="line">            <span class="keyword">await</span> _context.SaveChangesAsync();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回201状态码，表示资源已创建，并在响应头中包含新资源的URL</span></span><br><span class="line">            <span class="keyword">return</span> CreatedAtAction(<span class="string">&quot;GetTodoItem&quot;</span>, <span class="keyword">new</span> &#123; id = todoItem.Id &#125;, todoItem);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 删除指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待删除的待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>删除结果：成功返回204，未找到返回404<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment">// DELETE: api/TodoItems/5</span></span><br><span class="line">        [<span class="meta">HttpDelete(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">DeleteTodoItem</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> todoItem = <span class="keyword">await</span> _context.TodoItems.FindAsync(id);</span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> NotFound();  <span class="comment">// 返回404状态码，表示资源未找到</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 从数据库中移除待办事项</span></span><br><span class="line">            _context.TodoItems.Remove(todoItem);</span><br><span class="line">            <span class="keyword">await</span> _context.SaveChangesAsync();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> NoContent();  <span class="comment">// 返回204状态码，表示成功但无返回内容</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 检查指定ID的待办事项是否存在</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待检查的待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>如果存在返回true，否则返回false<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">bool</span> <span class="title">TodoItemExists</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> _context.TodoItems.Any(e =&gt; e.Id == id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>生成的代码：</p>
<ul>
<li>使用 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/microsoft.aspnetcore.mvc.apicontrollerattribute"><code>[ApiController]</code></a> 属性标记类。 此属性指示控制器响应 Web API 请求。 有关该属性启用的特定行为的信息，请参阅<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/aspnet/core/web-api/?view=aspnetcore-8.0">使用 ASP.NET Core 创建 Web API</a>。</li>
<li>使用 DI 将数据库上下文 (<code>TodoContext</code>) 注入到控制器中。 数据库上下文将在控制器中的每个 <a target="_blank" rel="noopener" href="https://wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> 方法中使用。</li>
</ul>
<p>ASP.NET Core 模板：</p>
<ul>
<li>具有视图的控制器在路由模板中包含 <code>[action]</code>。</li>
<li>API 控制器不在路由模板中包含 <code>[action]</code>。</li>
</ul>
<p><code>[action]</code> 令牌不在路由模板中时，终结点中不包含 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/aspnet/core/mvc/controllers/routing?view=aspnetcore-8.0#action">action</a> 名称（方法名称）。 也就是说，不会在匹配的路由中使用操作的关联方法名称。</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418145615297.png" alt="image-20250418145615297"></p>
<blockquote>
<h3 id="ASP-NET-Core-中-MVC-控制器与-API-控制器的路由设计差异解析"><a href="#ASP-NET-Core-中-MVC-控制器与-API-控制器的路由设计差异解析" class="headerlink" title="ASP.NET Core 中 MVC 控制器与 API 控制器的路由设计差异解析"></a>ASP.NET Core 中 MVC 控制器与 API 控制器的路由设计差异解析</h3><p>在 ASP.NET Core 中，<strong>带有视图的控制器（传统 MVC）</strong> 和 <strong>API 控制器（Web API）</strong> 的路由模板设计存在显著差异，主要体现在是否包含 <code>[action]</code> 占位符。这种差异源于两者不同的应用场景和设计目标。以下从 <strong>设计原则</strong>、<strong>路由配置</strong> 和 <strong>实际影响</strong> 三方面详细解释：</p>
<hr>
<h3 id="1-设计原则与目标"><a href="#1-设计原则与目标" class="headerlink" title="1. 设计原则与目标"></a><strong>1. 设计原则与目标</strong></h3><table>
<thead>
<tr>
<th align="center"><strong>类型</strong></th>
<th align="center"><strong>核心目标</strong></th>
<th align="center"><strong>路由设计导向</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>MVC 控制器</strong></td>
<td align="center">渲染视图页面，支持用户交互（如表单提交、页面跳转）</td>
<td align="center">明确区分不同 Action 对应的视图路径</td>
</tr>
<tr>
<td align="center"><strong>API 控制器</strong></td>
<td align="center">提供数据接口，遵循 RESTful 规范（资源化操作）</td>
<td align="center">通过 HTTP 方法区分操作，隐藏 Action 名</td>
</tr>
</tbody></table>
<hr>
<h3 id="2-路由模板对比"><a href="#2-路由模板对比" class="headerlink" title="2. 路由模板对比"></a><strong>2. 路由模板对比</strong></h3><h4 id="1-传统-MVC-控制器（包含-action-）"><a href="#1-传统-MVC-控制器（包含-action-）" class="headerlink" title="(1) 传统 MVC 控制器（包含 [action]）"></a><strong>(1) 传统 MVC 控制器（包含 <code>[action]</code>）</strong></h4><ul>
<li><p><strong>默认路由模板</strong>：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.MapControllerRoute(</span><br><span class="line">    name: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">    pattern: <span class="string">&quot;&#123;controller=Home&#125;/&#123;action=Index&#125;/&#123;id?&#125;&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>URL 示例</strong>：</p>
<ul>
<li><code>/Home/Index</code> → <code>HomeController.Index()</code></li>
<li><code>/Product/Details/5</code> → <code>ProductController.Details(int id)</code></li>
</ul>
</li>
<li><p><strong>必要性</strong>：</p>
<ul>
<li>每个 Action 对应独立的视图文件（如 <code>Index.cshtml</code>、<code>Details.cshtml</code>），需通过 URL 路径明确指定 Action 名称以渲染正确视图。</li>
<li>支持多 Action 多视图的灵活跳转（如导航菜单链接到不同页面）。</li>
</ul>
</li>
</ul>
<h4 id="2-API-控制器（不包含-action-）"><a href="#2-API-控制器（不包含-action-）" class="headerlink" title="(2) API 控制器（不包含 [action]）"></a><strong>(2) API 控制器（不包含 <code>[action]</code>）</strong></h4><ul>
<li><p><strong>典型路由配置</strong>：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]  <span class="comment">// 路由模板中不包含 [action]</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WeatherForecastController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">HttpGet</span>]  <span class="comment">// 通过 HTTP 方法区分操作</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IEnumerable&lt;WeatherForecast&gt; <span class="title">Get</span>()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpPost</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Create</span>(<span class="params">[FromBody] WeatherForecast data</span>)</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>URL 示例</strong>：</p>
<ul>
<li><code>GET /WeatherForecast</code> → 获取天气数据</li>
<li><code>POST /WeatherForecast</code> → 创建新天气数据</li>
</ul>
</li>
<li><p><strong>设计优势</strong>：</p>
<ul>
<li><strong>符合 RESTful 规范</strong>：URL 表示资源（如 <code>/WeatherForecast</code>），HTTP 方法（GET、POST）表示操作类型（读、写）。</li>
<li><strong>简化 URL 结构</strong>：避免暴露内部方法名，提升接口可读性和安全性。</li>
<li><strong>依赖 HTTP 语义</strong>：利用标准方法（GET&#x2F;POST&#x2F;PUT&#x2F;DELETE）而非 URL 路径区分功能。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-实际影响与配置差异"><a href="#3-实际影响与配置差异" class="headerlink" title="3. 实际影响与配置差异"></a><strong>3. 实际影响与配置差异</strong></h3><h4 id="1-路由注册方式"><a href="#1-路由注册方式" class="headerlink" title="(1) 路由注册方式"></a><strong>(1) 路由注册方式</strong></h4><ul>
<li><strong>MVC 控制器</strong>：<br>通常使用 ​<strong>​约定路由​</strong>​（<code>MapControllerRoute</code>）全局定义模板，依赖 <code>[action]</code> 映射视图。</li>
<li><strong>API 控制器</strong>：<br>优先使用 ​<strong>​属性路由​</strong>​（<code>[Route]</code> + <code>[HttpMethod]</code>），直接为每个 Action 指定端点，无需依赖 <code>[action]</code>。</li>
</ul>
<h4 id="2-ApiController-特性的作用"><a href="#2-ApiController-特性的作用" class="headerlink" title="(2) [ApiController] 特性的作用"></a><strong>(2) <code>[ApiController]</code> 特性的作用</strong></h4><ul>
<li><strong>自动推断路由</strong>：若未显式指定 <code>[Route]</code>，默认生成 <code>/ControllerName</code> 的路由。</li>
<li><strong>禁用视图查找</strong>：强制 API 控制器仅返回数据（如 JSON），而非视图。</li>
<li><strong>模型验证</strong>：自动响应 400 Bad Request 验证错误。</li>
</ul>
<h4 id="3-如何强制-API-控制器包含-action-（不推荐）"><a href="#3-如何强制-API-控制器包含-action-（不推荐）" class="headerlink" title="(3) 如何强制 API 控制器包含 [action]（不推荐）"></a><strong>(3) 如何强制 API 控制器包含 <code>[action]</code>（不推荐）</strong></h4><p>若需兼容旧版风格，可手动添加 <code>[action]</code>，但违背 RESTful 设计：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;[controller]/[action]&quot;</span>)</span>]  <span class="comment">// 显式包含 [action]</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WeatherForecastController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IEnumerable&lt;WeatherForecast&gt; <span class="title">List</span>()</span> &#123; ... &#125;  <span class="comment">// URL: /WeatherForecast/List</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-项目结构图中的体现"><a href="#4-项目结构图中的体现" class="headerlink" title="4. 项目结构图中的体现"></a><strong>4. 项目结构图中的体现</strong></h3><p>在您提供的项目图中，<code>WeatherForecastController.cs</code> 属于 <strong>API 控制器</strong>：</p>
<ul>
<li>未在路由模板中包含 <code>[action]</code>：<ul>
<li>通过 <code>[Route(&quot;[controller]&quot;)]</code> 定义基础路径 <code>/WeatherForecast</code>。</li>
<li>使用 <code>[HttpGet]</code> 等特性标识方法，无需 URL 路径区分操作。</li>
</ul>
</li>
<li>符合 RESTful 风格：<ul>
<li>所有操作均围绕 <code>/WeatherForecast</code> 资源展开，通过 HTTP 方法（GET&#x2F;POST）区分功能。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h3><ul>
<li><strong>MVC 控制器</strong>：需通过 <code>[action]</code> 明确指定视图路径，支持多页面交互。</li>
<li><strong>API 控制器</strong>：省略 <code>[action]</code> 以简化 URL，强调资源与 HTTP 方法的语义化操作，符合现代 API 设计趋势。</li>
<li>最佳实践：<ul>
<li><strong>API 设计</strong>：优先使用属性路由，避免 <code>[action]</code> 暴露内部逻辑。</li>
<li><strong>混合项目</strong>：若同时存在 MVC 和 API 控制器，可通过 <code>MapControllers()</code> 和 <code>MapControllerRoute()</code> 分别注册路由。</li>
</ul>
</li>
</ul>
</blockquote>
<h1 id="6、路由和-URL-路径"><a href="#6、路由和-URL-路径" class="headerlink" title="6、路由和 URL 路径"></a>6、路由和 URL 路径</h1><p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/microsoft.aspnetcore.mvc.httpgetattribute"><code>[HttpGet]</code></a> 属性表示响应 <code>HTTP GET</code> 请求的方法。 每个方法的 URL 路径构造如下所示：</p>
<ul>
<li><p>在控制器的 <code>Route</code> 属性中以模板字符串开头：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 待办事项控制器，提供待办事项的CRUD API接口</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;api/[controller]&quot;</span>)</span>]  <span class="comment">// 定义API路由为 &quot;api/TodoItems&quot;</span></span><br><span class="line">[<span class="meta">ApiController</span>]              <span class="comment">// 标识此类为API控制器</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemsController</span> : <span class="title">ControllerBase</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>将 <code>[controller]</code> 替换为控制器的名称，按照惯例，在控制器类名称中去掉“Controller”后缀。 对于此示例，控制器类名称为“TodoItems”控制器，因此控制器名称为“TodoItems”。 ASP.NET Core <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/aspnet/core/mvc/controllers/routing?view=aspnetcore-8.0">路由</a>不区分大小写。</p>
</li>
<li><p>如果 <code>[HttpGet]</code> 属性具有路由模板（例如 <code>[HttpGet(&quot;products&quot;)]</code>），则将它追加到路径。 此示例不使用模板。 有关详细信息，请参阅[使用 Http <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/aspnet/core/mvc/controllers/routing?view=aspnetcore-8.0#verb">Verb] 特性的特性路由</a>。</p>
</li>
</ul>
<p>在下面的 <code>GetTodoItem</code> 方法中，<code>&quot;&#123;id&#125;&quot;</code> 是待办事项的唯一标识符的占位符变量。 调用 <code>GetTodoItem</code> 时，URL 中 <code>&quot;&#123;id&#125;&quot;</code> 的值会在 <code>id</code> 参数中提供给方法。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 根据ID获取单个待办事项</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>指定ID的待办事项，若不存在则返回404<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="comment">// GET: api/TodoItems/5</span></span><br><span class="line">[<span class="meta">HttpGet(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;TodoItem&gt;&gt; GetTodoItem(<span class="built_in">long</span> id)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> todoItem = <span class="keyword">await</span> _context.TodoItems.FindAsync(id);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (todoItem == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> NotFound();  <span class="comment">// 返回404状态码，表示资源未找到</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> todoItem;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="7、返回值"><a href="#7、返回值" class="headerlink" title="7、返回值"></a>7、返回值</h1><p><code>GetTodoItems</code> 和 <code>GetTodoItem</code> 方法的返回类型是 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/aspnet/core/web-api/action-return-types?view=aspnetcore-8.0#actionresultt-type">ActionResult 类型</a>。 ASP.NET Core 自动将对象序列化为 <a target="_blank" rel="noopener" href="https://www.json.org/">JSON</a>，并将 JSON 写入响应消息的正文中。 此返回类型的响应代码为 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/docs/Web/HTTP/Status/200">200 OK</a>（假设没有未处理的异常）。 未经处理的异常将转换为 5xx 错误。</p>
<p><code>ActionResult</code> 返回类型可以表示大范围的 HTTP 状态代码。 例如，<code>GetTodoItem</code> 可以返回两个不同的状态值：</p>
<ul>
<li>如果没有任何项与请求的 ID 匹配，该方法将返回 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/docs/Web/HTTP/Status/404">404 状态</a><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/api/microsoft.aspnetcore.mvc.controllerbase.notfound">NotFound</a>错误代码。</li>
<li>否则，此方法将返回具有 JSON 响应正文的 200。 返回 <code>item</code> 则产生 <code>HTTP 200</code> 响应。</li>
</ul>
<h1 id="8、防止过度公开"><a href="#8、防止过度公开" class="headerlink" title="8、防止过度公开"></a>8、防止过度公开</h1><p>目前，示例应用公开了整个 <code>TodoItem</code> 对象。 生产应用通常使用模型的子集来限制输入和返回的数据。 这背后有多种原因，但安全性是主要原因。 模型的子集通常称为数据传输对象 (DTO)、输入模型或视图模型。 本教程使用了 <strong>DTO</strong>。</p>
<p>DTO 可用于：</p>
<ul>
<li>防止过度发布。</li>
<li>隐藏客户端不应查看的属性。</li>
<li>省略一些属性以缩减有效负载大小。</li>
<li>平展包含嵌套对象的对象图。 对客户端而言，平展的对象图可能更方便。</li>
</ul>
<p>将<code>TodoItem</code> 拆分为DTO和Entity</p>
<p>Pojo\DTO\TodoItemDTO.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Pojo.DTO</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 表示待办事项的数据传输对象（DTO）</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemDTO</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项的唯一标识符</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项的名称</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 可以为 null</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项是否已完成的标志</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> IsComplete &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Pojo\Entity\TodoItem.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Pojo.Entity</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 表示待办事项的实体模型类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 用于数据库存储和内部处理</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItem</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项的唯一标识符</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项的名称</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 可以为 null</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项是否已完成的标志</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> IsComplete &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取或设置待办事项的私密信息</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 此字段不应在API响应中返回给客户端，仅在实体模型中使用</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 可以为 null</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Secret &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Mapper\TodoContext.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.EntityFrameworkCore;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.Entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Mapper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 数据库上下文类，用于管理与数据库的连接及 TodoItem 实体的数据操作</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 继承自 EntityFrameworkCore 的 DbContext 类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoContext</span> : <span class="title">DbContext</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 构造函数，接收数据库上下文配置选项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;options&quot;&gt;</span>数据库上下文配置选项<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TodoContext</span>(<span class="params">DbContextOptions&lt;TodoContext&gt; options</span>) : <span class="title">base</span>(<span class="params">options</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> TodoItem 实体的数据库集合，用于对 TodoItem 表进行查询和操作</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 通过 DbSet 可以进行增删改查等数据库操作</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 标记为 null! 表示该属性在构造后不会为 null</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;TodoItem&gt; TodoItems &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="literal">null</span>!;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>随后更新 <code>TodoItemsController</code> 以使用 <code>TodoItemDTO</code>：</p>
<p>Controllers\TodoItemsController.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Http;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> Microsoft.EntityFrameworkCore;</span><br><span class="line"><span class="keyword">using</span> WebApp.Mapper;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.DTO;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.Entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项控制器，提供待办事项的CRUD API接口</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 实现了数据实体(Entity)与数据传输对象(DTO)之间的转换，保护敏感数据</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;api/[controller]&quot;</span>)</span>]  <span class="comment">// 定义API路由为 &quot;api/TodoItems&quot;</span></span><br><span class="line">    [<span class="meta">ApiController</span>]              <span class="comment">// 标识此类为API控制器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemsController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 数据库上下文实例，用于操作待办事项数据</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> TodoContext _context;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 构造函数，通过依赖注入接收数据库上下文</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;context&quot;&gt;</span>待办事项数据库上下文<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TodoItemsController</span>(<span class="params">TodoContext context</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _context = context;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取所有待办事项列表，返回DTO对象集合（不含敏感字段）</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>待办事项DTO对象集合<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpGet</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;IEnumerable&lt;TodoItemDTO&gt;&gt;&gt; GetTodoItems()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 查询所有待办事项并转换为DTO对象</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> _context.TodoItems</span><br><span class="line">                .Select(x =&gt; ItemToDTO(x))</span><br><span class="line">                .ToListAsync();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 根据ID获取单个待办事项，返回DTO对象（不含敏感字段）</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>指定ID的待办事项DTO对象，若不存在则返回404<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpGet(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;TodoItemDTO&gt;&gt; GetTodoItem(<span class="built_in">long</span> id)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 根据ID查找待办事项</span></span><br><span class="line">            <span class="keyword">var</span> todoItem = <span class="keyword">await</span> _context.TodoItems.FindAsync(id);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果未找到，返回404 Not Found状态码</span></span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> NotFound();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将实体对象转换为DTO对象并返回</span></span><br><span class="line">            <span class="keyword">return</span> ItemToDTO(todoItem);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoDTO&quot;&gt;</span>待更新的待办事项DTO对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>更新结果：成功返回204，失败返回400或404<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPut(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">PutTodoItem</span>(<span class="params"><span class="built_in">long</span> id, TodoItemDTO todoDTO</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 验证URL中的ID与DTO对象中的ID是否匹配</span></span><br><span class="line">            <span class="keyword">if</span> (id != todoDTO.Id)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> BadRequest(); <span class="comment">// 返回400 Bad Request状态码</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取原有的待办事项实体</span></span><br><span class="line">            <span class="keyword">var</span> todoItem = <span class="keyword">await</span> _context.TodoItems.FindAsync(id);</span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> NotFound(); <span class="comment">// 返回404 Not Found状态码</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 更新实体的属性，保留Secret字段不变</span></span><br><span class="line">            todoItem.Name = todoDTO.Name;</span><br><span class="line">            todoItem.IsComplete = todoDTO.IsComplete;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 保存更改到数据库</span></span><br><span class="line">                <span class="keyword">await</span> _context.SaveChangesAsync();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (DbUpdateConcurrencyException) <span class="keyword">when</span> (!TodoItemExists(id))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 处理并发异常，如果项目已不存在则返回404</span></span><br><span class="line">                <span class="keyword">return</span> NotFound();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回204 No Content状态码，表示成功但无返回内容</span></span><br><span class="line">            <span class="keyword">return</span> NoContent();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 创建新的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoDTO&quot;&gt;</span>包含新待办事项信息的DTO对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>创建的待办事项DTO对象及其资源位置<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;TodoItemDTO&gt;&gt; PostTodoItem(TodoItemDTO todoDTO)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 创建新的待办事项实体，从DTO复制属性值</span></span><br><span class="line">            <span class="keyword">var</span> todoItem = <span class="keyword">new</span> TodoItem</span><br><span class="line">            &#123;</span><br><span class="line">                IsComplete = todoDTO.IsComplete,</span><br><span class="line">                Name = todoDTO.Name</span><br><span class="line">                <span class="comment">// Secret字段保持默认值null</span></span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将实体添加到数据库</span></span><br><span class="line">            _context.TodoItems.Add(todoItem);</span><br><span class="line">            <span class="keyword">await</span> _context.SaveChangesAsync();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回201 Created状态码，包含新资源的位置和转换后的DTO对象</span></span><br><span class="line">            <span class="keyword">return</span> CreatedAtAction(</span><br><span class="line">                <span class="keyword">nameof</span>(GetTodoItem),           <span class="comment">// 获取资源的方法名</span></span><br><span class="line">                <span class="keyword">new</span> &#123; id = todoItem.Id &#125;,      <span class="comment">// 路由参数</span></span><br><span class="line">                ItemToDTO(todoItem));          <span class="comment">// 返回的DTO对象</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 删除指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待删除的待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>删除结果：成功返回204，未找到返回404<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpDelete(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">DeleteTodoItem</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 查找待删除的待办事项</span></span><br><span class="line">            <span class="keyword">var</span> todoItem = <span class="keyword">await</span> _context.TodoItems.FindAsync(id);</span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> NotFound(); <span class="comment">// 返回404 Not Found状态码</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 从数据库中删除待办事项</span></span><br><span class="line">            _context.TodoItems.Remove(todoItem);</span><br><span class="line">            <span class="keyword">await</span> _context.SaveChangesAsync();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回204 No Content状态码，表示成功但无返回内容</span></span><br><span class="line">            <span class="keyword">return</span> NoContent();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 检查指定ID的待办事项是否存在</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待检查的待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>如果存在返回true，否则返回false<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">bool</span> <span class="title">TodoItemExists</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> _context.TodoItems.Any(e =&gt; e.Id == id);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将待办事项实体转换为DTO对象，排除敏感字段（如Secret）</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItem&quot;&gt;</span>待转换的待办事项实体<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>转换后的待办事项DTO对象<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> TodoItemDTO <span class="title">ItemToDTO</span>(<span class="params">TodoItem? todoItem</span>)</span> =&gt;</span><br><span class="line">           <span class="keyword">new</span> TodoItemDTO</span><br><span class="line">           &#123;</span><br><span class="line">               Id = todoItem.Id,</span><br><span class="line">               Name = todoItem.Name,</span><br><span class="line">               IsComplete = todoItem.IsComplete</span><br><span class="line">               <span class="comment">// 不包含Secret字段，保护敏感数据</span></span><br><span class="line">           &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="9、从ASP-NET-Core空构建最简化项目"><a href="#9、从ASP-NET-Core空构建最简化项目" class="headerlink" title="9、从ASP.NET Core空构建最简化项目"></a>9、从<code>ASP.NET Core空</code>构建最简化项目</h1><h2 id="1、初始化项目-1"><a href="#1、初始化项目-1" class="headerlink" title="1、初始化项目"></a>1、初始化项目</h2><ol>
<li><p>在初始化项目的时候，采用<code>ASP.NET Core空</code>初始化项目，并取消HTTPS</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418161933895.png" alt="image-20250418161933895"></p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418164104141.png" alt="image-20250418164104141"></p>
</li>
<li><p>并添加一系列预留文件夹，模板参照SpingBoot</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250418165353931.png" alt="image-20250418165353931"></p>
</li>
</ol>
<h2 id="2、创建TodoItem-相关的类"><a href="#2、创建TodoItem-相关的类" class="headerlink" title="2、创建TodoItem 相关的类"></a>2、创建<code>TodoItem</code> 相关的类</h2><p>Pojo\DTO\TodoItemDTO.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Pojo.DTO</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项数据传输对象 (Data Transfer Object)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 用于在应用层之间传递待办事项数据，不包含所有实体属性</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemDTO</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 优先级ID，表示待办事项的优先级等级</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">long</span> PriorityId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 待办事项名称，可为空</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 完成状态标志，表示待办事项是否已完成</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> true 表示已完成，false 表示未完成</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> IsComplete &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Pojo\Entity\TodoItem.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Pojo.Entity</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项实体类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 表示数据库中的一条待办事项记录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItem</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 待办事项的唯一标识符</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 设为私有属性以保证实体完整性</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">long</span> TodoId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 优先级标识符</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用于关联待办事项的优先级别</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">long</span> PriorityId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 待办事项名称</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 可以为空</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 完成状态标志</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> true表示已完成，false表示未完成</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> IsComplete &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 创建时间</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 记录待办事项的创建时间戳</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DateTime CreatedAt &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新时间</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 记录待办事项的最后更新时间戳</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DateTime UpdatedAt &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 删除时间</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用于软删除功能，记录实体被删除的时间</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 为null表示未删除</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DateTime? DeletedAt &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> TodoItem 的完整构造函数</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 初始化待办事项的所有属性</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoId&quot;&gt;</span>待办事项ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;priorityId&quot;&gt;</span>优先级ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span>待办事项名称<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isComplete&quot;&gt;</span>完成状态<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;createdAt&quot;&gt;</span>创建时间<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;updatedAt&quot;&gt;</span>更新时间<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;deletedAt&quot;&gt;</span>删除时间，默认为null<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TodoItem</span>(<span class="params"><span class="built_in">long</span> todoId, <span class="built_in">long</span> priorityId, <span class="built_in">string</span>? name, <span class="built_in">bool</span> isComplete, DateTime createdAt, DateTime updatedAt, DateTime? deletedAt = <span class="literal">null</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            TodoId = todoId;</span><br><span class="line">            PriorityId = priorityId;</span><br><span class="line">            Name = name;</span><br><span class="line">            IsComplete = isComplete;</span><br><span class="line">            CreatedAt = createdAt;</span><br><span class="line">            UpdatedAt = updatedAt;</span><br><span class="line">            DeletedAt = deletedAt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Pojo\VO\TodoItemVO.cs</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Pojo.VO</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项视图对象 (View Object)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 用于向前端或其他外部系统展示待办事项数据</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 不包含敏感数据字段，适合视图层使用</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemVO</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 优先级标识符</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 表示待办事项的优先级等级</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">long</span> PriorityId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 待办事项名称</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 可为空值</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 完成状态标志</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> true表示已完成，false表示未完成</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> IsComplete &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 创建时间</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 记录待办事项创建的时间戳</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DateTime CreatedAt &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新时间</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 记录待办事项最后一次更新的时间戳</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DateTime UpdatedAt &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 删除时间</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 用于软删除功能，记录删除时间</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 为null表示未删除</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DateTime? DeletedAt &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3、构建TodoItemController类"><a href="#3、构建TodoItemController类" class="headerlink" title="3、构建TodoItemController类"></a>3、构建<code>TodoItemController</code>类</h2><p>创建<code>TodoItemController</code>，并继承<code>ControllerBase</code>，并利用“注解”标注为<code>[ApiController]</code>和<code>[Route(&quot;api/[controller]&quot;)]</code>。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项控制器</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 处理与待办事项相关的HTTP请求</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">ApiController</span>]  <span class="comment">// 指示此类为API控制器</span></span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;api/[controller]&quot;</span>)</span>]  <span class="comment">// 设置此控制器的路由模板，访问路径为 api/TodoItem</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 在此添加控制器方法，如：</span></span><br><span class="line">        <span class="comment">// GET - 获取所有待办事项</span></span><br><span class="line">        [<span class="meta">HttpGet</span>] <span class="comment">// 指定此方法处理 HTTP GET 请求</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ActionResult&lt;<span class="built_in">string</span>&gt; <span class="title">Get</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 返回所有待办事项</span></span><br><span class="line">            <span class="comment">// 当前返回的是一个简单的字符串 &quot;ss&quot;，可以替换为实际的待办事项数据</span></span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;ss&quot;</span>); <span class="comment">// 返回 HTTP 200 状态码和响应内容</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// GET(id) - 获取指定ID的待办事项</span></span><br><span class="line">        <span class="comment">// POST - 创建新待办事项</span></span><br><span class="line">        <span class="comment">// PUT - 更新待办事项</span></span><br><span class="line">        <span class="comment">// DELETE - 删除待办事项</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4、注册使用“控制器服务”"><a href="#4、注册使用“控制器服务”" class="headerlink" title="4、注册使用“控制器服务”"></a>4、注册使用“控制器服务”</h2><p>在<code>Program.cs</code>中使用控制器。<code>builder.Services.AddControllers();</code>、<code>app.MapControllers();</code></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个 Web 应用程序构建器，用于配置应用程序的服务和中间件</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1、注册控制器服务</span></span><br><span class="line"><span class="comment">// 这一步将控制器添加到依赖注入容器中，允许应用程序处理基于控制器的 HTTP 请求</span></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建 Web 应用程序实例</span></span><br><span class="line"><span class="comment">// 通过构建器生成一个 Web 应用程序对象，准备运行应用程序</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2、映射控制器路由</span></span><br><span class="line"><span class="comment">// 将控制器的路由映射到应用程序中，使其能够响应 HTTP 请求</span></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动 Web 应用程序并开始监听请求</span></span><br><span class="line"><span class="comment">// 运行应用程序，开始处理传入的 HTTP 请求</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p>这个时候启动便可以通过”api&#x2F;TodoItem“查看是否启动成功。</p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250419093659249.png" alt="image-20250419093659249"></p>
<h2 id="5、构建详细内容"><a href="#5、构建详细内容" class="headerlink" title="5、构建详细内容"></a>5、构建详细内容</h2><h3 id="1、数据库"><a href="#1、数据库" class="headerlink" title="1、数据库"></a>1、数据库</h3><p>在DB&#x2F;TodoItemDataBase.cs中模拟数据库相关操作。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> WebApp.Pojo.Entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.DB</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项数据库模拟类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 用于在内存中存储和管理 TodoItem 对象</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">TodoItemDataBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 存储待办事项的静态集合</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 使用只读属性确保集合的封装性</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> List&lt;TodoItem&gt; TodoItems &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 静态构造函数</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 初始化待办事项数据，模拟数据库中的记录</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="title">TodoItemDataBase</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            TodoItems = <span class="keyword">new</span> List&lt;TodoItem&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 创建第一个待办事项，ID为1，优先级为1，未完成</span></span><br><span class="line">                <span class="keyword">new</span> TodoItem(</span><br><span class="line">                    todoId: <span class="number">1</span>,</span><br><span class="line">                    priorityId: <span class="number">1</span>,</span><br><span class="line">                    name: <span class="string">&quot;Task 1&quot;</span>,</span><br><span class="line">                    isComplete: <span class="literal">false</span>,</span><br><span class="line">                    createdAt: DateTime.Now,</span><br><span class="line">                    updatedAt: DateTime.Now),</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 创建第二个待办事项，ID为2，优先级为2，已完成，创建时间为一天前</span></span><br><span class="line">                <span class="keyword">new</span> TodoItem(</span><br><span class="line">                    todoId: <span class="number">2</span>,</span><br><span class="line">                    priorityId: <span class="number">2</span>,</span><br><span class="line">                    name: <span class="string">&quot;Task 2&quot;</span>,</span><br><span class="line">                    isComplete: <span class="literal">true</span>,</span><br><span class="line">                    createdAt: DateTime.Now.AddDays(<span class="number">-1</span>),</span><br><span class="line">                    updatedAt: DateTime.Now)</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、Mapper"><a href="#2、Mapper" class="headerlink" title="2、Mapper"></a>2、Mapper</h3><p>ITodoItemMapper 接口详细介绍</p>
<ol>
<li>设计目的与原则<br>  ITodoItemMapper 接口是应用程序数据访问层的核心组件，其设计遵循以下关键原则：</li>
</ol>
<ul>
<li>数据映射器模式(Data Mapper Pattern)：将数据层与领域模型分离，负责数据在持久化存储和内存对象之间的转换</li>
<li>单一职责原则：专注于待办事项数据的访问操作，不涉及业务逻辑</li>
<li>依赖倒置原则：高层模块依赖于抽象接口，而非具体实现</li>
<li>接口隔离原则：只提供必要的方法，保持接口简洁明确</li>
</ul>
<ol start="2">
<li><p>方法详解</p>
</li>
<li><p>GetAllTodoItems()<br>- 功能：检索系统中的所有待办事项记录<br>- 返回值：包含所有 TodoItem 对象的列表<br>- 应用场景：用户访问待办事项列表页面时，需要展示所有任务</p>
</li>
<li><p>GetTodoItemById(long id)<br>- 功能：根据唯一标识查找单个待办事项<br>- 参数：待办事项的ID<br>- 返回值：找到的 TodoItem 对象，如果不存在则返回 null<br>- 应用场景：查看特定待办事项详情、编辑前获取数据、验证项目存在性</p>
</li>
<li><p>AddTodoItem(TodoItem todoItem)<br>- 功能：创建新的待办事项记录<br>- 参数：完整填充的 TodoItem 实体<br>- 返回值：无，操作成功时无返回值<br>- 应用场景：用户创建新任务时</p>
</li>
<li><p>UpdateTodoItem(long id, TodoItem todoItem)<br>- 功能：更新现有待办事项的信息<br>- 参数：<br>- id：要更新的待办事项标识<br>- todoItem：包含更新数据的待办事项对象<br>- 返回值：无，操作成功时无返回值<br>- 应用场景：用户编辑任务内容、标记任务完成等</p>
</li>
<li><p>DeleteTodoItem(long id)<br>- 功能：删除指定的待办事项<br>- 参数：待删除项的 ID<br>- 返回值：无，操作成功时无返回值<br>- 应用场景：用户删除不再需要的任务</p>
</li>
<li><p>在应用架构中的位置<br>  ITodoItemMapper 在应用的多层架构中处于数据访问层：</p>
</li>
</ol>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">表示层(Controller) → 业务逻辑层(Service) → 数据访问层(Mapper) → 数据存储层(DB)</span><br></pre></td></tr></table></figure>

<p>  在这个架构中：</p>
<ul>
<li>控制器接收用户请求</li>
<li>服务层实现业务逻辑并调用 Mapper</li>
<li>Mapper 实现(如 TodoItemMapperImpl) 执行实际的数据操作</li>
<li>数据最终存储在数据库或内存集合中</li>
</ul>
<ol start="4">
<li>接口优势与扩展性</li>
</ol>
<ul>
<li>测试友好：可以轻松创建模拟实现用于单元测试</li>
<li>实现替换：可以在不修改业务逻辑的情况下切换数据源(如从内存存储切换到SQL数据库)</li>
<li>代码组织：清晰定义了数据操作的边界，使代码结构更加有序</li>
<li>分离关注点：数据访问逻辑与业务规则分离</li>
</ul>
<ol start="5">
<li>总结<br>  ITodoItemMapper 接口代表了一种清晰的关注点分离设计，通过定义数据操作的契约，使应用程序能够以松耦合、可测试和可扩展的方式处理待办事项数据。这种设计方式促进了代码的可维护性，同时提供了实现替换的灵活性。</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> WebApp.Pojo.Entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Mapper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项数据映射器接口</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 定义了对待办事项(TodoItem)实体的数据访问操作</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 作为数据访问层的核心组件，负责数据操作的抽象</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ITodoItemMapper</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取所有待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>所有待办事项的集合<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;TodoItem&gt; <span class="title">GetAllTodoItems</span>()</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 根据ID获取特定的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待办事项的唯一标识符<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>对应ID的待办事项，如果不存在则返回null<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItem <span class="title">GetTodoItemById</span>(<span class="params"><span class="built_in">long</span> id</span>)</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 添加一个新的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItem&quot;&gt;</span>需要添加的待办事项对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddTodoItem</span>(<span class="params">TodoItem todoItem</span>)</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待更新待办事项的ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItem&quot;&gt;</span>包含更新信息的待办事项对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UpdateTodoItem</span>(<span class="params"><span class="built_in">long</span> id, TodoItem todoItem</span>)</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 删除指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待删除待办事项的ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DeleteTodoItem</span>(<span class="params"><span class="built_in">long</span> id</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TodoItemMapperImpl 类是 ITodoItemMapper 接口的具体实现，采用内存存储方式管理待办事项数据。它提供了待办事项的基本CRUD（创建、读取、更新、删除）操作的实现，使用静态类 TodoItemDataBase 作为数据源。<br>设计特点</p>
<ol>
<li><p>   内存数据存储模式：</p>
<ul>
<li>使用 TodoItemDataBase.TodoItems 静态集合作为数据源</li>
<li>所有操作直接在内存中执行，无需数据库连接</li>
<li>适合原型开发、测试和小型应用场景</li>
</ul>
</li>
<li><p>   简单直接的实现：</p>
<ul>
<li>代码简洁清晰，每个方法直接操作静态集合</li>
<li>没有额外的数据验证或异常处理</li>
<li>利用C#内置的LINQ功能（如Find方法）进行数据查询</li>
</ul>
</li>
<li><p>   接口实现：</p>
<ol>
<li>完全实现了 ITodoItemMapper 接口定义的所有方法</li>
<li>保持了方法签名的一致性</li>
<li>遵循了依赖倒置原则，允许通过接口引用使用此实现</li>
</ol>
</li>
<li><p>   方法分析</p>
<ol>
<li>GetAllTodoItems()</li>
</ol>
<pre><code>- 实现逻辑：直接返回静态集合的引用
- 性能特点：O(1)时间复杂度，非常高效
</code></pre>
<ol start="2">
<li>GetTodoItemById(long id)</li>
</ol>
<pre><code>- 实现逻辑：使用LINQ的Find方法查找匹配ID的第一个项目
- 性能特点：O(n)时间复杂度，需要遍历集合
</code></pre>
<ol start="3">
<li>AddTodoItem(TodoItem todoItem)</li>
</ol>
<pre><code>- 实现逻辑：直接将项目添加到静态集合中
- 性能特点：O(1)时间复杂度，高效
</code></pre>
<ol start="4">
<li>UpdateTodoItem(long id, TodoItem todoItem)</li>
</ol>
<pre><code>- 实现逻辑：查找匹配项并逐个更新属性
- 性能特点：O(n)时间复杂度，需要遍历集合
</code></pre>
<ol start="5">
<li>DeleteTodoItem(long id)</li>
</ol>
<pre><code>1.    实现逻辑：查找匹配项并从集合中移除
2.    性能特点：O(n)时间复杂度，需要遍历集合
</code></pre>
<ol start="6">
<li>在架构中的位置</li>
</ol>
<pre><code>TodoItemMapperImpl 在应用程序的分层架构中处于数据访问层，具体位置如下：
</code></pre>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">表示层 (Controller) → 业务逻辑层 (Service) → 数据访问层 (Mapper) → 数据存储</span><br><span class="line">                                              ↓</span><br><span class="line">                                       TodoItemMapperImpl → TodoItemDataBase</span><br></pre></td></tr></table></figure>

<p> 服务层通过接口引用调用此实现，不直接依赖于具体类，从而实现松耦合设计。</p>
</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> WebApp.DB;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.Entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Mapper.Impl</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> TodoItem数据映射器的实现类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 提供待办事项数据的内存存储实现</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 实现ITodoItemMapper接口定义的所有数据访问操作</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemMapperImpl</span> : <span class="title">ITodoItemMapper</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取所有待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 直接返回内存数据库中存储的所有TodoItem对象</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>所有待办事项的集合<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;TodoItem&gt; <span class="title">GetAllTodoItems</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> TodoItemDataBase.TodoItems;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 根据ID获取特定的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 在内存数据库中查找匹配指定ID的TodoItem</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待办事项的唯一标识符<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>对应ID的待办事项，如果不存在则返回null<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItem <span class="title">GetTodoItemById</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> TodoItemDataBase.TodoItems.Find(item =&gt; item.Id == id);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 添加一个新的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将待办事项对象添加到内存数据库集合中</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItem&quot;&gt;</span>需要添加的待办事项对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddTodoItem</span>(<span class="params">TodoItem todoItem</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            TodoItemDataBase.TodoItems.Add(todoItem);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 先查找对应ID的项目，然后更新其所有属性</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待更新待办事项的ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItem&quot;&gt;</span>包含更新信息的待办事项对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span>注意：此方法不检查项目是否存在，可能导致空引用异常<span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UpdateTodoItem</span>(<span class="params"><span class="built_in">long</span> id, TodoItem todoItem</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> item = TodoItemDataBase.TodoItems.Find(item =&gt; item.Id == id);</span><br><span class="line">            item.Id = todoItem.Id;</span><br><span class="line">            item.Name = todoItem.Name;</span><br><span class="line">            item.IsComplete = todoItem.IsComplete;</span><br><span class="line">            item.CreatedAt = todoItem.CreatedAt;</span><br><span class="line">            item.UpdatedAt = todoItem.UpdatedAt;</span><br><span class="line">            item.DeletedAt = todoItem.DeletedAt;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 删除指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 先查找对应ID的项目，然后从集合中移除</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待删除待办事项的ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span>注意：此方法不检查项目是否存在，可能导致空引用异常<span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DeleteTodoItem</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> item = TodoItemDataBase.TodoItems.Find(item =&gt; item.Id == id);</span><br><span class="line">            TodoItemDataBase.TodoItems.Remove(item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、Services"><a href="#3、Services" class="headerlink" title="3、Services"></a>3、Services</h3><p>ITodoItemService 接口详细介绍</p>
<ol>
<li>设计目的与定位<br>  ITodoItemService 接口是 WebApp 应用程序中业务逻辑层的核心组件，它定义了与待办事项相关的所有业务操作。该接口采用了以下设计原则：</li>
</ol>
<ul>
<li>业务逻辑封装：将所有待办事项相关的业务规则和操作集中在一个接口中管理</li>
<li>转换逻辑处理：负责在不同数据模型（DTO、Entity、VO）之间进行转换</li>
<li>面向接口编程：通过接口定义服务契约，支持依赖注入和松耦合设计</li>
<li>单一职责原则：专注于待办事项这一业务实体的操作</li>
</ul>
<ol start="2">
<li><p>数据模型关系<br>  ITodoItemService 接口处理三种不同的数据模型，每种模型有特定用途：</p>
</li>
<li><p>TodoItemDTO (Data Transfer Object)：</p>
<ul>
<li>用于接收客户端提交的数据</li>
<li>包含最少必要的字段 (Id, Name, IsComplete)</li>
<li>适用于数据输入和修改操作</li>
</ul>
</li>
<li><p>TodoItem (Entity)：</p>
<ul>
<li>表示数据库中的实体</li>
<li>包含完整的数据字段，包括内部字段 (如 TodoId)</li>
<li>用于持久化存储</li>
</ul>
</li>
<li><p>TodoItemVO (View Object)：</p>
<ul>
<li>用于向客户端返回数据</li>
<li>包含展示所需的全部字段</li>
<li>隐藏内部实现细节，适合前端展示</li>
</ul>
</li>
<li><p>方法详解</p>
</li>
<li><p>GetAllTodoItems()</p>
<ul>
<li>业务含义：获取系统中所有可见的待办事项</li>
<li>处理流程：<ol>
<li>调用数据访问层获取所有实体</li>
<li>将实体集合转换为视图对象集合</li>
<li>可能进行过滤（如排除已删除项）或排序</li>
<li>返回说明：返回TodoItemVO的列表，确保数据适合前端展示</li>
<li>业务规则：可能实现分页、排序或筛选等功能</li>
</ol>
</li>
</ul>
</li>
<li><p>GetTodoItemById(long id)</p>
<ul>
<li>业务含义：查询特定待办事项的详细信息</li>
<li>处理流程：<ol>
<li>验证ID的有效性</li>
<li>调用数据访问层查找对应实体</li>
<li>如果找到，将实体转换为视图对象</li>
<li>如果未找到，可能抛出业务异常</li>
<li>返回说明：返回单个TodoItemVO对象</li>
<li>业务规则：确保返回的是有效且未删除的待办事项</li>
</ol>
</li>
</ul>
</li>
<li><p>AddTodoItem(TodoItemDTO todoItemDTO)</p>
<ol>
<li>业务含义：创建新的待办事项</li>
<li>处理流程：<ol>
<li>验证DTO中的数据有效性</li>
<li>创建新的TodoItem实体</li>
<li>设置自动生成的字段（如创建时间）</li>
<li>调用数据访问层保存实体</li>
<li>将保存后的实体转换为视图对象</li>
<li>返回说明：返回创建成功的TodoItemVO对象，包含系统生成的ID和时间戳</li>
<li>业务规则：处理数据验证、ID生成、重复项检查等业务逻辑</li>
</ol>
</li>
</ol>
</li>
<li><p>UpdateTodoItem(long id, TodoItemDTO todoItemDTO)</p>
<ul>
<li>业务含义：更新现有待办事项的信息</li>
<li>处理流程：<ol>
<li>验证ID有效性和DTO数据合法性</li>
<li>查找现有实体</li>
<li>用DTO中的数据更新实体属</li>
<li>更新修改时间戳</li>
<li>调用数据访问层保存更改</li>
<li>将更新后的实体转换为视图对象</li>
<li>返回说明：返回更新后的TodoItemVO对象</li>
<li>业务规则：处理并发控制、部分更新、状态转换等业务逻辑</li>
</ol>
</li>
</ul>
</li>
<li><p>DeleteTodoItem(long id)</p>
<ol>
<li>业务含义：删除指定的待办事项</li>
<li>处理流程：<ol>
<li>验证ID有效性</li>
<li>查找现有实体并保存副本</li>
<li>执行删除操作（可能是物理删除或逻辑删除）</li>
<li>将被删除的实体转换为视图对象</li>
<li>返回说明：返回删除前的TodoItemVO对象，便于客户端确认删除的内容</li>
<li>业务规则：可能实现软删除（标记DeletedAt）而非物理删除</li>
</ol>
</li>
</ol>
</li>
<li><p>在应用架构中的位置<br>  ITodoItemService 在应用的分层架构中处于业务逻辑层：</p>
</li>
</ol>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">表示层(Controller) → 业务逻辑层(Service) → 数据访问层(Mapper) → 数据存储层(DB)</span><br><span class="line">        ↓                     ↓                    ↓                 ↓</span><br><span class="line"> 使用TodoItemVO         ITodoItemService      ITodoItemMapper    TodoItem实体</span><br><span class="line"> 接收TodoItemDTO</span><br></pre></td></tr></table></figure>

<ul>
<li>向上：为控制器提供业务功能，接收DTO并返回VO</li>
<li>向下：调用数据访问层接口进行实际的数据操作</li>
<li>内部：处理数据转换、业务规则验证和错误处理</li>
</ul>
<ol start="8">
<li>设计优势</li>
</ol>
<ul>
<li>关注点分离：业务逻辑与数据访问清晰分离</li>
<li>模型转换：专门处理不同数据模型之间的转换</li>
<li>统一业务入口：为待办事项提供统一的业务功能入口</li>
<li>可测试性：便于对业务逻辑进行单元测试</li>
<li>灵活性：通过接口设计支持不同实现，如缓存、事务等扩展</li>
</ul>
<ol start="9">
<li>总结<br>ITodoItemService接口是应用程序业务逻辑层的关键组件，负责待办事项的所有业务操作。它通过清晰定义的方法契约，将表示层与数据访问层解耦，同时处理不同数据模型间的转换。这种设计支持更好的代码组织、测试和维护，符合现代企业应用架构的最佳实践。</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> WebApp.Pojo.DTO;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.Entity;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.VO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Services</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项服务接口</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 定义了待办事项的业务逻辑操作</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 作为业务逻辑层的核心组件，处理待办事项的业务规则和转换逻辑</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ITodoItemService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取所有待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 以视图对象(VO)形式返回，适合前端展示</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>所有待办事项的VO集合<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;TodoItemVO&gt; <span class="title">GetAllTodoItems</span>()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 根据ID获取特定的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将数据库实体转换为视图对象返回</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待办事项的唯一标识符<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>对应ID的待办事项视图对象，如果不存在可能抛出异常<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItemVO <span class="title">GetTodoItemById</span>(<span class="params"><span class="built_in">long</span> id</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 添加一个新的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将DTO转换为实体对象并保存，然后返回创建后的视图对象</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItemDTO&quot;&gt;</span>包含新待办事项信息的DTO<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>创建成功后的待办事项视图对象<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItemVO <span class="title">AddTodoItem</span>(<span class="params">TodoItemDTO todoItemDTO</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 使用DTO中的数据更新已有实体，并返回更新后的视图对象</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待更新待办事项的ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItemDTO&quot;&gt;</span>包含更新信息的DTO<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>更新后的待办事项视图对象<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItemVO <span class="title">UpdateTodoItem</span>(<span class="params"><span class="built_in">long</span> id, TodoItemDTO todoItemDTO</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 删除指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行删除操作并返回删除前的待办事项信息</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待删除待办事项的ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>删除前的待办事项视图对象<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItemVO <span class="title">DeleteTodoItem</span>(<span class="params"><span class="built_in">long</span> id</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TodoItemServiceImpl 类详细介绍</p>
<ol>
<li><p>设计目的与职责<br>  TodoItemServiceImpl 是 ITodoItemService 接口的具体实现，它在 WebApp 应用的分层架构中扮演着业务逻辑层的核心角色。主要职责包括：</p>
</li>
<li><p>业务逻辑处理：实现所有待办事项相关的业务操作和规则</p>
</li>
<li><p>数据转换：在三种数据模型间进行转换</p>
<ul>
<li>从 DTO（客户端输入）到 Entity（数据存储）</li>
<li>从 Entity（数据存储）到 VO（客户端展示）</li>
</ul>
</li>
<li><p>数据验证：验证操作的有效性，处理异常情况</p>
</li>
<li><p>数据访问协调：通过依赖注入的 ITodoItemMapper 进行数据访问</p>
</li>
<li><p>架构定位与关系<br>  在应用的分层架构中，TodoItemServiceImpl 的位置如下：</p>
</li>
</ol>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">控制器层 (TodoItemController) </span><br><span class="line">      ↓ 依赖</span><br><span class="line">业务逻辑层 (TodoItemServiceImpl -&gt; ITodoItemService)</span><br><span class="line">      ↓ 依赖</span><br><span class="line">数据访问层 (TodoItemMapperImpl -&gt; ITodoItemMapper)</span><br><span class="line">      ↓ 访问</span><br><span class="line">  数据存储 (TodoItemDataBase)</span><br></pre></td></tr></table></figure>

<ul>
<li>向上：为控制器提供业务服务，处理请求参数和响应</li>
<li>向下：通过 ITodoItemMapper 接口访问数据</li>
</ul>
<ol start="3">
<li>依赖注入设计<br>  类采用了构造函数注入的依赖注入模式：</li>
</ol>
  <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> ITodoItemMapper _todoItemMapper;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TodoItemServiceImpl</span>(<span class="params">ITodoItemMapper todoItemMapper</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    _todoItemMapper = todoItemMapper;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  这种设计有以下优势：</p>
<ul>
<li>松耦合：不直接依赖具体实现，而是依赖抽象接口</li>
<li>可测试性：便于在单元测试中注入模拟对象</li>
<li>灵活性：可以轻松替换底层数据访问实现</li>
</ul>
<ol start="4">
<li><p>方法分析</p>
</li>
<li><p>GetAllTodoItems()<br>- 数据流：Mapper → Entity集合 → VO集合 → 控制器<br>- 转换逻辑：使用LINQ的Select方法批量转换实体为VO<br>- 性能考虑：适用于中小型数据集，大数据集可能需要分页</p>
</li>
<li><p>GetTodoItemById(long id)<br>- 异常处理：明确处理了项目不存在的情况<br>- 数据流：ID → Mapper查询 → Entity → VO → 控制器<br>- 验证逻辑：确保返回有效的待办事项</p>
</li>
<li><p>AddTodoItem(TodoItemDTO todoItemDTO)<br>- 数据创建：从DTO创建新的Entity，设置初始值</p>
</li>
<li><p>UpdateTodoItem(long id, TodoItemDTO todoItemDTO)<br>- 业务流程：查找 → 验证 → 更新 → 保存 → 验证 → 返回<br>- 状态管理：自动更新UpdatedAt时间戳</p>
</li>
<li><p>DeleteTodoItem(long id)<br>- 业务设计：返回删除前的对象，便于客户端确认删除的内容<br>- 实现策略：物理删除而非逻辑删除</p>
</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> WebApp.Mapper;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.DTO;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.Entity;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.VO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Services.Impl</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项服务实现类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 实现了ITodoItemService接口定义的所有业务逻辑操作</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 作为连接表示层和数据访问层的桥梁，处理数据转换和业务规则</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemServiceImpl</span> : <span class="title">ITodoItemService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 待办事项数据映射器接口，用于数据访问操作</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 通过依赖注入获取具体实现</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ITodoItemMapper _todoItemMapper;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 构造函数，通过依赖注入初始化数据映射器</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItemMapper&quot;&gt;</span>待办事项数据映射器接口实现<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TodoItemServiceImpl</span>(<span class="params">ITodoItemMapper todoItemMapper</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _todoItemMapper = todoItemMapper;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取所有待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将从数据层获取的实体列表转换为视图对象列表</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>所有待办事项的视图对象集合<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;TodoItemVO&gt; <span class="title">GetAllTodoItems</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用数据映射器获取所有待办事项实体</span></span><br><span class="line">            List&lt;TodoItem&gt; todoItems = _todoItemMapper.GetAllTodoItems();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 使用LINQ将实体列表转换为VO列表并返回</span></span><br><span class="line">            <span class="keyword">return</span> todoItems.Select(item =&gt; <span class="keyword">new</span> TodoItemVO</span><br><span class="line">            &#123;</span><br><span class="line">                Id = item.Id,</span><br><span class="line">                Name = item.Name,</span><br><span class="line">                IsComplete = item.IsComplete,</span><br><span class="line">                CreatedAt = item.CreatedAt,</span><br><span class="line">                UpdatedAt = item.UpdatedAt,</span><br><span class="line">                DeletedAt = item.DeletedAt</span><br><span class="line">            &#125;).ToList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 根据ID获取特定的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 如果项目不存在则抛出异常</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待办事项的唯一标识符<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>对应ID的待办事项视图对象<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;Exception&quot;&gt;</span>当找不到待办事项时抛出<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItemVO <span class="title">GetTodoItemById</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用数据映射器根据ID查找待办事项</span></span><br><span class="line">            TodoItem todoItem = _todoItemMapper.GetTodoItemById(id);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果未找到项目，抛出异常</span></span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Todo item not found&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将实体转换为视图对象并返回</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> TodoItemVO</span><br><span class="line">            &#123;</span><br><span class="line">                Id = todoItem.Id,</span><br><span class="line">                Name = todoItem.Name,</span><br><span class="line">                IsComplete = todoItem.IsComplete,</span><br><span class="line">                CreatedAt = todoItem.CreatedAt,</span><br><span class="line">                UpdatedAt = todoItem.UpdatedAt,</span><br><span class="line">                DeletedAt = todoItem.DeletedAt</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 添加一个新的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将DTO转换为实体对象，保存后返回创建的视图对象</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItemDTO&quot;&gt;</span>包含新待办事项信息的DTO<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>创建成功后的待办事项视图对象<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;Exception&quot;&gt;</span>当创建操作失败时抛出<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItemVO <span class="title">AddTodoItem</span>(<span class="params">TodoItemDTO todoItemDTO</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 创建新的待办事项实体，设置适当的初始值</span></span><br><span class="line">            <span class="comment">// 注意：todoId使用了硬编码值3，实际应用中应使用自增ID或GUID</span></span><br><span class="line">            TodoItem todoItem = <span class="keyword">new</span> TodoItem(</span><br><span class="line">                    todoId: <span class="built_in">long</span>.Parse(DateTime.Now.ToString()),</span><br><span class="line">                    id: todoItemDTO.Id,</span><br><span class="line">                    name: todoItemDTO.Name,</span><br><span class="line">                    isComplete: todoItemDTO.IsComplete,</span><br><span class="line">                    createdAt: DateTime.Now,</span><br><span class="line">                    updatedAt: DateTime.Now);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 调用数据映射器添加新项目</span></span><br><span class="line">            _todoItemMapper.AddTodoItem(todoItem);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 验证添加操作是否成功</span></span><br><span class="line">            TodoItem todoItemCreate = _todoItemMapper.GetTodoItemById(todoItemDTO.Id);</span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>) <span class="comment">// 注意：这里应检查todoItemCreate而非todoItem</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Todo item not found&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将实体转换为视图对象并返回</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> TodoItemVO</span><br><span class="line">            &#123;</span><br><span class="line">                Id = todoItem.Id,</span><br><span class="line">                Name = todoItem.Name,</span><br><span class="line">                IsComplete = todoItem.IsComplete,</span><br><span class="line">                CreatedAt = todoItem.CreatedAt,</span><br><span class="line">                UpdatedAt = todoItem.UpdatedAt,</span><br><span class="line">                DeletedAt = todoItem.DeletedAt</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 使用DTO中的数据更新已有实体，保存后返回更新的视图对象</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待更新待办事项的ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItemDTO&quot;&gt;</span>包含更新信息的DTO<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>更新后的待办事项视图对象<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;Exception&quot;&gt;</span>当待办事项不存在或更新失败时抛出<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItemVO <span class="title">UpdateTodoItem</span>(<span class="params"><span class="built_in">long</span> id, TodoItemDTO todoItemDTO</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用数据映射器根据ID查找待办事项</span></span><br><span class="line">            TodoItem todoItem = _todoItemMapper.GetTodoItemById(id);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果未找到项目，抛出异常</span></span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Todo item not found&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 用DTO中的数据更新实体属性</span></span><br><span class="line">            todoItem.Id = todoItemDTO.Id;</span><br><span class="line">            todoItem.Name = todoItemDTO.Name;</span><br><span class="line">            todoItem.IsComplete = todoItemDTO.IsComplete;</span><br><span class="line">            todoItem.UpdatedAt = DateTime.Now; <span class="comment">// 更新修改时间为当前时间</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 调用数据映射器更新项目</span></span><br><span class="line">            _todoItemMapper.UpdateTodoItem(id, todoItem);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 验证更新操作是否成功</span></span><br><span class="line">            TodoItem todoItemUpdate = _todoItemMapper.GetTodoItemById(todoItemDTO.Id);</span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>) <span class="comment">// 注意：这里应检查todoItemUpdate而非todoItem</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Todo item not found&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将更新后的实体转换为视图对象并返回</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> TodoItemVO</span><br><span class="line">            &#123;</span><br><span class="line">                Id = todoItem.Id,</span><br><span class="line">                Name = todoItem.Name,</span><br><span class="line">                IsComplete = todoItem.IsComplete,</span><br><span class="line">                CreatedAt = todoItem.CreatedAt,</span><br><span class="line">                UpdatedAt = todoItem.UpdatedAt,</span><br><span class="line">                DeletedAt = todoItem.DeletedAt</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 删除指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 执行删除操作并返回删除前的待办事项信息</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待删除待办事项的ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>删除前的待办事项视图对象<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;Exception&quot;&gt;</span>当待办事项不存在时抛出<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> TodoItemVO <span class="title">DeleteTodoItem</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用数据映射器根据ID查找待办事项</span></span><br><span class="line">            TodoItem todoItem = _todoItemMapper.GetTodoItemById(id);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果未找到项目，抛出异常</span></span><br><span class="line">            <span class="keyword">if</span> (todoItem == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;Todo item not found&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 在删除前，保存项目的信息用于返回</span></span><br><span class="line">            TodoItemVO result = <span class="keyword">new</span> TodoItemVO</span><br><span class="line">            &#123;</span><br><span class="line">                Id = todoItem.Id,</span><br><span class="line">                Name = todoItem.Name,</span><br><span class="line">                IsComplete = todoItem.IsComplete,</span><br><span class="line">                CreatedAt = todoItem.CreatedAt,</span><br><span class="line">                UpdatedAt = todoItem.UpdatedAt,</span><br><span class="line">                DeletedAt = todoItem.DeletedAt</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 调用数据映射器删除项目</span></span><br><span class="line">            _todoItemMapper.DeleteTodoItem(id);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回删除前的项目信息</span></span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4、Controllers"><a href="#4、Controllers" class="headerlink" title="4、Controllers"></a>4、Controllers</h3><p>TodoItemController 类详细介绍</p>
<ol>
<li><p>设计目的与定位<br>  TodoItemController 是 WebApp 应用程序的表示层组件，作为 ASP.NET Core Web API 控制器，负责处理与待办事项相关的 HTTP 请求。它的主要职责包括：</p>
</li>
<li><p>请求接收：接收并处理来自客户端的 HTTP 请求</p>
</li>
<li><p>参数解析：从 URL、查询字符串和请求体中提取参数</p>
</li>
<li><p>服务调用：调用业务逻辑层（ITodoItemService）处理具体业务操作</p>
</li>
<li><p>响应构造：将处理结果包装为 HTTP 响应返回给客户端<br>作为 MVC&#x2F;Web API 架构中的 “C”（控制器），它是连接客户端和服务层的桥梁。</p>
</li>
<li><p>路由与 API 端点<br>  控制器通过类级别和方法级别的特性定义了 RESTful API 端点：</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>HTTP 方法</th>
<th>路由</th>
<th>方法名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td>&#x2F;api&#x2F;TodoItem</td>
<td>GetAllTodoItems</td>
<td>获取所有待办事项列表</td>
</tr>
<tr>
<td>GET</td>
<td>&#x2F;api&#x2F;TodoItem&#x2F;{id}</td>
<td>GetTodoItemById</td>
<td>获取特定ID的待办事项</td>
</tr>
<tr>
<td>POST</td>
<td>&#x2F;api&#x2F;TodoItem</td>
<td>AddTodoItem</td>
<td>创建新的待办事项</td>
</tr>
<tr>
<td>PUT</td>
<td>&#x2F;api&#x2F;TodoItem&#x2F;{id}</td>
<td>UpdateTodoItem</td>
<td>更新指定ID的待办事项</td>
</tr>
<tr>
<td>DELETE</td>
<td>&#x2F;api&#x2F;TodoItem&#x2F;{id}</td>
<td>DeleteTodoItem</td>
<td>删除指定ID的待办事项</td>
</tr>
</tbody></table>
<p>  这些端点遵循 RESTful API 设计原则，使用标准的 HTTP 方法对资源进行操作。</p>
<ol start="3">
<li>依赖注入设计<br>  控制器采用构造函数注入的方式获取 ITodoItemService 实例：</li>
</ol>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private readonly ITodoItemService _todoItemService;</span><br><span class="line"></span><br><span class="line">public TodoItemController(ITodoItemService todoItemService)</span><br><span class="line">&#123;</span><br><span class="line">    _todoItemService = todoItemService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  这种设计有以下优点：</p>
<ul>
<li>松耦合：控制器依赖于抽象接口而非具体实现</li>
<li>可测试性：便于在单元测试中注入模拟服务</li>
<li>维护性：服务实现可以独立更改，不影响控制器代码</li>
</ul>
<ol start="4">
<li>数据流与模型使用<br>控制器处理三种不同的数据模型：</li>
</ol>
<pre><code>- DTO (Data Transfer Object)：从客户端接收数据时使用
- VO (View Object)：向客户端返回数据时使用
- Entity：在服务层内部使用，控制器不直接接触
</code></pre>
<ol start="5">
<li>数据流如下：</li>
</ol>
<pre><code>1. 输入：客户端请求 → DTO → 控制器 → 服务层
2. 输出：服务层 → VO → 控制器 → HTTP 响应 → 客户端
  这种设计分离了内部数据模型和外部接口，增强了系统的安全性和灵活性。
</code></pre>
<ol start="6">
<li>方法详解</li>
</ol>
<pre><code>1. GetAllTodoItems()

  - 作用：获取所有待办事项列表
  - 请求格式：GET api/TodoItem
  - 响应格式：
  - 状态码：200 OK 或服务层抛出的异常

2. GetTodoItemById(long id)

  - 作用：获取单个待办事项

  - 请求格式：GET api/TodoItem/1

  - 响应格式：

  - 状态码：200 OK 或找不到时的异常

3. AddTodoItem(TodoItemDTO todoItem)

  - 作用：创建新的待办事项
  - 请求格式： POST api/TodoItem
  - 响应格式：创建后的待办事项VO
  - 状态码：当前返回 200 OK

4. UpdateTodoItem(long id, TodoItemDTO todoItem)

  - 作用：更新现有待办事项
  - 请求格式： PUT api/TodoItem/1
  - 响应格式：更新后的待办事项VO
  - 状态码：200 OK 或找不到时的异常

5. DeleteTodoItem(long id)

  - 作用：删除待办事项
  - 请求格式：DELETE api/TodoItem/1
  - 响应格式：删除的待办事项信息
  - 状态码：200 OK 或找不到时的异常
</code></pre>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.DTO;</span><br><span class="line"><span class="keyword">using</span> WebApp.Pojo.VO;</span><br><span class="line"><span class="keyword">using</span> WebApp.Services;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 待办事项控制器</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 处理与待办事项相关的所有HTTP请求</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 作为应用程序的表示层，负责接收请求、调用服务层处理业务逻辑并返回结果</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">ApiController</span>]  <span class="comment">// 指示此类为API控制器，启用API特定行为如自动模型验证</span></span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;api/[controller]&quot;</span>)</span>]  <span class="comment">// 设置此控制器的路由模板，[controller]会被解析为&quot;TodoItem&quot;(去掉&quot;Controller&quot;后缀)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TodoItemController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 待办事项服务接口实例</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 通过依赖注入获取，用于处理业务逻辑操作</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ITodoItemService _todoItemService;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 构造函数，通过依赖注入初始化服务</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItemService&quot;&gt;</span>待办事项服务接口实现<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TodoItemController</span>(<span class="params">ITodoItemService todoItemService</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _todoItemService = todoItemService;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取所有待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 处理HTTP GET请求，路由为 &quot;api/TodoItem&quot;</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>包含所有待办事项VO列表的HTTP 200成功响应<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpGet</span>] <span class="comment">// 指定此方法处理 HTTP GET 请求</span></span><br><span class="line">        <span class="keyword">public</span> ActionResult&lt;List&lt;TodoItemVO&gt;&gt; GetAllTodoItems()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用服务层获取所有待办事项</span></span><br><span class="line">            List&lt;TodoItemVO&gt; todoItemVOs = _todoItemService.GetAllTodoItems();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回HTTP 200状态码和获取到的待办事项列表</span></span><br><span class="line">            <span class="keyword">return</span> Ok(todoItemVOs);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 根据ID获取特定的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 处理HTTP GET请求，路由为 &quot;api/TodoItem/&#123;id&#125;&quot;</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待获取的待办事项ID，来自URL路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>包含指定ID待办事项的HTTP 200成功响应，如果未找到则由服务层抛出异常<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpGet(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>] <span class="comment">// 指定此方法处理带有ID参数的HTTP GET请求</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ActionResult&lt;TodoItemVO&gt; <span class="title">GetTodoItemById</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用服务层根据ID获取待办事项</span></span><br><span class="line">            TodoItemVO todoItemVO = _todoItemService.GetTodoItemById(id);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回HTTP 200状态码和获取到的待办事项</span></span><br><span class="line">            <span class="keyword">return</span> Ok(todoItemVO);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 创建新的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 处理HTTP POST请求，路由为 &quot;api/TodoItem&quot;</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItem&quot;&gt;</span>包含新待办事项信息的DTO，从请求体中解析<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>包含创建成功的待办事项VO的HTTP 200成功响应<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPost</span>] <span class="comment">// 指定此方法处理HTTP POST请求</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ActionResult&lt;TodoItemVO&gt; <span class="title">AddTodoItem</span>(<span class="params">[FromBody] TodoItemDTO todoItem</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用服务层创建新待办事项</span></span><br><span class="line">            TodoItemVO todoItemVO = _todoItemService.AddTodoItem(todoItem);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回HTTP 200状态码和创建的待办事项</span></span><br><span class="line">            <span class="comment">// 注意：更符合RESTful设计的做法是返回201 Created状态码和资源位置</span></span><br><span class="line">            <span class="keyword">return</span> Ok(todoItemVO);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 更新指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 处理HTTP PUT请求，路由为 &quot;api/TodoItem/&#123;id&#125;&quot;</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待更新的待办事项ID，来自URL路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;todoItem&quot;&gt;</span>包含更新信息的DTO，从请求体中解析<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>包含更新后待办事项VO的HTTP 200成功响应，如果未找到则由服务层抛出异常<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPut(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>] <span class="comment">// 指定此方法处理带有ID参数的HTTP PUT请求</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ActionResult&lt;TodoItemVO&gt; <span class="title">UpdateTodoItem</span>(<span class="params"><span class="built_in">long</span> id, [FromBody] TodoItemDTO todoItem</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用服务层更新待办事项</span></span><br><span class="line">            TodoItemVO todoItemVO = _todoItemService.UpdateTodoItem(id, todoItem);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回HTTP 200状态码和更新后的待办事项</span></span><br><span class="line">            <span class="keyword">return</span> Ok(todoItemVO);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 删除指定ID的待办事项</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 处理HTTP DELETE请求，路由为 &quot;api/TodoItem/&#123;id&#125;&quot;</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>待删除的待办事项ID，来自URL路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>包含删除前待办事项信息的HTTP 200成功响应，如果未找到则由服务层抛出异常<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpDelete(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>] <span class="comment">// 指定此方法处理带有ID参数的HTTP DELETE请求</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ActionResult&lt;TodoItemVO&gt; <span class="title">DeleteTodoItem</span>(<span class="params"><span class="built_in">long</span> id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用服务层删除待办事项</span></span><br><span class="line">            TodoItemVO todoItemVO = _todoItemService.DeleteTodoItem(id);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回HTTP 200状态码和删除的待办事项信息</span></span><br><span class="line">            <span class="comment">// 注意：更符合RESTful设计的做法是返回204 No Content状态码</span></span><br><span class="line">            <span class="keyword">return</span> Ok(todoItemVO);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5、Config"><a href="#5、Config" class="headerlink" title="5、Config"></a>5、Config</h3><p>DependencyInjectionExtensions 类详细介绍</p>
<ol>
<li><p>设计目的与意义<br>  DependencyInjectionExtensions 类是 WebApp 应用程序中的依赖注入配置中心，它通过扩展方法扩展了 ASP.NET Core 的 IServiceCollection 接口，提供了集中管理和注册应用程序服务的能力。这种设计有以下优点：</p>
</li>
<li><p>关注点分离：将服务注册逻辑从启动代码 (Program.cs) 中分离出来</p>
</li>
<li><p>代码组织：按功能或层次分组服务注册，提高代码可读性</p>
</li>
<li><p>可扩展性：可以轻松添加新的服务分类和注册方法</p>
</li>
<li><p>简化主程序：Program.cs 中只需一行代码即可注册所有服务</p>
</li>
<li><p>扩展方法原理<br>  该类使用了 C# 的扩展方法特性，允许向现有类型添加方法而无需修改原始类型：</p>
</li>
</ol>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static IServiceCollection RegisterApplicationServices(this IServiceCollection services)</span><br></pre></td></tr></table></figure>

<p>  关键点：</p>
<ul>
<li>static 修饰符：扩展方法必须是静态的</li>
<li>this 关键字：表明这是一个扩展方法，作用于 IServiceCollection 类型</li>
<li>返回值类型：返回相同的 IServiceCollection 实例，支持方法链式调用</li>
</ul>
<ol start="3">
<li>服务注册模式</li>
</ol>
<p>  该类采用了层次化的服务注册模式：</p>
<ol>
<li><p>顶层方法：RegisterAllServices 作为主入口点，被 Program.cs 直接调用</p>
</li>
<li><p>分组方法：RegisterApplicationServices 处理特定类别的服务注册</p>
</li>
<li><p>扩展能力：预留了添加其他服务分类的位置<br>这种结构支持应用程序随着规模增长，可以在不修改主方法的情况下添加新的服务分类。</p>
</li>
<li><p>依赖注入生命周期</p>
</li>
</ol>
<p>  在当前实现中，使用了 AddScoped 方法注册服务，这意味着：</p>
<ul>
<li>在同一个 HTTP 请求作用域内，将获得相同的服务实例</li>
<li>不同的 HTTP 请求将获得不同的服务实例</li>
<li>适合于大多数业务服务和数据访问服务</li>
<li>其他可用的生命周期选项：<ul>
<li>AddTransient：每次请求服务时创建新实例</li>
<li>AddSingleton：整个应用程序生命周期内共享同一实例</li>
</ul>
</li>
</ul>
<ol start="5">
<li>服务层次与依赖关系</li>
</ol>
<p>  代码注册了两个主要的服务类型，反映了应用程序的分层架构：</p>
<ol>
<li><p>业务服务层：ITodoItemService → TodoItemServiceImpl</p>
<ul>
<li>处理业务逻辑和规则</li>
<li>依赖于数据访问层</li>
</ul>
</li>
<li><p>数据访问层：ITodoItemMapper → TodoItemMapperImpl</p>
<ul>
<li>处理数据持久化和检索</li>
<li>通常与数据库或其他存储机制交互</li>
</ul>
<p>这种注册方式体现了依赖倒置原则，高层模块（业务服务）依赖于抽象（接口），而非具体实现。</p>
</li>
<li><p>适用场景与扩展性</p>
</li>
</ol>
<p>  当前实现适用于中小型应用程序，但代码结构已经考虑了扩展性：</p>
<ul>
<li>新服务类型：可以在 RegisterApplicationServices 中添加新的服务注册</li>
<li>新服务分类：可以创建新的注册方法（如 RegisterInfrastructureServices）并在 RegisterAllServices 中调用</li>
<li>批量注册：可以添加反射或约定注册方法，自动扫描并注册符合特定模式的服务</li>
</ul>
<ol start="7">
<li>实际应用流程</li>
</ol>
<p>  在应用程序启动过程中，这些扩展方法的调用流程如下：</p>
<ol>
<li><p>Program.cs 调用 builder.Services.RegisterAllServices()</p>
</li>
<li><p>RegisterAllServices 调用 RegisterApplicationServices</p>
</li>
<li><p>RegisterApplicationServices 注册具体的服务实现</p>
</li>
<li><p>ASP.NET Core 依赖注入容器配置完成</p>
</li>
<li><p>当控制器或其他组件请求服务时，依赖注入容器提供相应的实例</p>
</li>
<li><p>总结</p>
<p>DependencyInjectionExtensions 类是应用程序依赖注入配置的核心组件，通过扩展方法模式提供了集中、组织化和可扩展的服务注册能力。它采用了层次化的结构设计，支持应用程序按需扩展服务类型和分类，同时保持 Program.cs 的简洁。这种设计符合关注点分离原则，提高了代码的可读性和可维护性。</p>
</li>
</ol>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.Extensions.DependencyInjection;</span><br><span class="line"><span class="keyword">using</span> System.Reflection;</span><br><span class="line"><span class="keyword">using</span> WebApp.Services.Impl;</span><br><span class="line"><span class="keyword">using</span> WebApp.Services;</span><br><span class="line"><span class="keyword">using</span> WebApp.Mapper;</span><br><span class="line"><span class="keyword">using</span> WebApp.Mapper.Impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">WebApp.Config</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 依赖注入扩展类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 提供注册应用程序服务的扩展方法</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 集中管理所有依赖注入配置，简化Program.cs中的服务注册</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">DependencyInjectionExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 注册应用程序核心服务</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 主要包括业务服务和数据映射器的具体实现</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>服务集合，由ASP.NET Core依赖注入容器提供<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>配置后的服务集合，支持方法链式调用<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">RegisterApplicationServices</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 注册业务服务层</span></span><br><span class="line">            <span class="comment">// AddScoped确保每个HTTP请求获得同一个服务实例</span></span><br><span class="line">            <span class="comment">// 将ITodoItemService接口映射到TodoItemServiceImpl实现类</span></span><br><span class="line">            services.AddScoped&lt;ITodoItemService, TodoItemServiceImpl&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 注册数据访问层</span></span><br><span class="line">            <span class="comment">// 将ITodoItemMapper接口映射到TodoItemMapperImpl实现类</span></span><br><span class="line">            <span class="comment">// 使业务层可以通过接口访问数据，而不依赖具体实现</span></span><br><span class="line">            services.AddScoped&lt;ITodoItemMapper, TodoItemMapperImpl&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> services;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 注册应用程序中的所有服务</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 作为Program.cs中调用的主入口点</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 可以根据需要扩展注册不同类别的服务</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>服务集合，由ASP.NET Core依赖注入容器提供<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>配置后的服务集合，支持方法链式调用<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">RegisterAllServices</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 调用核心应用服务注册方法</span></span><br><span class="line">            RegisterApplicationServices(services);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 在这里可以添加其他服务分类的注册</span></span><br><span class="line">            <span class="comment">// 例如：</span></span><br><span class="line">            <span class="comment">// RegisterInfrastructureServices(services);</span></span><br><span class="line">            <span class="comment">// RegisterExternalServices(services);</span></span><br><span class="line">            <span class="comment">// RegisterAuthenticationServices(services);</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> services;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6、Program-cs"><a href="#6、Program-cs" class="headerlink" title="6、Program.cs"></a>6、Program.cs</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入WebApp.Config命名空间，提供依赖注入扩展方法</span></span><br><span class="line"><span class="keyword">using</span> WebApp.Config;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个 Web 应用程序构建器，用于配置应用程序的服务和中间件</span></span><br><span class="line"><span class="comment">// 这是ASP.NET Core应用程序的起点，提供配置、日志、服务注册等功能</span></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(<span class="keyword">args</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册控制器服务</span></span><br><span class="line"><span class="comment">// 这一步将控制器添加到依赖注入容器中，允许应用程序处理基于控制器的 HTTP 请求</span></span><br><span class="line"><span class="comment">// 使MVC控制器可以被依赖注入系统识别</span></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册应用程序中的所有服务</span></span><br><span class="line"><span class="comment">// 通过DependencyInjectionExtensions类中的扩展方法自动注册服务</span></span><br><span class="line"><span class="comment">// 包括TodoItemService、TodoItemMapper等依赖服务，避免在Program.cs中手动逐一注册</span></span><br><span class="line">builder.Services.RegisterAllServices();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建 Web 应用程序实例</span></span><br><span class="line"><span class="comment">// 通过构建器生成一个 Web 应用程序对象，准备运行应用程序</span></span><br><span class="line"><span class="comment">// 此时所有配置和服务注册都已完成，可以开始处理HTTP请求</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 映射控制器路由</span></span><br><span class="line"><span class="comment">// 将控制器的路由映射到应用程序中，使其能够响应 HTTP 请求</span></span><br><span class="line"><span class="comment">// 例如：将&quot;/api/TodoItem&quot;路径映射到TodoItemController</span></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动 Web 应用程序并开始监听请求</span></span><br><span class="line"><span class="comment">// 运行应用程序，开始处理传入的 HTTP 请求</span></span><br><span class="line"><span class="comment">// 应用程序将一直运行，直到被明确停止</span></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>

<p><img src="/2025/04/18/NET-ASP-11/image-20250419132354046.png" alt="image-20250419132354046"></p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250419132406103.png" alt="image-20250419132406103"></p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250419132818587.png" alt="image-20250419132818587"></p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250419132833640.png" alt="image-20250419132833640"></p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250419132843833.png" alt="image-20250419132843833"></p>
<p><img src="/2025/04/18/NET-ASP-11/image-20250419132854060.png" alt="image-20250419132854060"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://alsl521.github.io">kyl</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://alsl521.github.io/2025/04/18/NET-ASP-11/">https://alsl521.github.io/2025/04/18/NET-ASP-11/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://alsl521.github.io" target="_blank">kyl的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C#</a></div><div class="post-share"><div class="social-share" data-image="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/16/NET-ASP-10/" title="ASP.NET学习记录-10-过滤"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">ASP.NET学习记录-10-过滤</div></div><div class="info-2"><div class="info-item-1">一、ASP.NET Core 中的过滤管道1. 什么是过滤管道？**过滤管道（Filter Pipeline）**是 ASP.NET Core 请求处理流程中的一个核心机制，由一系列过滤器（Filters）按特定顺序组成。这些过滤器在 MVC 或 Razor Pages 的请求处理管道中，针对不同阶段（如授权、模型绑定、Action 执行等）插入自定义逻辑，实现横切关注点（Cross-Cutting Concerns）的集中处理。 过滤器的类型及执行顺序：  授权过滤器（Authorization Filters）：最先执行，用于验证用户权限（如是否登录或具备访问权限）。  资源过滤器（Resource Filters）：在授权后执行，常用于缓存或短路管道（如直接返回结果，跳过后续处理）。  操作过滤器（Action Filters）：在 Action 执行前后运行，可修改输入参数或结果（如日志记录、参数校验）。  异常过滤器（Exception Filters）：捕获未处理的异常，统一处理错误响应。  结果过滤器（Result Filters）：在 Action...</div></div></div></a><a class="pagination-related" href="/2025/04/18/NET-ASP-12/" title="ASP.NET学习记录-12-实践2-使用MySQL数据库"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">ASP.NET学习记录-12-实践2-使用MySQL数据库</div></div><div class="info-2"><div class="info-item-1">1、配置数据库 首先连接数据库   然后连接已有数据库，或者是创建新的数据库   随后在选择的数据库中选择或创建新的表，并且添加初始数据  由于是利用软件自动生成的数据，数据以仅作示例，没有特定含义。    2、配置 MySQL 所需包在使用数据库时，由于可能不包含必要的数据库插件，所以需要安装以下NuGet包，并且需要注意版本一致性：  Microsoft.EntityFrameworkCore Microsoft.EntityFrameworkCore.Design Microsoft.EntityFrameworkCore.Tools Pomelo.EntityFrameworkCore.MySql   3、配置 MySQL 上下文 TodoItemDbContext 类，它是一个 Entity Framework Core (EF Core) 的数据库上下文类，主要用于管理与数据库的交互。TodoItemDbContext 继承自 DbContext，是 EF Core...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/04/08/NET-ASP-01/" title="ASP.NET学习记录-01-基础知识"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-01-基础知识</div></div><div class="info-2"><div class="info-item-1">视频教程为：ASP.NET Core Deep-Dive in .NET 9 | Udemy 1、.NET Core.NET Core 是微软开发的开源、跨平台应用程序开发框架，旨在为现代云原生、微服务及高性能场景提供支持。以下是其核心特性与定位的详细说明：  一、核心定义与定位 跨平台支持 .NET Core 可在 Windows、Linux、macOS 等操作系统上运行，并支持 x86、x64、ARM 等多种架构。 这种跨平台能力使其成为开发云原生、容器化应用（如 Docker）的理想选择。  开源与社区驱动 作为 MIT 协议下的开源项目，.NET Core 的代码托管于 GitHub，接受社区贡献，确保了技术透明度和快速迭代。    二、架构与技术特性 模块化设计 采用包化（Packages）管理，开发者可按需引用组件，减少应用体积，与传统的 .NET Framework 打包式安装形成对比。例如，通过 1dotnet restore  命令可动态还原依赖的 NuGet 包。  高性能运行时  RyuJIT 编译器：相比传统 JIT，性能提升约 25%，支持 SIMD...</div></div></div></a><a class="pagination-related" href="/2025/04/08/NET-ASP-02/" title="ASP.NET学习记录-02-最小API模式"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-08</div><div class="info-item-2">ASP.NET学习记录-02-最小API模式</div></div><div class="info-2"><div class="info-item-1">1、创建第一个ASP.NET应用（Minimal API）1.创建新项目 选择新的空项目  设定基本信息  使用最新版.NET作为学习内容  2.项目架构简介与解析 1. 解决方案（Solution） 名称：MyFirstWebApplication 作用： 作为容器管理多个相关项目（当前仅包含一个项目 WebApplication）。 支持团队协作和复杂应用的模块化开发（如Web API、类库、单元测试等）。   关键点： 可通过解决方案配置统一管理所有项目的依赖和环境设置。   新增项目 右键单击解决方案-&gt;添加-&gt;新建项目      2. 项目（Project: WebApplication） 核心结构：包含构建和运行Web应用所需的所有文件与配置，分为以下关键部分：  a. Connected Services 文件夹 作用： 存储与外部服务的连接配置（如数据库、Azure服务、第三方API）。 通过右键添加服务（如Entity Framework、Azure认证），自动生成连接配置文件。   示例：添加Azure...</div></div></div></a><a class="pagination-related" href="/2025/04/09/NET-ASP-03/" title="ASP.NET学习记录-03-中间件管道"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-09</div><div class="info-item-2">ASP.NET学习记录-03-中间件管道</div></div><div class="info-2"><div class="info-item-1">1、中间件管道简介在 C# ASP.NET Core 中，中间件管道是处理 HTTP 请求和响应的核心机制，通过将多个中间件按顺序串联成一个处理流程，实现灵活的请求处理和业务逻辑组合。以下是其核心要点：  1. 中间件管道的基本概念 中间件（Middleware）：是管道中的独立组件，负责处理 HTTP 请求和响应。每个中间件可以：  对请求进行预处理（如日志、身份验证）。  调用下一个中间件（通过 next()），或直接终止处理（短路）。  对响应进行后处理（如修改响应头、记录耗时）。      管道（Pipeline）：由多个中间件按注册顺序串联而成，形成一个“请求→处理→响应”的流程。请求按顺序经过所有中间件，而响应则逆序返回  。    2. 管道的工作模式：1-n 然后 n-1 请求阶段（正向传递）：请求从第一个中间件开始，依次传递至最后一个中间件（终结点），形成“1→2→3”的顺序 。  响应阶段（逆向返回）：处理完成后，响应从终结点开始，逆序返回至第一个中间件，形成“3→2→1”的顺序  。 示例 123Middleware One: Request Start...</div></div></div></a><a class="pagination-related" href="/2025/04/10/NET-ASP-04/" title="ASP.NET学习记录-04-路由"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-10</div><div class="info-item-2">ASP.NET学习记录-04-路由</div></div><div class="info-2"><div class="info-item-1">1、Routing和Endpoints简介在ASP.NET Core中，**路由（Routing）和终结点（Endpoints）**是处理HTTP请求的核心机制，它们共同构成了请求分发的管道系统。以下是对两者的详细介绍：  一、路由（Routing）路由的核心作用是将传入的HTTP请求根据URL路径和HTTP方法匹配到对应的处理逻辑（终结点）。在ASP.NET Core中，路由系统被称为终结点路由（Endpoint Routing）。 主要功能与工作流程 匹配请求：通过UseRouting中间件（即EndpointRoutingMiddleware）扫描应用中所有注册的终结点，根据请求的URL和HTTP方法选择最匹配的终结点 。示例代码：  12345app.UseRouting();app.UseEndpoints(endpoints =&gt; &#123;    endpoints.MapGet(&quot;/&quot;, async context =&gt; &#123; ......</div></div></div></a><a class="pagination-related" href="/2025/04/11/NET-ASP-05/" title="ASP.NET学习记录-05-模型数据绑定"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-11</div><div class="info-item-2">ASP.NET学习记录-05-模型数据绑定</div></div><div class="info-2"><div class="info-item-1">1、模型绑定定义模型绑定是ASP.NET Core中将HTTP请求数据自动映射到方法参数或对象属性的机制。其核心工作流程：  数据来源：  路由参数（URL片段） 查询字符串（?key&#x3D;value） 请求体（表单&#x2F;JSON&#x2F;XML） 请求头 文件上传   典型应用：   12345678910111213// 自动绑定路由参数和查询参数[HttpGet(&quot;/products/&#123;id&#125;&quot;)]public IActionResult GetProduct(int id, [FromQuery] string category) &#123;    // id来自路由参数，category来自查询字符串&#125;// 自动绑定JSON请求体[HttpPost]public IActionResult Create([FromBody] Product product)&#123;    //...</div></div></div></a><a class="pagination-related" href="/2025/04/15/NET-ASP-09/" title="ASP.NET学习记录-09-MVC"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-15</div><div class="info-item-2">ASP.NET学习记录-09-MVC</div></div><div class="info-2"><div class="info-item-1">1、MVC PatternASP.NET中的MVC（Model-View-Controller）模式是一种软件架构设计模式，它将应用程序分为三个核心组件：模型（Model）、视图（View）和控制器（Controller），以实现关注点分离，提升代码可维护性和可扩展性。  以下是其具体内涵及在ASP.NET中的应用特点： 1....</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/61216968?s=400&amp;u=d5b61cbc7946e6309e4318dabc2d459a18e0fe55&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">kyl</div><div class="author-info-description">用于记录平时学习的博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">64</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/alsl521" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:852970167@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.</span> <span class="toc-text">1、初始化项目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.</span> <span class="toc-text">1.初始化项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%A1%B9%E7%9B%AE%E5%86%85%E5%AE%B9%E4%BB%8B%E7%BB%8D%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">2.项目内容介绍：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%A1%B9%E7%9B%AE%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84"><span class="toc-number">1.2.1.</span> <span class="toc-text">1. 项目整体架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%96%87%E4%BB%B6%E4%B8%8E%E6%96%87%E4%BB%B6%E5%A4%B9%E8%AF%B4%E6%98%8E"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. 关键文件与文件夹说明</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-WebApp%EF%BC%88%E9%A1%B9%E7%9B%AE%E6%A0%B9%E7%9B%AE%E5%BD%95%EF%BC%89"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">**(1) **WebApp（项目根目录）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Connected-Services"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">**(2) **Connected Services</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Properties-%E4%B8%8E-launchSettings-json"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">**(3) **Properties 与 launchSettings.json</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Dependencies"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">**(4) **Dependencies</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Controllers-WeatherForecastController-cs"><span class="toc-number">1.2.2.5.</span> <span class="toc-text">**(5) **Controllers&#x2F;WeatherForecastController.cs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-appsettings-json"><span class="toc-number">1.2.2.6.</span> <span class="toc-text">**(6) **appsettings.json</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-Program-cs"><span class="toc-number">1.2.2.7.</span> <span class="toc-text">**(7) **Program.cs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-WeatherForecast-cs"><span class="toc-number">1.2.2.8.</span> <span class="toc-text">**(8) **WeatherForecast.cs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-WebApp-http"><span class="toc-number">1.2.2.9.</span> <span class="toc-text">**(9) **WebApp.http</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8D%8F%E4%BD%9C%E6%B5%81%E7%A8%8B%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. 协作流程示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%85%B7%E4%BD%93%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90"><span class="toc-number">1.3.</span> <span class="toc-text">4.具体代码解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-WeatherForecast-cs"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.WeatherForecast.cs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-WeatherForecastController-cs"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.WeatherForecastController.cs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Program-cs"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.Program.cs</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%E3%80%81%E6%96%B0%E5%BB%BA%E6%A8%A1%E5%9E%8B%E7%B1%BB"><span class="toc-number">2.</span> <span class="toc-text">2、新建模型类</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%E3%80%81%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="toc-number">3.</span> <span class="toc-text">3、添加数据库上下文</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4%E3%80%81%E6%B3%A8%E5%86%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="toc-number">4.</span> <span class="toc-text">4、注册数据库上下文</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5%E3%80%81%E6%9E%84%E5%BB%BA%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">5、构建控制器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ASP-NET-Core-%E4%B8%AD-MVC-%E6%8E%A7%E5%88%B6%E5%99%A8%E4%B8%8E-API-%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E8%B7%AF%E7%94%B1%E8%AE%BE%E8%AE%A1%E5%B7%AE%E5%BC%82%E8%A7%A3%E6%9E%90"><span class="toc-number">5.0.1.</span> <span class="toc-text">ASP.NET Core 中 MVC 控制器与 API 控制器的路由设计差异解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E4%B8%8E%E7%9B%AE%E6%A0%87"><span class="toc-number">5.0.2.</span> <span class="toc-text">1. 设计原则与目标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B7%AF%E7%94%B1%E6%A8%A1%E6%9D%BF%E5%AF%B9%E6%AF%94"><span class="toc-number">5.0.3.</span> <span class="toc-text">2. 路由模板对比</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BC%A0%E7%BB%9F-MVC-%E6%8E%A7%E5%88%B6%E5%99%A8%EF%BC%88%E5%8C%85%E5%90%AB-action-%EF%BC%89"><span class="toc-number">5.0.3.1.</span> <span class="toc-text">(1) 传统 MVC 控制器（包含 [action]）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-API-%E6%8E%A7%E5%88%B6%E5%99%A8%EF%BC%88%E4%B8%8D%E5%8C%85%E5%90%AB-action-%EF%BC%89"><span class="toc-number">5.0.3.2.</span> <span class="toc-text">(2) API 控制器（不包含 [action]）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%9E%E9%99%85%E5%BD%B1%E5%93%8D%E4%B8%8E%E9%85%8D%E7%BD%AE%E5%B7%AE%E5%BC%82"><span class="toc-number">5.0.4.</span> <span class="toc-text">3. 实际影响与配置差异</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1%E6%B3%A8%E5%86%8C%E6%96%B9%E5%BC%8F"><span class="toc-number">5.0.4.1.</span> <span class="toc-text">(1) 路由注册方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ApiController-%E7%89%B9%E6%80%A7%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">5.0.4.2.</span> <span class="toc-text">(2) [ApiController] 特性的作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%A6%82%E4%BD%95%E5%BC%BA%E5%88%B6-API-%E6%8E%A7%E5%88%B6%E5%99%A8%E5%8C%85%E5%90%AB-action-%EF%BC%88%E4%B8%8D%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="toc-number">5.0.4.3.</span> <span class="toc-text">(3) 如何强制 API 控制器包含 [action]（不推荐）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E5%9B%BE%E4%B8%AD%E7%9A%84%E4%BD%93%E7%8E%B0"><span class="toc-number">5.0.5.</span> <span class="toc-text">4. 项目结构图中的体现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.0.6.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6%E3%80%81%E8%B7%AF%E7%94%B1%E5%92%8C-URL-%E8%B7%AF%E5%BE%84"><span class="toc-number">6.</span> <span class="toc-text">6、路由和 URL 路径</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E3%80%81%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">7.</span> <span class="toc-text">7、返回值</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8%E3%80%81%E9%98%B2%E6%AD%A2%E8%BF%87%E5%BA%A6%E5%85%AC%E5%BC%80"><span class="toc-number">8.</span> <span class="toc-text">8、防止过度公开</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9%E3%80%81%E4%BB%8EASP-NET-Core%E7%A9%BA%E6%9E%84%E5%BB%BA%E6%9C%80%E7%AE%80%E5%8C%96%E9%A1%B9%E7%9B%AE"><span class="toc-number">9.</span> <span class="toc-text">9、从ASP.NET Core空构建最简化项目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE-1"><span class="toc-number">9.1.</span> <span class="toc-text">1、初始化项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%88%9B%E5%BB%BATodoItem-%E7%9B%B8%E5%85%B3%E7%9A%84%E7%B1%BB"><span class="toc-number">9.2.</span> <span class="toc-text">2、创建TodoItem 相关的类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E6%9E%84%E5%BB%BATodoItemController%E7%B1%BB"><span class="toc-number">9.3.</span> <span class="toc-text">3、构建TodoItemController类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E6%B3%A8%E5%86%8C%E4%BD%BF%E7%94%A8%E2%80%9C%E6%8E%A7%E5%88%B6%E5%99%A8%E6%9C%8D%E5%8A%A1%E2%80%9D"><span class="toc-number">9.4.</span> <span class="toc-text">4、注册使用“控制器服务”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E6%9E%84%E5%BB%BA%E8%AF%A6%E7%BB%86%E5%86%85%E5%AE%B9"><span class="toc-number">9.5.</span> <span class="toc-text">5、构建详细内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">9.5.1.</span> <span class="toc-text">1、数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81Mapper"><span class="toc-number">9.5.2.</span> <span class="toc-text">2、Mapper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81Services"><span class="toc-number">9.5.3.</span> <span class="toc-text">3、Services</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81Controllers"><span class="toc-number">9.5.4.</span> <span class="toc-text">4、Controllers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81Config"><span class="toc-number">9.5.5.</span> <span class="toc-text">5、Config</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81Program-cs"><span class="toc-number">9.5.6.</span> <span class="toc-text">6、Program.cs</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/05/NET-ASP-17/" title="NET-ASP-17-实战-Day04">NET-ASP-17-实战-Day04</a><time datetime="2025-06-05T01:57:52.000Z" title="发表于 2025-06-05 09:57:52">2025-06-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/28/NET-ASP-16/" title="NET-ASP-16-实战-Day03">NET-ASP-16-实战-Day03</a><time datetime="2025-05-28T02:57:23.000Z" title="发表于 2025-05-28 10:57:23">2025-05-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/26/NET-ASP-15/" title="ASP.NET学习记录-15-实战-Day02">ASP.NET学习记录-15-实战-Day02</a><time datetime="2025-05-26T11:25:36.000Z" title="发表于 2025-05-26 19:25:36">2025-05-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/25/NET-ASP-14/" title="ASP.NET学习记录-14-实战-Day01">ASP.NET学习记录-14-实战-Day01</a><time datetime="2025-05-25T12:02:17.000Z" title="发表于 2025-05-25 20:02:17">2025-05-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/21/NET-ASP-13/" title="ASP.NET学习记录-13-实践2-数据库进阶">ASP.NET学习记录-13-实践2-数据库进阶</a><time datetime="2025-04-21T08:39:19.000Z" title="发表于 2025-04-21 16:39:19">2025-04-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By kyl</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>